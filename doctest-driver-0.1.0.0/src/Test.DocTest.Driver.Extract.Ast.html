<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- | Description: DocTest abstract syntax trees.</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- Copyright: Copyright 2025, Ruifeng Xie</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- License: AGPL-3.0-or-later</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Maintainer: Ruifeng Xie &lt;ruifengx@outlook.com&gt;</span><span>
</span><span id="line-5"></span><span class="hs-comment">--</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- DocTests syntax trees and extraction from source code parsed using the GHC API.</span><span>
</span><span id="line-7"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Test.DocTest.Driver.Extract.Ast</span><span>
</span><span id="line-8"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Location Information</span></span><span>
</span><span id="line-9"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Loc"><span class="hs-identifier">Loc</span></a></span><span>
</span><span id="line-10"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Entities</span></span><span>
</span><span id="line-11"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#EntityKind"><span class="hs-identifier">EntityKind</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-12"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Entity"><span class="hs-identifier">Entity</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-13"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#declEntity"><span class="hs-identifier">declEntity</span></a></span><span>
</span><span id="line-14"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#nameEntity"><span class="hs-identifier">nameEntity</span></a></span><span>
</span><span id="line-15"></span><span>  </span><span class="annot"><span class="hs-comment">-- * DocTests</span></span><span>
</span><span id="line-16"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Module"><span class="hs-identifier">Module</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#extractModule"><span class="hs-identifier">extractModule</span></a></span><span>
</span><span id="line-18"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocTests"><span class="hs-identifier">DocTests</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocLine"><span class="hs-identifier">DocLine</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#spanDocLine"><span class="hs-identifier">spanDocLine</span></a></span><span>
</span><span id="line-21"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#ExampleLine"><span class="hs-identifier">ExampleLine</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#CapturedContent"><span class="hs-identifier">CapturedContent</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#CaptureMethod"><span class="hs-identifier">CaptureMethod</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#IOHook"><span class="hs-identifier">IOHook</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#HookFlavour"><span class="hs-identifier">HookFlavour</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Utils.html"><span class="hs-identifier">Test.DocTest.Driver.Utils</span></a></span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Applicative</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(&lt;|&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Arrow</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(&amp;&amp;&amp;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Exception</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">assert</span></span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Bifunctor</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">second</span></span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Char</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">isAlphaNum</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">isLower</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">isSpace</span></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">partitionEithers</span></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">foldMap'</span></span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Function</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">on</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(&amp;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Functor</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">void</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">($&gt;)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(&lt;&amp;&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Functor.Compose</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Compose</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Generics</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Data</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Typeable</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">everything</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">mkQ</span></span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">List</span></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NonEmpty</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">nonEmpty</span></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NonEmpty</span></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">catMaybes</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">fromJust</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">mapMaybe</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">maybeToList</span></span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Monoid</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">First</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Semigroup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Min</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Generic</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Generically</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.ParserCombinators.ReadP</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">R</span></span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">GhcPs</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ParsedModule</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">getLoc</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">getLocA</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ms_hspp_file</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ms_mod_name</span></span><span class="hs-special">,</span><span> </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><span class="hs-identifier">L</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">unLoc</span></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Data.FastString</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">FastString</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">fsLit</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">mkFastString</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">unpackFS</span></span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Hs</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">GHC</span></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.HsToCore.Docs</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">GHC</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">collectDocs</span></span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Types.Name.Occurrence</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">occNameFS</span></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Types.Name.Reader</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">rdrNameOcc</span></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Types.SrcLoc</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">GHC</span></span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span class="annot"><span class="hs-comment">-- | Best-effort source location.</span></span><span>
</span><span id="line-59"></span><span class="hs-keyword">type</span><span> </span><span id="Loc"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Loc"><span class="hs-identifier hs-var">Loc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FastString</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">GHC.RealSrcLoc</span></span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#noLoc"><span class="hs-identifier hs-type">noLoc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Loc"><span class="hs-identifier hs-type">Loc</span></a></span><span>
</span><span id="line-62"></span><span id="noLoc"><span class="annot"><span class="annottext">noLoc :: Loc
</span><a href="Test.DocTest.Driver.Extract.Ast.html#noLoc"><span class="hs-identifier hs-var hs-var">noLoc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; Loc
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; FastString
</span><span class="hs-identifier hs-var">fsLit</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;&lt;no location info&gt;&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#toLoc"><span class="hs-identifier hs-type">toLoc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GHC.SrcLoc</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Loc"><span class="hs-identifier hs-type">Loc</span></a></span><span>
</span><span id="line-65"></span><span id="toLoc"><span class="annot"><span class="annottext">toLoc :: SrcLoc -&gt; Loc
</span><a href="Test.DocTest.Driver.Extract.Ast.html#toLoc"><span class="hs-identifier hs-var hs-var">toLoc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GHC.RealSrcLoc</span></span><span> </span><span id="local-6989586621679159861"><span class="annot"><span class="annottext">RealSrcLoc
</span><a href="#local-6989586621679159861"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe BufPos
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RealSrcLoc -&gt; Loc
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">RealSrcLoc
</span><a href="#local-6989586621679159861"><span class="hs-identifier hs-var">loc</span></a></span><span>
</span><span id="line-66"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#toLoc"><span class="hs-identifier hs-var">toLoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GHC.UnhelpfulLoc</span></span><span> </span><span id="local-6989586621679159863"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621679159863"><span class="hs-identifier hs-var">msg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; Loc
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621679159863"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#advanceLoc"><span class="hs-identifier hs-type">advanceLoc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Loc"><span class="hs-identifier hs-type">Loc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Loc"><span class="hs-identifier hs-type">Loc</span></a></span><span>
</span><span id="line-69"></span><span id="advanceLoc"><span class="annot"><span class="annottext">advanceLoc :: [Char] -&gt; Loc -&gt; Loc
</span><a href="Test.DocTest.Driver.Extract.Ast.html#advanceLoc"><span class="hs-identifier hs-var hs-var">advanceLoc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(RealSrcLoc -&gt; RealSrcLoc) -&gt; Loc -&gt; Loc
forall a b. (a -&gt; b) -&gt; Either FastString a -&gt; Either FastString b
forall (f :: Type -&gt; Type) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">((RealSrcLoc -&gt; RealSrcLoc) -&gt; Loc -&gt; Loc)
-&gt; ([Char] -&gt; RealSrcLoc -&gt; RealSrcLoc) -&gt; [Char] -&gt; Loc -&gt; Loc
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(RealSrcLoc -&gt; [Char] -&gt; RealSrcLoc)
-&gt; [Char] -&gt; RealSrcLoc -&gt; RealSrcLoc
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Char -&gt; RealSrcLoc -&gt; RealSrcLoc)
-&gt; RealSrcLoc -&gt; [Char] -&gt; RealSrcLoc
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: Type -&gt; Type) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(RealSrcLoc -&gt; Char -&gt; RealSrcLoc)
-&gt; Char -&gt; RealSrcLoc -&gt; RealSrcLoc
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">RealSrcLoc -&gt; Char -&gt; RealSrcLoc
</span><span class="hs-identifier hs-var">GHC.advanceSrcLoc</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#advanceLocBy"><span class="hs-identifier hs-type">advanceLocBy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Loc"><span class="hs-identifier hs-type">Loc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Loc"><span class="hs-identifier hs-type">Loc</span></a></span><span>
</span><span id="line-72"></span><span id="advanceLocBy"><span class="annot"><span class="annottext">advanceLocBy :: Int -&gt; Loc -&gt; Loc
</span><a href="Test.DocTest.Driver.Extract.Ast.html#advanceLocBy"><span class="hs-identifier hs-var hs-var">advanceLocBy</span></a></span></span><span> </span><span id="local-6989586621679159870"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679159870"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(RealSrcLoc -&gt; RealSrcLoc) -&gt; Loc -&gt; Loc
forall a b. (a -&gt; b) -&gt; Either FastString a -&gt; Either FastString b
forall (f :: Type -&gt; Type) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679159871"><span class="annot"><span class="annottext">RealSrcLoc
</span><a href="#local-6989586621679159871"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; Int -&gt; Int -&gt; RealSrcLoc
</span><span class="hs-identifier hs-var">GHC.mkRealSrcLoc</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RealSrcLoc -&gt; FastString
</span><span class="hs-identifier hs-var">GHC.srcLocFile</span></span><span> </span><span class="annot"><span class="annottext">RealSrcLoc
</span><a href="#local-6989586621679159871"><span class="hs-identifier hs-var">loc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RealSrcLoc -&gt; Int
</span><span class="hs-identifier hs-var">GHC.srcLocLine</span></span><span> </span><span class="annot"><span class="annottext">RealSrcLoc
</span><a href="#local-6989586621679159871"><span class="hs-identifier hs-var">loc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RealSrcLoc -&gt; Int
</span><span class="hs-identifier hs-var">GHC.srcLocCol</span></span><span> </span><span class="annot"><span class="annottext">RealSrcLoc
</span><a href="#local-6989586621679159871"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679159870"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span class="annot"><span class="hs-comment">-- | Kind of declared entities.</span></span><span>
</span><span id="line-75"></span><span class="hs-keyword">data</span><span> </span><span id="EntityKind"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#EntityKind"><span class="hs-identifier hs-var">EntityKind</span></a></span></span><span>
</span><span id="line-76"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="Section"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Section"><span class="hs-identifier hs-var">Section</span></a></span></span><span>           </span><span class="annot"><span class="hs-comment">-- ^ Haddock section heading.</span></span><span>
</span><span id="line-77"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="DataFamily"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DataFamily"><span class="hs-identifier hs-var">DataFamily</span></a></span></span><span>        </span><span class="annot"><span class="hs-comment">-- ^ @data family@.</span></span><span>
</span><span id="line-78"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="TypeFamily"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#TypeFamily"><span class="hs-identifier hs-var">TypeFamily</span></a></span></span><span>        </span><span class="annot"><span class="hs-comment">-- ^ @type family@, open or closed.</span></span><span>
</span><span id="line-79"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="NewType"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#NewType"><span class="hs-identifier hs-var">NewType</span></a></span></span><span>           </span><span class="annot"><span class="hs-comment">-- ^ @newtype@.</span></span><span>
</span><span id="line-80"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="DataType"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DataType"><span class="hs-identifier hs-var">DataType</span></a></span></span><span>          </span><span class="annot"><span class="hs-comment">-- ^ @data@.</span></span><span>
</span><span id="line-81"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="TypeSynonym"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#TypeSynonym"><span class="hs-identifier hs-var">TypeSynonym</span></a></span></span><span>       </span><span class="annot"><span class="hs-comment">-- ^ @type@, type/kind/constraint synonym.</span></span><span>
</span><span id="line-82"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Class"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Class"><span class="hs-identifier hs-var">Class</span></a></span></span><span>             </span><span class="annot"><span class="hs-comment">-- ^ @class@, type classes.</span></span><span>
</span><span id="line-83"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Binding"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Binding"><span class="hs-identifier hs-var">Binding</span></a></span></span><span>           </span><span class="annot"><span class="hs-comment">-- ^ Top-level variable or function binding.</span></span><span>
</span><span id="line-84"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Signature"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Signature"><span class="hs-identifier hs-var">Signature</span></a></span></span><span>         </span><span class="annot"><span class="hs-comment">-- ^ Top-level variable or function signature.</span></span><span>
</span><span id="line-85"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PatternSynonym"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#PatternSynonym"><span class="hs-identifier hs-var">PatternSynonym</span></a></span></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ Pattern synonym definition.</span></span><span>
</span><span id="line-86"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PatternSignature"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#PatternSignature"><span class="hs-identifier hs-var">PatternSignature</span></a></span></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ Pattern synonym signature.</span></span><span>
</span><span id="line-87"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ForeignImport"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#ForeignImport"><span class="hs-identifier hs-var">ForeignImport</span></a></span></span><span>     </span><span class="annot"><span class="hs-comment">-- ^ @foreign import@ declarations.</span></span><span>
</span><span id="line-88"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ForeignExport"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#ForeignExport"><span class="hs-identifier hs-var">ForeignExport</span></a></span></span><span>     </span><span class="annot"><span class="hs-comment">-- ^ @foreign export@ declarations.</span></span><span>
</span><span id="line-89"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="NamedDoc"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#NamedDoc"><span class="hs-identifier hs-var">NamedDoc</span></a></span></span><span>          </span><span class="annot"><span class="hs-comment">-- ^ Haddock markup, named chunk (@$name@).</span></span><span>
</span><span id="line-90"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679159892"><span id="local-6989586621679159894"><span id="local-6989586621679159898"><span class="annot"><span class="annottext">Int -&gt; EntityKind -&gt; ShowS
[EntityKind] -&gt; ShowS
EntityKind -&gt; [Char]
(Int -&gt; EntityKind -&gt; ShowS)
-&gt; (EntityKind -&gt; [Char])
-&gt; ([EntityKind] -&gt; ShowS)
-&gt; Show EntityKind
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; EntityKind -&gt; ShowS
showsPrec :: Int -&gt; EntityKind -&gt; ShowS
$cshow :: EntityKind -&gt; [Char]
show :: EntityKind -&gt; [Char]
$cshowList :: [EntityKind] -&gt; ShowS
showList :: [EntityKind] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679159902"><span id="local-6989586621679159904"><span class="annot"><span class="annottext">EntityKind -&gt; EntityKind -&gt; Bool
(EntityKind -&gt; EntityKind -&gt; Bool)
-&gt; (EntityKind -&gt; EntityKind -&gt; Bool) -&gt; Eq EntityKind
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: EntityKind -&gt; EntityKind -&gt; Bool
== :: EntityKind -&gt; EntityKind -&gt; Bool
$c/= :: EntityKind -&gt; EntityKind -&gt; Bool
/= :: EntityKind -&gt; EntityKind -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679159911"><span id="local-6989586621679159913"><span id="local-6989586621679159915"><span id="local-6989586621679159919"><span id="local-6989586621679159922"><span id="local-6989586621679159925"><span id="local-6989586621679159928"><span class="annot"><span class="annottext">Eq EntityKind
Eq EntityKind =&gt;
(EntityKind -&gt; EntityKind -&gt; Ordering)
-&gt; (EntityKind -&gt; EntityKind -&gt; Bool)
-&gt; (EntityKind -&gt; EntityKind -&gt; Bool)
-&gt; (EntityKind -&gt; EntityKind -&gt; Bool)
-&gt; (EntityKind -&gt; EntityKind -&gt; Bool)
-&gt; (EntityKind -&gt; EntityKind -&gt; EntityKind)
-&gt; (EntityKind -&gt; EntityKind -&gt; EntityKind)
-&gt; Ord EntityKind
EntityKind -&gt; EntityKind -&gt; Bool
EntityKind -&gt; EntityKind -&gt; Ordering
EntityKind -&gt; EntityKind -&gt; EntityKind
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
$ccompare :: EntityKind -&gt; EntityKind -&gt; Ordering
compare :: EntityKind -&gt; EntityKind -&gt; Ordering
$c&lt; :: EntityKind -&gt; EntityKind -&gt; Bool
&lt; :: EntityKind -&gt; EntityKind -&gt; Bool
$c&lt;= :: EntityKind -&gt; EntityKind -&gt; Bool
&lt;= :: EntityKind -&gt; EntityKind -&gt; Bool
$c&gt; :: EntityKind -&gt; EntityKind -&gt; Bool
&gt; :: EntityKind -&gt; EntityKind -&gt; Bool
$c&gt;= :: EntityKind -&gt; EntityKind -&gt; Bool
&gt;= :: EntityKind -&gt; EntityKind -&gt; Bool
$cmax :: EntityKind -&gt; EntityKind -&gt; EntityKind
max :: EntityKind -&gt; EntityKind -&gt; EntityKind
$cmin :: EntityKind -&gt; EntityKind -&gt; EntityKind
min :: EntityKind -&gt; EntityKind -&gt; EntityKind
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span class="annot"><span class="hs-comment">-- | Declared entity information.</span></span><span>
</span><span id="line-93"></span><span class="hs-keyword">data</span><span> </span><span id="Entity"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Entity"><span class="hs-identifier hs-var">Entity</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Entity"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Entity"><span class="hs-identifier hs-var">Entity</span></a></span></span><span>
</span><span id="line-94"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="%24sel%3Akind%3AEntity"><span class="annot"><span class="annottext">Entity -&gt; EntityKind
</span><a href="Test.DocTest.Driver.Extract.Ast.html#%24sel%3Akind%3AEntity"><span class="hs-identifier hs-var hs-var">kind</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#EntityKind"><span class="hs-identifier hs-type">EntityKind</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Entity kind.</span></span><span>
</span><span id="line-95"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="%24sel%3Aname%3AEntity"><span class="annot"><span class="annottext">Entity -&gt; FastString
</span><a href="Test.DocTest.Driver.Extract.Ast.html#%24sel%3Aname%3AEntity"><span class="hs-identifier hs-var hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">FastString</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Entity name.</span></span><span>
</span><span id="line-96"></span><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span id="local-6989586621679159935"><span id="local-6989586621679159940"><span class="annot"><span class="annottext">Entity -&gt; Entity -&gt; Bool
(Entity -&gt; Entity -&gt; Bool)
-&gt; (Entity -&gt; Entity -&gt; Bool) -&gt; Eq Entity
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: Entity -&gt; Entity -&gt; Bool
== :: Entity -&gt; Entity -&gt; Bool
$c/= :: Entity -&gt; Entity -&gt; Bool
/= :: Entity -&gt; Entity -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679159944"><span id="local-6989586621679159949"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-99"></span><span>  </span><span id="local-6989586621679159959"><span class="annot"><span class="annottext">show :: Entity -&gt; [Char]
</span><a href="#local-6989586621679159959"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">$sel:name:Entity :: Entity -&gt; FastString
</span><a href="Test.DocTest.Driver.Extract.Ast.html#%24sel%3Aname%3AEntity"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; [Char]
</span><span class="hs-identifier hs-var">unpackFS</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621679159961"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679159961"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679159962"><span class="annot"><span class="annottext">EntityKind
$sel:kind:Entity :: Entity -&gt; EntityKind
kind :: EntityKind
</span><a href="Test.DocTest.Driver.Extract.Ast.html#%24sel%3Akind%3AEntity"><span class="hs-identifier hs-var hs-var">kind</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">EntityKind
</span><a href="#local-6989586621679159962"><span class="hs-identifier hs-var">kind</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-100"></span><span>    </span><span class="annot"><span class="annottext">EntityKind
</span><a href="Test.DocTest.Driver.Extract.Ast.html#Section"><span class="hs-identifier hs-var">Section</span></a></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679159961"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-101"></span><span>    </span><span class="annot"><span class="annottext">EntityKind
</span><a href="Test.DocTest.Driver.Extract.Ast.html#DataFamily"><span class="hs-identifier hs-var">DataFamily</span></a></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;data family &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679159961"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-102"></span><span>    </span><span class="annot"><span class="annottext">EntityKind
</span><a href="Test.DocTest.Driver.Extract.Ast.html#TypeFamily"><span class="hs-identifier hs-var">TypeFamily</span></a></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;type family &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679159961"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-103"></span><span>    </span><span class="annot"><span class="annottext">EntityKind
</span><a href="Test.DocTest.Driver.Extract.Ast.html#NewType"><span class="hs-identifier hs-var">NewType</span></a></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;newtype &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679159961"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-104"></span><span>    </span><span class="annot"><span class="annottext">EntityKind
</span><a href="Test.DocTest.Driver.Extract.Ast.html#DataType"><span class="hs-identifier hs-var">DataType</span></a></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;data &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679159961"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-105"></span><span>    </span><span class="annot"><span class="annottext">EntityKind
</span><a href="Test.DocTest.Driver.Extract.Ast.html#TypeSynonym"><span class="hs-identifier hs-var">TypeSynonym</span></a></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;type &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679159961"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-106"></span><span>    </span><span class="annot"><span class="annottext">EntityKind
</span><a href="Test.DocTest.Driver.Extract.Ast.html#Class"><span class="hs-identifier hs-var">Class</span></a></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;class &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679159961"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-107"></span><span>    </span><span class="annot"><span class="annottext">EntityKind
</span><a href="Test.DocTest.Driver.Extract.Ast.html#Binding"><span class="hs-identifier hs-var">Binding</span></a></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679159961"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-108"></span><span>    </span><span class="annot"><span class="annottext">EntityKind
</span><a href="Test.DocTest.Driver.Extract.Ast.html#Signature"><span class="hs-identifier hs-var">Signature</span></a></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679159961"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-109"></span><span>    </span><span class="annot"><span class="annottext">EntityKind
</span><a href="Test.DocTest.Driver.Extract.Ast.html#PatternSynonym"><span class="hs-identifier hs-var">PatternSynonym</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;pattern &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679159961"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-110"></span><span>    </span><span class="annot"><span class="annottext">EntityKind
</span><a href="Test.DocTest.Driver.Extract.Ast.html#PatternSignature"><span class="hs-identifier hs-var">PatternSignature</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;pattern &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679159961"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-111"></span><span>    </span><span class="annot"><span class="annottext">EntityKind
</span><a href="Test.DocTest.Driver.Extract.Ast.html#ForeignImport"><span class="hs-identifier hs-var">ForeignImport</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679159961"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-112"></span><span>    </span><span class="annot"><span class="annottext">EntityKind
</span><a href="Test.DocTest.Driver.Extract.Ast.html#ForeignExport"><span class="hs-identifier hs-var">ForeignExport</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679159961"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-113"></span><span>    </span><span class="annot"><span class="annottext">EntityKind
</span><a href="Test.DocTest.Driver.Extract.Ast.html#NamedDoc"><span class="hs-identifier hs-var">NamedDoc</span></a></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679159961"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#lIdString"><span class="hs-identifier hs-type">lIdString</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GHC.LIdP</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">GhcPs</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FastString</span></span><span>
</span><span id="line-116"></span><span id="lIdString"><span class="annot"><span class="annottext">lIdString :: LIdP GhcPs -&gt; FastString
</span><a href="Test.DocTest.Driver.Extract.Ast.html#lIdString"><span class="hs-identifier hs-var hs-var">lIdString</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IdP GhcPs -&gt; FastString
RdrName -&gt; FastString
</span><a href="Test.DocTest.Driver.Extract.Ast.html#idString"><span class="hs-identifier hs-var">idString</span></a></span><span> </span><span class="annot"><span class="annottext">(RdrName -&gt; FastString)
-&gt; (GenLocated SrcSpanAnnN RdrName -&gt; RdrName)
-&gt; GenLocated SrcSpanAnnN RdrName
-&gt; FastString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnN RdrName -&gt; RdrName
forall l e. GenLocated l e -&gt; e
</span><span class="hs-identifier hs-var">unLoc</span></span><span>
</span><span id="line-117"></span><span>
</span><span id="line-118"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#idString"><span class="hs-identifier hs-type">idString</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GHC.IdP</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">GhcPs</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FastString</span></span><span>
</span><span id="line-119"></span><span id="idString"><span class="annot"><span class="annottext">idString :: IdP GhcPs -&gt; FastString
</span><a href="Test.DocTest.Driver.Extract.Ast.html#idString"><span class="hs-identifier hs-var hs-var">idString</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OccName -&gt; FastString
</span><span class="hs-identifier hs-var">occNameFS</span></span><span> </span><span class="annot"><span class="annottext">(OccName -&gt; FastString)
-&gt; (RdrName -&gt; OccName) -&gt; RdrName -&gt; FastString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">RdrName -&gt; OccName
</span><span class="hs-identifier hs-var">rdrNameOcc</span></span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span class="hs-comment">-- | Extract an 'Entity' for the declaration.</span><span>
</span><span id="line-122"></span><span class="hs-comment">--</span><span>
</span><span id="line-123"></span><span class="hs-comment">-- This is used to determine which declaration a Haddock document should attach to.</span><span>
</span><span id="line-124"></span><span class="hs-comment">--</span><span>
</span><span id="line-125"></span><span class="hs-comment">-- * @'Just' e@ if at least one entity is found, and @e@ is the first entity.</span><span>
</span><span id="line-126"></span><span class="hs-comment">-- * 'Nothing' if there is no entity the document could attach to.</span><span>
</span><span id="line-127"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#declEntity"><span class="hs-identifier hs-type">declEntity</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GHC.HsDecl</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">GhcPs</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span>
</span><span id="line-128"></span><span id="declEntity"><span class="annot"><span class="annottext">declEntity :: HsDecl GhcPs -&gt; Maybe Entity
</span><a href="Test.DocTest.Driver.Extract.Ast.html#declEntity"><span class="hs-identifier hs-var hs-var">declEntity</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GHC.TyClD</span></span><span> </span><span class="annot"><span class="annottext">XTyClD GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679159966"><span class="annot"><span class="annottext">TyClDecl GhcPs
</span><a href="#local-6989586621679159966"><span class="hs-identifier hs-var">decl</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TyClDecl GhcPs
</span><a href="#local-6989586621679159966"><span class="hs-identifier hs-var">decl</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-129"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">GHC.FamDecl</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Entity -&gt; Maybe Entity
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">$sel:kind:Entity :: EntityKind
</span><a href="Test.DocTest.Driver.Extract.Ast.html#%24sel%3Akind%3AEntity"><span class="hs-identifier hs-var">kind</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FamilyInfo GhcPs -&gt; EntityKind
forall {pass}. FamilyInfo pass -&gt; EntityKind
</span><a href="#local-6989586621679159968"><span class="hs-identifier hs-var">familyKind</span></a></span><span> </span><span class="annot"><span class="annottext">TyClDecl GhcPs
</span><a href="#local-6989586621679159966"><span class="hs-identifier hs-var">decl</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">tcdFam</span><span class="hs-operator">.</span><span class="hs-identifier">fdInfo</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:name:Entity :: FastString
</span><a href="Test.DocTest.Driver.Extract.Ast.html#%24sel%3Aname%3AEntity"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LIdP GhcPs -&gt; FastString
</span><a href="Test.DocTest.Driver.Extract.Ast.html#lIdString"><span class="hs-identifier hs-var">lIdString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FamilyDecl GhcPs -&gt; LIdP GhcPs
forall pass. FamilyDecl pass -&gt; LIdP pass
</span><span class="hs-identifier hs-var">GHC.fdLName</span></span><span> </span><span class="annot"><span class="annottext">TyClDecl GhcPs
</span><a href="#local-6989586621679159966"><span class="hs-identifier hs-var">decl</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">tcdFam</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-130"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">GHC.SynDecl</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Entity -&gt; Maybe Entity
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">$sel:kind:Entity :: EntityKind
</span><a href="Test.DocTest.Driver.Extract.Ast.html#%24sel%3Akind%3AEntity"><span class="hs-identifier hs-var">kind</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EntityKind
</span><a href="Test.DocTest.Driver.Extract.Ast.html#TypeSynonym"><span class="hs-identifier hs-var">TypeSynonym</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:name:Entity :: FastString
</span><a href="Test.DocTest.Driver.Extract.Ast.html#%24sel%3Aname%3AEntity"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LIdP GhcPs -&gt; FastString
</span><a href="Test.DocTest.Driver.Extract.Ast.html#lIdString"><span class="hs-identifier hs-var">lIdString</span></a></span><span> </span><span class="annot"><span class="annottext">TyClDecl GhcPs
</span><a href="#local-6989586621679159966"><span class="hs-identifier hs-var">decl</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">tcdLName</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-131"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">GHC.DataDecl</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Entity -&gt; Maybe Entity
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">$sel:kind:Entity :: EntityKind
</span><a href="Test.DocTest.Driver.Extract.Ast.html#%24sel%3Akind%3AEntity"><span class="hs-identifier hs-var">kind</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataDefnCons (XRec GhcPs (ConDecl GhcPs)) -&gt; EntityKind
forall {a}. DataDefnCons a -&gt; EntityKind
</span><a href="#local-6989586621679159972"><span class="hs-identifier hs-var">dataKind</span></a></span><span> </span><span class="annot"><span class="annottext">TyClDecl GhcPs
</span><a href="#local-6989586621679159966"><span class="hs-identifier hs-var">decl</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">tcdDataDefn</span><span class="hs-operator">.</span><span class="hs-identifier">dd_cons</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:name:Entity :: FastString
</span><a href="Test.DocTest.Driver.Extract.Ast.html#%24sel%3Aname%3AEntity"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LIdP GhcPs -&gt; FastString
</span><a href="Test.DocTest.Driver.Extract.Ast.html#lIdString"><span class="hs-identifier hs-var">lIdString</span></a></span><span> </span><span class="annot"><span class="annottext">TyClDecl GhcPs
</span><a href="#local-6989586621679159966"><span class="hs-identifier hs-var">decl</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">tcdLName</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-132"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">GHC.ClassDecl</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Entity -&gt; Maybe Entity
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">$sel:kind:Entity :: EntityKind
</span><a href="Test.DocTest.Driver.Extract.Ast.html#%24sel%3Akind%3AEntity"><span class="hs-identifier hs-var">kind</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EntityKind
</span><a href="Test.DocTest.Driver.Extract.Ast.html#Class"><span class="hs-identifier hs-var">Class</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:name:Entity :: FastString
</span><a href="Test.DocTest.Driver.Extract.Ast.html#%24sel%3Aname%3AEntity"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LIdP GhcPs -&gt; FastString
</span><a href="Test.DocTest.Driver.Extract.Ast.html#lIdString"><span class="hs-identifier hs-var">lIdString</span></a></span><span> </span><span class="annot"><span class="annottext">TyClDecl GhcPs
</span><a href="#local-6989586621679159966"><span class="hs-identifier hs-var">decl</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">tcdLName</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-133"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679159968"><span class="annot"><span class="annottext">familyKind :: FamilyInfo pass -&gt; EntityKind
</span><a href="#local-6989586621679159968"><span class="hs-identifier hs-var hs-var">familyKind</span></a></span></span><span> </span><span class="annot"><span class="annottext">FamilyInfo pass
</span><span class="hs-identifier hs-var">GHC.DataFamily</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EntityKind
</span><a href="Test.DocTest.Driver.Extract.Ast.html#DataFamily"><span class="hs-identifier hs-var">DataFamily</span></a></span><span>
</span><span id="line-134"></span><span>        </span><span class="annot"><a href="#local-6989586621679159968"><span class="hs-identifier hs-var">familyKind</span></a></span><span> </span><span class="annot"><span class="annottext">FamilyInfo pass
</span><span class="hs-identifier">_</span></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EntityKind
</span><a href="Test.DocTest.Driver.Extract.Ast.html#TypeFamily"><span class="hs-identifier hs-var">TypeFamily</span></a></span><span>
</span><span id="line-135"></span><span>        </span><span id="local-6989586621679159972"><span class="annot"><span class="annottext">dataKind :: DataDefnCons a -&gt; EntityKind
</span><a href="#local-6989586621679159972"><span class="hs-identifier hs-var hs-var">dataKind</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">GHC.NewTypeCon</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EntityKind
</span><a href="Test.DocTest.Driver.Extract.Ast.html#NewType"><span class="hs-identifier hs-var">NewType</span></a></span><span>
</span><span id="line-136"></span><span>        </span><span class="annot"><a href="#local-6989586621679159972"><span class="hs-identifier hs-var">dataKind</span></a></span><span> </span><span class="annot"><span class="annottext">DataDefnCons a
</span><span class="hs-identifier">_</span></span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EntityKind
</span><a href="Test.DocTest.Driver.Extract.Ast.html#DataType"><span class="hs-identifier hs-var">DataType</span></a></span><span>
</span><span id="line-137"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#declEntity"><span class="hs-identifier hs-var">declEntity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GHC.ValD</span></span><span> </span><span class="annot"><span class="annottext">XValD GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679159977"><span class="annot"><span class="annottext">HsBind GhcPs
</span><a href="#local-6989586621679159977"><span class="hs-identifier hs-var">bind</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HsBind GhcPs
</span><a href="#local-6989586621679159977"><span class="hs-identifier hs-var">bind</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-138"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">GHC.FunBind</span></span><span class="hs-special">{</span><span> </span><span id="local-6989586621679159979"><span class="annot"><span class="annottext">LIdP GhcPs
fun_id :: LIdP GhcPs
fun_id :: forall idL idR. HsBindLR idL idR -&gt; LIdP idL
</span><a href="#local-6989586621679159979"><span class="hs-identifier hs-var hs-var">fun_id</span></a></span></span><span> </span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Entity -&gt; Maybe Entity
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">$sel:kind:Entity :: EntityKind
</span><a href="Test.DocTest.Driver.Extract.Ast.html#%24sel%3Akind%3AEntity"><span class="hs-identifier hs-var">kind</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EntityKind
</span><a href="Test.DocTest.Driver.Extract.Ast.html#Binding"><span class="hs-identifier hs-var">Binding</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:name:Entity :: FastString
</span><a href="Test.DocTest.Driver.Extract.Ast.html#%24sel%3Aname%3AEntity"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LIdP GhcPs -&gt; FastString
</span><a href="Test.DocTest.Driver.Extract.Ast.html#lIdString"><span class="hs-identifier hs-var">lIdString</span></a></span><span> </span><span class="annot"><span class="annottext">LIdP GhcPs
</span><a href="#local-6989586621679159979"><span class="hs-identifier hs-var">fun_id</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-139"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">GHC.VarBind</span></span><span class="hs-special">{</span><span> </span><span id="local-6989586621679159982"><span class="annot"><span class="annottext">IdP GhcPs
var_id :: IdP GhcPs
var_id :: forall idL idR. HsBindLR idL idR -&gt; IdP idL
</span><a href="#local-6989586621679159982"><span class="hs-identifier hs-var hs-var">var_id</span></a></span></span><span> </span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Entity -&gt; Maybe Entity
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">$sel:kind:Entity :: EntityKind
</span><a href="Test.DocTest.Driver.Extract.Ast.html#%24sel%3Akind%3AEntity"><span class="hs-identifier hs-var">kind</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EntityKind
</span><a href="Test.DocTest.Driver.Extract.Ast.html#Binding"><span class="hs-identifier hs-var">Binding</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:name:Entity :: FastString
</span><a href="Test.DocTest.Driver.Extract.Ast.html#%24sel%3Aname%3AEntity"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IdP GhcPs -&gt; FastString
</span><a href="Test.DocTest.Driver.Extract.Ast.html#idString"><span class="hs-identifier hs-var">idString</span></a></span><span> </span><span class="annot"><span class="annottext">IdP GhcPs
</span><a href="#local-6989586621679159982"><span class="hs-identifier hs-var">var_id</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-140"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">GHC.PatBind</span></span><span class="hs-special">{</span><span> </span><span id="local-6989586621679159985"><span class="annot"><span class="annottext">LPat GhcPs
pat_lhs :: LPat GhcPs
pat_lhs :: forall idL idR. HsBindLR idL idR -&gt; LPat idL
</span><a href="#local-6989586621679159985"><span class="hs-identifier hs-var hs-var">pat_lhs</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (Pat GhcPs) -&gt; Maybe FastString
forall a b. (Data a, Typeable b) =&gt; a -&gt; Maybe b
</span><a href="Test.DocTest.Driver.Extract.Ast.html#gFirst"><span class="hs-identifier hs-var">gFirst</span></a></span><span> </span><span class="annot"><span class="annottext">LPat GhcPs
GenLocated SrcSpanAnnA (Pat GhcPs)
</span><a href="#local-6989586621679159985"><span class="hs-identifier hs-var">pat_lhs</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe FastString -&gt; (FastString -&gt; Entity) -&gt; Maybe Entity
forall (f :: Type -&gt; Type) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><span class="hs-operator hs-var">&lt;&amp;&gt;</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679159988"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621679159988"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">$sel:kind:Entity :: EntityKind
</span><a href="Test.DocTest.Driver.Extract.Ast.html#%24sel%3Akind%3AEntity"><span class="hs-identifier hs-var">kind</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EntityKind
</span><a href="Test.DocTest.Driver.Extract.Ast.html#Binding"><span class="hs-identifier hs-var">Binding</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FastString
$sel:name:Entity :: FastString
name :: FastString
</span><a href="Test.DocTest.Driver.Extract.Ast.html#%24sel%3Aname%3AEntity"><span class="hs-identifier hs-var hs-var">name</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-141"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">GHC.PatSynBind</span></span><span> </span><span class="annot"><span class="annottext">XPatSynBind GhcPs GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679159990"><span class="annot"><span class="annottext">PatSynBind GhcPs GhcPs
</span><a href="#local-6989586621679159990"><span class="hs-identifier hs-var">pat</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Entity -&gt; Maybe Entity
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">$sel:kind:Entity :: EntityKind
</span><a href="Test.DocTest.Driver.Extract.Ast.html#%24sel%3Akind%3AEntity"><span class="hs-identifier hs-var">kind</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EntityKind
</span><a href="Test.DocTest.Driver.Extract.Ast.html#PatternSynonym"><span class="hs-identifier hs-var">PatternSynonym</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:name:Entity :: FastString
</span><a href="Test.DocTest.Driver.Extract.Ast.html#%24sel%3Aname%3AEntity"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LIdP GhcPs -&gt; FastString
</span><a href="Test.DocTest.Driver.Extract.Ast.html#lIdString"><span class="hs-identifier hs-var">lIdString</span></a></span><span> </span><span class="annot"><span class="annottext">PatSynBind GhcPs GhcPs
</span><a href="#local-6989586621679159990"><span class="hs-identifier hs-var">pat</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">psb_id</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-142"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#declEntity"><span class="hs-identifier hs-var">declEntity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GHC.SigD</span></span><span> </span><span class="annot"><span class="annottext">XSigD GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679159992"><span class="annot"><span class="annottext">Sig GhcPs
</span><a href="#local-6989586621679159992"><span class="hs-identifier hs-var">sig</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Sig GhcPs
</span><a href="#local-6989586621679159992"><span class="hs-identifier hs-var">sig</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-143"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">GHC.TypeSig</span></span><span>   </span><span class="annot"><span class="annottext">XTypeSig GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679159994"><span class="annot"><span class="annottext">[LIdP GhcPs]
</span><a href="#local-6989586621679159994"><span class="hs-identifier hs-var">names</span></a></span></span><span> </span><span class="annot"><span class="annottext">LHsSigWcType GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Entity -&gt; Maybe Entity
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">$sel:kind:Entity :: EntityKind
</span><a href="Test.DocTest.Driver.Extract.Ast.html#%24sel%3Akind%3AEntity"><span class="hs-identifier hs-var">kind</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EntityKind
</span><a href="Test.DocTest.Driver.Extract.Ast.html#Signature"><span class="hs-identifier hs-var">Signature</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:name:Entity :: FastString
</span><a href="Test.DocTest.Driver.Extract.Ast.html#%24sel%3Aname%3AEntity"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LIdP GhcPs -&gt; FastString
</span><a href="Test.DocTest.Driver.Extract.Ast.html#lIdString"><span class="hs-identifier hs-var">lIdString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[GenLocated SrcSpanAnnN RdrName] -&gt; GenLocated SrcSpanAnnN RdrName
forall a. HasCallStack =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[LIdP GhcPs]
[GenLocated SrcSpanAnnN RdrName]
</span><a href="#local-6989586621679159994"><span class="hs-identifier hs-var">names</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-144"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">GHC.PatSynSig</span></span><span> </span><span class="annot"><span class="annottext">XPatSynSig GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679159997"><span class="annot"><span class="annottext">[LIdP GhcPs]
</span><a href="#local-6989586621679159997"><span class="hs-identifier hs-var">names</span></a></span></span><span> </span><span class="annot"><span class="annottext">LHsSigType GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Entity -&gt; Maybe Entity
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">$sel:kind:Entity :: EntityKind
</span><a href="Test.DocTest.Driver.Extract.Ast.html#%24sel%3Akind%3AEntity"><span class="hs-identifier hs-var">kind</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EntityKind
</span><a href="Test.DocTest.Driver.Extract.Ast.html#PatternSignature"><span class="hs-identifier hs-var">PatternSignature</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:name:Entity :: FastString
</span><a href="Test.DocTest.Driver.Extract.Ast.html#%24sel%3Aname%3AEntity"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LIdP GhcPs -&gt; FastString
</span><a href="Test.DocTest.Driver.Extract.Ast.html#lIdString"><span class="hs-identifier hs-var">lIdString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[GenLocated SrcSpanAnnN RdrName] -&gt; GenLocated SrcSpanAnnN RdrName
forall a. HasCallStack =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[LIdP GhcPs]
[GenLocated SrcSpanAnnN RdrName]
</span><a href="#local-6989586621679159997"><span class="hs-identifier hs-var">names</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-145"></span><span>  </span><span class="annot"><span class="annottext">Sig GhcPs
</span><span class="hs-identifier">_</span></span><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Entity
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-146"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#declEntity"><span class="hs-identifier hs-var">declEntity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GHC.ForD</span></span><span> </span><span class="annot"><span class="annottext">XForD GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679159999"><span class="annot"><span class="annottext">ForeignDecl GhcPs
</span><a href="#local-6989586621679159999"><span class="hs-identifier hs-var">decl</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ForeignDecl GhcPs
</span><a href="#local-6989586621679159999"><span class="hs-identifier hs-var">decl</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-147"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">GHC.ForeignImport</span></span><span class="hs-special">{</span><span> </span><span id="local-6989586621679160001"><span class="annot"><span class="annottext">LIdP GhcPs
fd_name :: LIdP GhcPs
fd_name :: forall pass. ForeignDecl pass -&gt; LIdP pass
</span><a href="#local-6989586621679160001"><span class="hs-identifier hs-var hs-var">fd_name</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Entity -&gt; Maybe Entity
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">$sel:kind:Entity :: EntityKind
</span><a href="Test.DocTest.Driver.Extract.Ast.html#%24sel%3Akind%3AEntity"><span class="hs-identifier hs-var">kind</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EntityKind
</span><a href="Test.DocTest.Driver.Extract.Ast.html#ForeignImport"><span class="hs-identifier hs-var">ForeignImport</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:name:Entity :: FastString
</span><a href="Test.DocTest.Driver.Extract.Ast.html#%24sel%3Aname%3AEntity"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LIdP GhcPs -&gt; FastString
</span><a href="Test.DocTest.Driver.Extract.Ast.html#lIdString"><span class="hs-identifier hs-var">lIdString</span></a></span><span> </span><span class="annot"><span class="annottext">LIdP GhcPs
</span><a href="#local-6989586621679160001"><span class="hs-identifier hs-var">fd_name</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-148"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">GHC.ForeignExport</span></span><span class="hs-special">{</span><span> </span><span id="local-6989586621679160004"><span class="annot"><span class="annottext">LIdP GhcPs
fd_name :: forall pass. ForeignDecl pass -&gt; LIdP pass
fd_name :: LIdP GhcPs
</span><span class="hs-identifier hs-var hs-var">fd_name</span></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Entity -&gt; Maybe Entity
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">$sel:kind:Entity :: EntityKind
</span><a href="Test.DocTest.Driver.Extract.Ast.html#%24sel%3Akind%3AEntity"><span class="hs-identifier hs-var">kind</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EntityKind
</span><a href="Test.DocTest.Driver.Extract.Ast.html#ForeignExport"><span class="hs-identifier hs-var">ForeignExport</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:name:Entity :: FastString
</span><a href="Test.DocTest.Driver.Extract.Ast.html#%24sel%3Aname%3AEntity"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LIdP GhcPs -&gt; FastString
</span><a href="Test.DocTest.Driver.Extract.Ast.html#lIdString"><span class="hs-identifier hs-var">lIdString</span></a></span><span> </span><span class="annot"><span class="annottext">LIdP GhcPs
</span><a href="#local-6989586621679160004"><span class="hs-identifier hs-var">fd_name</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-149"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#declEntity"><span class="hs-identifier hs-var">declEntity</span></a></span><span> </span><span class="annot"><span class="annottext">HsDecl GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Entity
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span id="local-6989586621679159287"><span id="local-6989586621679159288"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#gFirst"><span class="hs-identifier hs-type">gFirst</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Data</span></span><span> </span><span class="annot"><a href="#local-6989586621679159287"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621679159288"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679159287"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679159288"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-152"></span><span id="gFirst"><span class="annot"><span class="annottext">gFirst :: forall a b. (Data a, Typeable b) =&gt; a -&gt; Maybe b
</span><a href="Test.DocTest.Driver.Extract.Ast.html#gFirst"><span class="hs-identifier hs-var hs-var">gFirst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">First b -&gt; Maybe b
forall a. First a -&gt; Maybe a
</span><span class="hs-identifier hs-var">getFirst</span></span><span> </span><span class="annot"><span class="annottext">(First b -&gt; Maybe b) -&gt; (a -&gt; First b) -&gt; a -&gt; Maybe b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(First b -&gt; First b -&gt; First b)
-&gt; GenericQ (First b) -&gt; GenericQ (First b)
forall r. (r -&gt; r -&gt; r) -&gt; GenericQ r -&gt; GenericQ r
</span><span class="hs-identifier hs-var">everything</span></span><span> </span><span class="annot"><span class="annottext">First b -&gt; First b -&gt; First b
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(&lt;&gt;)</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">First b -&gt; (Maybe b -&gt; First b) -&gt; a -&gt; First b
forall a b r. (Typeable a, Typeable b) =&gt; r -&gt; (b -&gt; r) -&gt; a -&gt; r
</span><span class="hs-identifier hs-var">mkQ</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe b -&gt; First b
forall a. Maybe a -&gt; First a
</span><span class="hs-identifier hs-var">First</span></span><span> </span><span class="annot"><span class="annottext">Maybe b
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe b -&gt; First b
forall a. Maybe a -&gt; First a
</span><span class="hs-identifier hs-var">First</span></span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span class="annot"><span class="hs-comment">-- | Create a 'NamedDoc' entity representing a named doc comment.</span></span><span>
</span><span id="line-155"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#nameEntity"><span class="hs-identifier hs-type">nameEntity</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span>
</span><span id="line-156"></span><span id="nameEntity"><span class="annot"><span class="annottext">nameEntity :: [Char] -&gt; Entity
</span><a href="Test.DocTest.Driver.Extract.Ast.html#nameEntity"><span class="hs-identifier hs-var hs-var">nameEntity</span></a></span></span><span> </span><span id="local-6989586621679160018"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679160018"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">$sel:kind:Entity :: EntityKind
</span><a href="Test.DocTest.Driver.Extract.Ast.html#%24sel%3Akind%3AEntity"><span class="hs-identifier hs-var">kind</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EntityKind
</span><a href="Test.DocTest.Driver.Extract.Ast.html#NamedDoc"><span class="hs-identifier hs-var">NamedDoc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:name:Entity :: FastString
</span><a href="Test.DocTest.Driver.Extract.Ast.html#%24sel%3Aname%3AEntity"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; FastString
</span><span class="hs-identifier hs-var">mkFastString</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679160018"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-157"></span><span>
</span><span id="line-158"></span><span class="annot"><span class="hs-comment">-- | Extracted DocTest items.</span></span><span>
</span><span id="line-159"></span><span class="hs-keyword">data</span><span> </span><span id="DocTests"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocTests"><span class="hs-identifier hs-var">DocTests</span></a></span></span><span>
</span><span id="line-160"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="Group"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Group"><span class="hs-identifier hs-var">Group</span></a></span></span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Loc"><span class="hs-identifier hs-type">Loc</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocTests"><span class="hs-identifier hs-type">DocTests</span></a></span><span class="hs-special">]</span><span>         </span><span class="annot"><span class="hs-comment">-- ^ Group, translated to @describe@.</span></span><span>
</span><span id="line-161"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="TestProperty"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#TestProperty"><span class="hs-identifier hs-var">TestProperty</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocLine"><span class="hs-identifier hs-type">DocLine</span></a></span><span class="hs-special">)</span><span>     </span><span class="annot"><span class="hs-comment">-- ^ Property, to be tested with QuickCheck.</span></span><span>
</span><span id="line-162"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="TestExample"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#TestExample"><span class="hs-identifier hs-var">TestExample</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#ExampleLine"><span class="hs-identifier hs-type">ExampleLine</span></a></span><span class="hs-special">)</span><span>  </span><span class="annot"><span class="hs-comment">-- ^ Example, compared with expected output.</span></span><span>
</span><span id="line-163"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="TestMultiline"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#TestMultiline"><span class="hs-identifier hs-var">TestMultiline</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocLine"><span class="hs-identifier hs-type">DocLine</span></a></span><span class="hs-special">)</span><span>    </span><span class="annot"><span class="hs-comment">-- ^ Multiline tests.</span></span><span>
</span><span id="line-164"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Capture"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Capture"><span class="hs-identifier hs-var">Capture</span></a></span></span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#CapturedContent"><span class="hs-identifier hs-type">CapturedContent</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocTests"><span class="hs-identifier hs-type">DocTests</span></a></span><span class="hs-special">]</span><span>  </span><span class="annot"><span class="hs-comment">-- ^ Captured string literal.</span></span><span>
</span><span id="line-165"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="TestHook"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#TestHook"><span class="hs-identifier hs-var">TestHook</span></a></span></span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#IOHook"><span class="hs-identifier hs-type">IOHook</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocTests"><span class="hs-identifier hs-type">DocTests</span></a></span><span class="hs-special">]</span><span>          </span><span class="annot"><span class="hs-comment">-- ^ 'IO' hook: @before@, @beforeAll@, @after@, @afterAll@.</span></span><span>
</span><span id="line-166"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Warning"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Warning"><span class="hs-identifier hs-var">Warning</span></a></span></span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Loc"><span class="hs-identifier hs-type">Loc</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>                  </span><span class="annot"><span class="hs-comment">-- ^ Problems detected while extracting the DocTests.</span></span><span>
</span><span id="line-167"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679160027"><span id="local-6989586621679160059"><span id="local-6989586621679160063"><span class="annot"><span class="annottext">Int -&gt; DocTests -&gt; ShowS
[DocTests] -&gt; ShowS
DocTests -&gt; [Char]
(Int -&gt; DocTests -&gt; ShowS)
-&gt; (DocTests -&gt; [Char]) -&gt; ([DocTests] -&gt; ShowS) -&gt; Show DocTests
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; DocTests -&gt; ShowS
showsPrec :: Int -&gt; DocTests -&gt; ShowS
$cshow :: DocTests -&gt; [Char]
show :: DocTests -&gt; [Char]
$cshowList :: [DocTests] -&gt; ShowS
showList :: [DocTests] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679160071"><span id="local-6989586621679160095"><span class="annot"><span class="annottext">DocTests -&gt; DocTests -&gt; Bool
(DocTests -&gt; DocTests -&gt; Bool)
-&gt; (DocTests -&gt; DocTests -&gt; Bool) -&gt; Eq DocTests
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: DocTests -&gt; DocTests -&gt; Bool
== :: DocTests -&gt; DocTests -&gt; Bool
$c/= :: DocTests -&gt; DocTests -&gt; Bool
/= :: DocTests -&gt; DocTests -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span>
</span><span id="line-169"></span><span class="annot"><span class="hs-comment">-- | A single line from the DocTests, rendered with @{-# LINE ... #-}@ and @{-# COLUMN ... #-}@.</span></span><span>
</span><span id="line-170"></span><span class="hs-keyword">data</span><span> </span><span id="DocLine"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocLine"><span class="hs-identifier hs-var">DocLine</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="DocLine"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocLine"><span class="hs-identifier hs-var">DocLine</span></a></span></span><span>
</span><span id="line-171"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="%24sel%3Alocation%3ADocLine"><span class="annot"><span class="annottext">DocLine -&gt; Loc
</span><a href="Test.DocTest.Driver.Extract.Ast.html#%24sel%3Alocation%3ADocLine"><span class="hs-identifier hs-var hs-var">location</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Loc"><span class="hs-identifier hs-type">Loc</span></a></span><span>     </span><span class="annot"><span class="hs-comment">-- ^ Original source location.</span></span><span>
</span><span id="line-172"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AtextLine%3ADocLine"><span class="annot"><span class="annottext">DocLine -&gt; [Char]
</span><a href="Test.DocTest.Driver.Extract.Ast.html#%24sel%3AtextLine%3ADocLine"><span class="hs-identifier hs-var hs-var">textLine</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ Content of the line.</span></span><span>
</span><span id="line-173"></span><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679160105"><span id="local-6989586621679160113"><span id="local-6989586621679160116"><span class="annot"><span class="annottext">Int -&gt; DocLine -&gt; ShowS
[DocLine] -&gt; ShowS
DocLine -&gt; [Char]
(Int -&gt; DocLine -&gt; ShowS)
-&gt; (DocLine -&gt; [Char]) -&gt; ([DocLine] -&gt; ShowS) -&gt; Show DocLine
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; DocLine -&gt; ShowS
showsPrec :: Int -&gt; DocLine -&gt; ShowS
$cshow :: DocLine -&gt; [Char]
show :: DocLine -&gt; [Char]
$cshowList :: [DocLine] -&gt; ShowS
showList :: [DocLine] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679160119"><span id="local-6989586621679160125"><span class="annot"><span class="annottext">DocLine -&gt; DocLine -&gt; Bool
(DocLine -&gt; DocLine -&gt; Bool)
-&gt; (DocLine -&gt; DocLine -&gt; Bool) -&gt; Eq DocLine
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: DocLine -&gt; DocLine -&gt; Bool
== :: DocLine -&gt; DocLine -&gt; Bool
$c/= :: DocLine -&gt; DocLine -&gt; Bool
/= :: DocLine -&gt; DocLine -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#emptyLine"><span class="hs-identifier hs-type">emptyLine</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocLine"><span class="hs-identifier hs-type">DocLine</span></a></span><span>
</span><span id="line-176"></span><span id="emptyLine"><span class="annot"><span class="annottext">emptyLine :: DocLine
</span><a href="Test.DocTest.Driver.Extract.Ast.html#emptyLine"><span class="hs-identifier hs-var hs-var">emptyLine</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocLine"><span class="hs-identifier hs-type">DocLine</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">$sel:location:DocLine :: Loc
</span><a href="Test.DocTest.Driver.Extract.Ast.html#%24sel%3Alocation%3ADocLine"><span class="hs-identifier hs-var">location</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Loc
</span><a href="Test.DocTest.Driver.Extract.Ast.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:textLine:DocLine :: [Char]
</span><a href="Test.DocTest.Driver.Extract.Ast.html#%24sel%3AtextLine%3ADocLine"><span class="hs-identifier hs-var">textLine</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-177"></span><span>
</span><span id="line-178"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#replaceLeadingTabs"><span class="hs-identifier hs-type">replaceLeadingTabs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocLine"><span class="hs-identifier hs-type">DocLine</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocLine"><span class="hs-identifier hs-type">DocLine</span></a></span><span>
</span><span id="line-179"></span><span id="replaceLeadingTabs"><span class="annot"><span class="annottext">replaceLeadingTabs :: DocLine -&gt; DocLine
</span><a href="Test.DocTest.Driver.Extract.Ast.html#replaceLeadingTabs"><span class="hs-identifier hs-var hs-var">replaceLeadingTabs</span></a></span></span><span> </span><span id="local-6989586621679160129"><span class="annot"><span class="annottext">DocLine
</span><a href="#local-6989586621679160129"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DocLine
</span><a href="#local-6989586621679160129"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#%24sel%3AtextLine%3ADocLine"><span class="hs-identifier hs-var">textLine</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">replicate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679160131"><span class="hs-identifier hs-type">restCol</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><a href="#local-6989586621679160132"><span class="hs-identifier hs-type">startCol</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-char">' '</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><a href="#local-6989586621679160133"><span class="hs-identifier hs-type">rest</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-180"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679160134"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679160134"><span class="hs-identifier hs-var">leading</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679160133"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679160133"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; [Char] -&gt; ([Char], [Char])
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">span</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isSpace</span></span><span> </span><span class="annot"><span class="annottext">DocLine
</span><a href="#local-6989586621679160129"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">textLine</span><span>
</span><span id="line-181"></span><span>        </span><span id="local-6989586621679160132"><span class="annot"><span class="annottext">startCol :: Int
</span><a href="#local-6989586621679160132"><span class="hs-identifier hs-var hs-var">startCol</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FastString -&gt; Int) -&gt; (RealSrcLoc -&gt; Int) -&gt; Loc -&gt; Int
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; FastString -&gt; Int
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">RealSrcLoc -&gt; Int
</span><span class="hs-identifier hs-var">GHC.srcLocCol</span></span><span> </span><span class="annot"><span class="annottext">DocLine
</span><a href="#local-6989586621679160129"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">location</span><span>
</span><span id="line-182"></span><span>        </span><span id="local-6989586621679160131"><span class="annot"><span class="annottext">restCol :: Int
</span><a href="#local-6989586621679160131"><span class="hs-identifier hs-var hs-var">restCol</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Int -&gt; Int) -&gt; Int -&gt; [Char] -&gt; Int
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: Type -&gt; Type) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Int -&gt; Int
</span><a href="Test.DocTest.Driver.Extract.Ast.html#advanceCol"><span class="hs-identifier hs-var">advanceCol</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679160132"><span class="hs-identifier hs-var">startCol</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679160134"><span class="hs-identifier hs-var">leading</span></a></span><span>
</span><span id="line-183"></span><span>
</span><span id="line-184"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#advanceCol"><span class="hs-identifier hs-type">advanceCol</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-185"></span><span id="advanceCol"><span class="annot"><span class="annottext">advanceCol :: Char -&gt; Int -&gt; Int
</span><a href="Test.DocTest.Driver.Extract.Ast.html#advanceCol"><span class="hs-identifier hs-var hs-var">advanceCol</span></a></span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\n'</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Int
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;no newline allowed in DocLine&quot;</span></span><span>
</span><span id="line-186"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#advanceCol"><span class="hs-identifier hs-var">advanceCol</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\t'</span></span><span> </span><span id="local-6989586621679160140"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679160140"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679160140"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-187"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#advanceCol"><span class="hs-identifier hs-var">advanceCol</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-identifier">_</span></span><span>    </span><span id="local-6989586621679160143"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679160143"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679160143"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span id="local-6989586621679159337"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#unindentLines"><span class="hs-identifier hs-type">unindentLines</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679159337"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679159337"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocLine"><span class="hs-identifier hs-type">DocLine</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679159337"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocLine"><span class="hs-identifier hs-type">DocLine</span></a></span></span><span>
</span><span id="line-190"></span><span id="unindentLines"><span class="annot"><span class="annottext">unindentLines :: forall (t :: Type -&gt; Type). Traversable t =&gt; t DocLine -&gt; t DocLine
</span><a href="Test.DocTest.Driver.Extract.Ast.html#unindentLines"><span class="hs-identifier hs-var hs-var">unindentLines</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DocLine -&gt; DocLine) -&gt; t DocLine -&gt; t DocLine
forall a b. (a -&gt; b) -&gt; t a -&gt; t b
forall (f :: Type -&gt; Type) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">DocLine -&gt; DocLine
</span><a href="Test.DocTest.Driver.Extract.Ast.html#replaceLeadingTabs"><span class="hs-identifier hs-var">replaceLeadingTabs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621679160165"><span class="annot"><span class="annottext">t DocLine
</span><a href="#local-6989586621679160165"><span class="hs-identifier hs-var">theLines</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(DocLine -&gt; DocLine) -&gt; t DocLine -&gt; t DocLine
forall a b. (a -&gt; b) -&gt; t a -&gt; t b
forall (f :: Type -&gt; Type) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">DocLine -&gt; DocLine
</span><a href="#local-6989586621679160166"><span class="hs-identifier hs-var">dropSpace</span></a></span><span> </span><span class="annot"><span class="annottext">t DocLine
</span><a href="#local-6989586621679160165"><span class="hs-identifier hs-var">theLines</span></a></span><span>
</span><span id="line-191"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-comment">-- since all-white lines are excluded, we must not use 'minimum'</span><span>
</span><span id="line-192"></span><span>        </span><span class="hs-comment">-- because 'minimum' diverges for empty sequences</span><span>
</span><span id="line-193"></span><span>        </span><span id="local-6989586621679160167"><span class="annot"><span class="annottext">level :: Int
</span><a href="#local-6989586621679160167"><span class="hs-identifier hs-var hs-var">level</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; (Min Int -&gt; Int) -&gt; Maybe (Min Int) -&gt; Int
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Min Int -&gt; Int
forall a. Min a -&gt; a
</span><span class="hs-identifier hs-var">getMin</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (Min Int) -&gt; Int) -&gt; Maybe (Min Int) -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Maybe (Min Int)) -&gt; Compose t Maybe Int -&gt; Maybe (Min Int)
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; Compose t Maybe a -&gt; m
forall (t :: Type -&gt; Type) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Min Int -&gt; Maybe (Min Int)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Min Int -&gt; Maybe (Min Int))
-&gt; (Int -&gt; Min Int) -&gt; Int -&gt; Maybe (Min Int)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Min Int
forall a. a -&gt; Min a
</span><span class="hs-identifier hs-var">Min</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t (Maybe Int) -&gt; Compose t Maybe Int
forall {k} {k1} (f :: k -&gt; Type) (g :: k1 -&gt; k) (a :: k1).
f (g a) -&gt; Compose f g a
</span><span class="hs-identifier hs-var">Compose</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DocLine -&gt; Maybe Int) -&gt; t DocLine -&gt; t (Maybe Int)
forall a b. (a -&gt; b) -&gt; t a -&gt; t b
forall (f :: Type -&gt; Type) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">DocLine -&gt; Maybe Int
forall {r}. HasField &quot;textLine&quot; r [Char] =&gt; r -&gt; Maybe Int
</span><a href="#local-6989586621679160172"><span class="hs-identifier hs-var">getLevel</span></a></span><span> </span><span class="annot"><span class="annottext">t DocLine
</span><a href="#local-6989586621679160165"><span class="hs-identifier hs-var">theLines</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-194"></span><span>        </span><span class="hs-comment">-- only consider non-white lines for unindent</span><span>
</span><span id="line-195"></span><span>        </span><span id="local-6989586621679160172"><span class="annot"><span class="annottext">getLevel :: r -&gt; Maybe Int
</span><a href="#local-6989586621679160172"><span class="hs-identifier hs-var hs-var">getLevel</span></a></span></span><span> </span><span id="local-6989586621679160177"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679160177"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: Type -&gt; Type) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679160179"><span class="hs-identifier hs-var">rest</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Maybe Int
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Maybe Int
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: Type -&gt; Type) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679160181"><span class="hs-identifier hs-var">white</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span>          </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679160181"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679160181"><span class="hs-identifier hs-var">white</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679160179"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679160179"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; [Char] -&gt; ([Char], [Char])
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">span</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isSpace</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679160177"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">textLine</span><span>
</span><span id="line-197"></span><span>        </span><span id="local-6989586621679160166"><span class="annot"><span class="annottext">dropSpace :: DocLine -&gt; DocLine
</span><a href="#local-6989586621679160166"><span class="hs-identifier hs-var hs-var">dropSpace</span></a></span></span><span> </span><span id="local-6989586621679160182"><span class="annot"><span class="annottext">DocLine
</span><a href="#local-6989586621679160182"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Loc -&gt; [Char] -&gt; DocLine
</span><a href="Test.DocTest.Driver.Extract.Ast.html#DocLine"><span class="hs-identifier hs-var">DocLine</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Loc -&gt; Loc
</span><a href="Test.DocTest.Driver.Extract.Ast.html#advanceLocBy"><span class="hs-identifier hs-var">advanceLocBy</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679160167"><span class="hs-identifier hs-var">level</span></a></span><span> </span><span class="annot"><span class="annottext">DocLine
</span><a href="#local-6989586621679160182"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">location</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; ShowS
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679160167"><span class="hs-identifier hs-var">level</span></a></span><span> </span><span class="annot"><span class="annottext">DocLine
</span><a href="#local-6989586621679160182"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">textLine</span><span class="hs-special">)</span><span>
</span><span id="line-198"></span><span>
</span><span id="line-199"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#stripPrefix"><span class="hs-identifier hs-type">stripPrefix</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocLine"><span class="hs-identifier hs-type">DocLine</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocLine"><span class="hs-identifier hs-type">DocLine</span></a></span><span>
</span><span id="line-200"></span><span id="stripPrefix"><span class="annot"><span class="annottext">stripPrefix :: [Char] -&gt; DocLine -&gt; Maybe DocLine
</span><a href="Test.DocTest.Driver.Extract.Ast.html#stripPrefix"><span class="hs-identifier hs-var hs-var">stripPrefix</span></a></span></span><span> </span><span id="local-6989586621679160185"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679160185"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679160186"><span class="annot"><span class="annottext">DocLine
</span><a href="#local-6989586621679160186"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Loc -&gt; [Char] -&gt; DocLine
</span><a href="Test.DocTest.Driver.Extract.Ast.html#DocLine"><span class="hs-identifier hs-var">DocLine</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Loc -&gt; Loc
</span><a href="Test.DocTest.Driver.Extract.Ast.html#advanceLoc"><span class="hs-identifier hs-var">advanceLoc</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679160185"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">DocLine
</span><a href="#local-6989586621679160186"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">location</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; DocLine) -&gt; Maybe [Char] -&gt; Maybe DocLine
forall (f :: Type -&gt; Type) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; Maybe [Char]
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; Maybe [a]
</span><span class="hs-identifier hs-var">List.stripPrefix</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679160185"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">DocLine
</span><a href="#local-6989586621679160186"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">textLine</span><span>
</span><span id="line-201"></span><span>
</span><span id="line-202"></span><span class="annot"><span class="hs-comment">-- | 'span', but also handles the @location@ of 'DocLine's.</span></span><span>
</span><span id="line-203"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#spanDocLine"><span class="hs-identifier hs-type">spanDocLine</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocLine"><span class="hs-identifier hs-type">DocLine</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocLine"><span class="hs-identifier hs-type">DocLine</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-204"></span><span id="spanDocLine"><span class="annot"><span class="annottext">spanDocLine :: (Char -&gt; Bool) -&gt; DocLine -&gt; ([Char], DocLine)
</span><a href="Test.DocTest.Driver.Extract.Ast.html#spanDocLine"><span class="hs-identifier hs-var hs-var">spanDocLine</span></a></span></span><span> </span><span id="local-6989586621679160189"><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621679160189"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679160190"><span class="annot"><span class="annottext">DocLine
</span><a href="#local-6989586621679160190"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679160191"><span class="hs-identifier hs-var">left</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Loc -&gt; [Char] -&gt; DocLine
</span><a href="Test.DocTest.Driver.Extract.Ast.html#DocLine"><span class="hs-identifier hs-var">DocLine</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Loc -&gt; Loc
</span><a href="Test.DocTest.Driver.Extract.Ast.html#advanceLoc"><span class="hs-identifier hs-var">advanceLoc</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679160191"><span class="hs-identifier hs-var">left</span></a></span><span> </span><span class="annot"><span class="annottext">DocLine
</span><a href="#local-6989586621679160190"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">location</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679160192"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-205"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679160191"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679160191"><span class="hs-identifier hs-var">left</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679160192"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679160192"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; [Char] -&gt; ([Char], [Char])
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">span</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621679160189"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">DocLine
</span><a href="#local-6989586621679160190"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">textLine</span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span class="hs-comment">-- NOTE: we unindent the lines by only removing extra leading /spaces/.</span><span>
</span><span id="line-208"></span><span class="hs-comment">-- this means other whitespace characters like tabs are not considered at all.</span><span>
</span><span id="line-209"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#trimLeft"><span class="hs-identifier hs-type">trimLeft</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocLine"><span class="hs-identifier hs-type">DocLine</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocLine"><span class="hs-identifier hs-type">DocLine</span></a></span><span>
</span><span id="line-210"></span><span id="trimLeft"><span class="annot"><span class="annottext">trimLeft :: DocLine -&gt; DocLine
</span><a href="Test.DocTest.Driver.Extract.Ast.html#trimLeft"><span class="hs-identifier hs-var hs-var">trimLeft</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Char], DocLine) -&gt; DocLine
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">(([Char], DocLine) -&gt; DocLine)
-&gt; (DocLine -&gt; ([Char], DocLine)) -&gt; DocLine -&gt; DocLine
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; DocLine -&gt; ([Char], DocLine)
</span><a href="Test.DocTest.Driver.Extract.Ast.html#spanDocLine"><span class="hs-identifier hs-var">spanDocLine</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">' '</span></span><span class="hs-special">)</span><span>
</span><span id="line-211"></span><span>
</span><span id="line-212"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#trimPrefix"><span class="hs-identifier hs-type">trimPrefix</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocLine"><span class="hs-identifier hs-type">DocLine</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocLine"><span class="hs-identifier hs-type">DocLine</span></a></span><span>
</span><span id="line-213"></span><span id="trimPrefix"><span class="annot"><span class="annottext">trimPrefix :: [Char] -&gt; DocLine -&gt; DocLine
</span><a href="Test.DocTest.Driver.Extract.Ast.html#trimPrefix"><span class="hs-identifier hs-var hs-var">trimPrefix</span></a></span></span><span> </span><span id="local-6989586621679160196"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679160196"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DocLine -&gt; DocLine
</span><a href="Test.DocTest.Driver.Extract.Ast.html#trimLeft"><span class="hs-identifier hs-var">trimLeft</span></a></span><span> </span><span class="annot"><span class="annottext">(DocLine -&gt; DocLine) -&gt; (DocLine -&gt; DocLine) -&gt; DocLine -&gt; DocLine
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Maybe DocLine -&gt; DocLine
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="annot"><span class="annottext">(Maybe DocLine -&gt; DocLine)
-&gt; (DocLine -&gt; Maybe DocLine) -&gt; DocLine -&gt; DocLine
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; DocLine -&gt; Maybe DocLine
</span><a href="Test.DocTest.Driver.Extract.Ast.html#stripPrefix"><span class="hs-identifier hs-var">stripPrefix</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679160196"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">(DocLine -&gt; Maybe DocLine)
-&gt; (DocLine -&gt; DocLine) -&gt; DocLine -&gt; Maybe DocLine
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">DocLine -&gt; DocLine
</span><a href="Test.DocTest.Driver.Extract.Ast.html#trimLeft"><span class="hs-identifier hs-var">trimLeft</span></a></span><span>
</span><span id="line-214"></span><span>
</span><span id="line-215"></span><span class="annot"><span class="hs-comment">-- | A single line of example, accompanied by several output lines.</span></span><span>
</span><span id="line-216"></span><span class="hs-keyword">data</span><span> </span><span id="ExampleLine"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#ExampleLine"><span class="hs-identifier hs-var">ExampleLine</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ExampleLine"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#ExampleLine"><span class="hs-identifier hs-var">ExampleLine</span></a></span></span><span>
</span><span id="line-217"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="%24sel%3AprogramLine%3AExampleLine"><span class="annot"><span class="annottext">ExampleLine -&gt; DocLine
</span><a href="Test.DocTest.Driver.Extract.Ast.html#%24sel%3AprogramLine%3AExampleLine"><span class="hs-identifier hs-var hs-var">programLine</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocLine"><span class="hs-identifier hs-type">DocLine</span></a></span><span>   </span><span class="annot"><span class="hs-comment">-- ^ Example line (code).</span></span><span>
</span><span id="line-218"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AexpectedOutput%3AExampleLine"><span class="annot"><span class="annottext">ExampleLine -&gt; [DocLine]
</span><a href="Test.DocTest.Driver.Extract.Ast.html#%24sel%3AexpectedOutput%3AExampleLine"><span class="hs-identifier hs-var hs-var">expectedOutput</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocLine"><span class="hs-identifier hs-type">DocLine</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-comment">-- ^ Output text lines.</span></span><span>
</span><span id="line-219"></span><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679160201"><span id="local-6989586621679160206"><span id="local-6989586621679160209"><span class="annot"><span class="annottext">Int -&gt; ExampleLine -&gt; ShowS
[ExampleLine] -&gt; ShowS
ExampleLine -&gt; [Char]
(Int -&gt; ExampleLine -&gt; ShowS)
-&gt; (ExampleLine -&gt; [Char])
-&gt; ([ExampleLine] -&gt; ShowS)
-&gt; Show ExampleLine
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; ExampleLine -&gt; ShowS
showsPrec :: Int -&gt; ExampleLine -&gt; ShowS
$cshow :: ExampleLine -&gt; [Char]
show :: ExampleLine -&gt; [Char]
$cshowList :: [ExampleLine] -&gt; ShowS
showList :: [ExampleLine] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679160212"><span id="local-6989586621679160216"><span class="annot"><span class="annottext">ExampleLine -&gt; ExampleLine -&gt; Bool
(ExampleLine -&gt; ExampleLine -&gt; Bool)
-&gt; (ExampleLine -&gt; ExampleLine -&gt; Bool) -&gt; Eq ExampleLine
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: ExampleLine -&gt; ExampleLine -&gt; Bool
== :: ExampleLine -&gt; ExampleLine -&gt; Bool
$c/= :: ExampleLine -&gt; ExampleLine -&gt; Bool
/= :: ExampleLine -&gt; ExampleLine -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-220"></span><span>
</span><span id="line-221"></span><span class="annot"><span class="hs-comment">-- | Captured text content, made available as a variable.</span></span><span>
</span><span id="line-222"></span><span class="hs-keyword">data</span><span> </span><span id="CapturedContent"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#CapturedContent"><span class="hs-identifier hs-var">CapturedContent</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Captured"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Captured"><span class="hs-identifier hs-var">Captured</span></a></span></span><span>
</span><span id="line-223"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="%24sel%3AvariableName%3ACaptured"><span class="annot"><span class="annottext">CapturedContent -&gt; [Char]
</span><a href="Test.DocTest.Driver.Extract.Ast.html#%24sel%3AvariableName%3ACaptured"><span class="hs-identifier hs-var hs-var">variableName</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>           </span><span class="annot"><span class="hs-comment">-- ^ Name of the variable to bring into scope.</span></span><span>
</span><span id="line-224"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AcaptureMethod%3ACaptured"><span class="annot"><span class="annottext">CapturedContent -&gt; CaptureMethod
</span><a href="Test.DocTest.Driver.Extract.Ast.html#%24sel%3AcaptureMethod%3ACaptured"><span class="hs-identifier hs-var hs-var">captureMethod</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#CaptureMethod"><span class="hs-identifier hs-type">CaptureMethod</span></a></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ How the text content is captured.</span></span><span>
</span><span id="line-225"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AtextContent%3ACaptured"><span class="annot"><span class="annottext">CapturedContent -&gt; NonEmpty [Char]
</span><a href="Test.DocTest.Driver.Extract.Ast.html#%24sel%3AtextContent%3ACaptured"><span class="hs-identifier hs-var hs-var">textContent</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ Text content to be captured.</span></span><span>
</span><span id="line-226"></span><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679160223"><span id="local-6989586621679160231"><span id="local-6989586621679160234"><span class="annot"><span class="annottext">Int -&gt; CapturedContent -&gt; ShowS
[CapturedContent] -&gt; ShowS
CapturedContent -&gt; [Char]
(Int -&gt; CapturedContent -&gt; ShowS)
-&gt; (CapturedContent -&gt; [Char])
-&gt; ([CapturedContent] -&gt; ShowS)
-&gt; Show CapturedContent
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; CapturedContent -&gt; ShowS
showsPrec :: Int -&gt; CapturedContent -&gt; ShowS
$cshow :: CapturedContent -&gt; [Char]
show :: CapturedContent -&gt; [Char]
$cshowList :: [CapturedContent] -&gt; ShowS
showList :: [CapturedContent] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679160237"><span id="local-6989586621679160243"><span class="annot"><span class="annottext">CapturedContent -&gt; CapturedContent -&gt; Bool
(CapturedContent -&gt; CapturedContent -&gt; Bool)
-&gt; (CapturedContent -&gt; CapturedContent -&gt; Bool)
-&gt; Eq CapturedContent
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: CapturedContent -&gt; CapturedContent -&gt; Bool
== :: CapturedContent -&gt; CapturedContent -&gt; Bool
$c/= :: CapturedContent -&gt; CapturedContent -&gt; Bool
/= :: CapturedContent -&gt; CapturedContent -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-227"></span><span>
</span><span id="line-228"></span><span class="annot"><span class="hs-comment">-- | Different ways of capturing text contents.</span></span><span>
</span><span id="line-229"></span><span class="hs-keyword">data</span><span> </span><span id="CaptureMethod"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#CaptureMethod"><span class="hs-identifier hs-var">CaptureMethod</span></a></span></span><span>
</span><span id="line-230"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="String"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#String"><span class="hs-identifier hs-var">String</span></a></span></span><span>            </span><span class="annot"><span class="hs-comment">-- ^ t'String' variable.</span></span><span>
</span><span id="line-231"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="TextStrict"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#TextStrict"><span class="hs-identifier hs-var">TextStrict</span></a></span></span><span>        </span><span class="annot"><span class="hs-comment">-- ^ Strict @Text@ variable (from @Data.Text@).</span></span><span>
</span><span id="line-232"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="TextLazy"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#TextLazy"><span class="hs-identifier hs-var">TextLazy</span></a></span></span><span>          </span><span class="annot"><span class="hs-comment">-- ^ Lazy @Text@ variable (from @Data.Text.Lazy@).</span></span><span>
</span><span id="line-233"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ByteStringStrict"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#ByteStringStrict"><span class="hs-identifier hs-var">ByteStringStrict</span></a></span></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ Strict @ByteString@ variable (from @Data.ByteString@).</span></span><span>
</span><span id="line-234"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ByteStringLazy"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#ByteStringLazy"><span class="hs-identifier hs-var">ByteStringLazy</span></a></span></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ Lazy @ByteString@ variable (from @Data.ByteString.Lazy@).</span></span><span>
</span><span id="line-235"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ShortByteString"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#ShortByteString"><span class="hs-identifier hs-var">ShortByteString</span></a></span></span><span>   </span><span class="annot"><span class="hs-comment">-- ^ @ShortByteString@ variable (from @Data.ByteString.Short@).</span></span><span>
</span><span id="line-236"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="TempFile"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#TempFile"><span class="hs-identifier hs-var">TempFile</span></a></span></span><span>          </span><span class="annot"><span class="hs-comment">-- ^ Save as a temporary file, provide as a 'FilePath' variable.</span></span><span>
</span><span id="line-237"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span id="local-6989586621679160254"><span id="local-6989586621679160256"><span class="annot"><span class="annottext">CaptureMethod -&gt; CaptureMethod -&gt; Bool
(CaptureMethod -&gt; CaptureMethod -&gt; Bool)
-&gt; (CaptureMethod -&gt; CaptureMethod -&gt; Bool) -&gt; Eq CaptureMethod
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: CaptureMethod -&gt; CaptureMethod -&gt; Bool
== :: CaptureMethod -&gt; CaptureMethod -&gt; Bool
$c/= :: CaptureMethod -&gt; CaptureMethod -&gt; Bool
/= :: CaptureMethod -&gt; CaptureMethod -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span>
</span><span id="line-238"></span><span>
</span><span id="line-239"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679160259"><span id="local-6989586621679160263"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#CaptureMethod"><span class="hs-identifier hs-type">CaptureMethod</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-240"></span><span>  </span><span id="local-6989586621679160265"><span class="annot"><span class="annottext">show :: CaptureMethod -&gt; [Char]
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></span></span><span> </span><span class="annot"><span class="annottext">CaptureMethod
</span><a href="Test.DocTest.Driver.Extract.Ast.html#String"><span class="hs-identifier hs-var">String</span></a></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;String&quot;</span></span><span>
</span><span id="line-241"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">CaptureMethod
</span><a href="Test.DocTest.Driver.Extract.Ast.html#TextStrict"><span class="hs-identifier hs-var">TextStrict</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Strict.Text&quot;</span></span><span>
</span><span id="line-242"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">CaptureMethod
</span><a href="Test.DocTest.Driver.Extract.Ast.html#TextLazy"><span class="hs-identifier hs-var">TextLazy</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Lazy.Text&quot;</span></span><span>
</span><span id="line-243"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">CaptureMethod
</span><a href="Test.DocTest.Driver.Extract.Ast.html#ByteStringStrict"><span class="hs-identifier hs-var">ByteStringStrict</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Strict.ByteString&quot;</span></span><span>
</span><span id="line-244"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">CaptureMethod
</span><a href="Test.DocTest.Driver.Extract.Ast.html#ByteStringLazy"><span class="hs-identifier hs-var">ByteStringLazy</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Lazy.ByteString&quot;</span></span><span>
</span><span id="line-245"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">CaptureMethod
</span><a href="Test.DocTest.Driver.Extract.Ast.html#ShortByteString"><span class="hs-identifier hs-var">ShortByteString</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;ShortByteString&quot;</span></span><span>
</span><span id="line-246"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">CaptureMethod
</span><a href="Test.DocTest.Driver.Extract.Ast.html#TempFile"><span class="hs-identifier hs-var">TempFile</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;FilePath&quot;</span></span><span>
</span><span id="line-247"></span><span>
</span><span id="line-248"></span><span class="annot"><span class="hs-comment">-- | 'IO' actions to be performed throughout the test lifetime.</span></span><span>
</span><span id="line-249"></span><span class="hs-keyword">data</span><span> </span><span id="IOHook"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#IOHook"><span class="hs-identifier hs-var">IOHook</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="IOHook"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#IOHook"><span class="hs-identifier hs-var">IOHook</span></a></span></span><span>
</span><span id="line-250"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="%24sel%3Aflavour%3AIOHook"><span class="annot"><span class="annottext">IOHook -&gt; HookFlavour
</span><a href="Test.DocTest.Driver.Extract.Ast.html#%24sel%3Aflavour%3AIOHook"><span class="hs-identifier hs-var hs-var">flavour</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#HookFlavour"><span class="hs-identifier hs-type">HookFlavour</span></a></span><span>      </span><span class="annot"><span class="hs-comment">-- ^ Occasions when the 'IO' action is expected to run.</span></span><span>
</span><span id="line-251"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="%24sel%3Avariables%3AIOHook"><span class="annot"><span class="annottext">IOHook -&gt; [[Char]]
</span><a href="Test.DocTest.Driver.Extract.Ast.html#%24sel%3Avariables%3AIOHook"><span class="hs-identifier hs-var hs-var">variables</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span>         </span><span class="annot"><span class="hs-comment">-- ^ List of variable names brought into scope by this hook.</span></span><span>
</span><span id="line-252"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AsetupCode%3AIOHook"><span class="annot"><span class="annottext">IOHook -&gt; NonEmpty DocLine
</span><a href="Test.DocTest.Driver.Extract.Ast.html#%24sel%3AsetupCode%3AIOHook"><span class="hs-identifier hs-var hs-var">setupCode</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocLine"><span class="hs-identifier hs-type">DocLine</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ The code for the action.</span></span><span>
</span><span id="line-253"></span><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679160271"><span id="local-6989586621679160280"><span id="local-6989586621679160283"><span class="annot"><span class="annottext">Int -&gt; IOHook -&gt; ShowS
[IOHook] -&gt; ShowS
IOHook -&gt; [Char]
(Int -&gt; IOHook -&gt; ShowS)
-&gt; (IOHook -&gt; [Char]) -&gt; ([IOHook] -&gt; ShowS) -&gt; Show IOHook
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; IOHook -&gt; ShowS
showsPrec :: Int -&gt; IOHook -&gt; ShowS
$cshow :: IOHook -&gt; [Char]
show :: IOHook -&gt; [Char]
$cshowList :: [IOHook] -&gt; ShowS
showList :: [IOHook] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679160287"><span id="local-6989586621679160295"><span class="annot"><span class="annottext">IOHook -&gt; IOHook -&gt; Bool
(IOHook -&gt; IOHook -&gt; Bool)
-&gt; (IOHook -&gt; IOHook -&gt; Bool) -&gt; Eq IOHook
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: IOHook -&gt; IOHook -&gt; Bool
== :: IOHook -&gt; IOHook -&gt; Bool
$c/= :: IOHook -&gt; IOHook -&gt; Bool
/= :: IOHook -&gt; IOHook -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-254"></span><span>
</span><span id="line-255"></span><span class="hs-comment">-- | Occasions to run an 'IOHook'.</span><span>
</span><span id="line-256"></span><span class="hs-comment">-- 'Around' and 'AroundAll' must capture the continuation as the first parameter.</span><span>
</span><span id="line-257"></span><span class="hs-keyword">data</span><span> </span><span id="HookFlavour"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#HookFlavour"><span class="hs-identifier hs-var">HookFlavour</span></a></span></span><span>
</span><span id="line-258"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="Before"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Before"><span class="hs-identifier hs-var">Before</span></a></span></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ Once before each test case (result is freshly generated).</span></span><span>
</span><span id="line-259"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="BeforeAll"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#BeforeAll"><span class="hs-identifier hs-var">BeforeAll</span></a></span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Once before all test cases (result is shared).</span></span><span>
</span><span id="line-260"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="After"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#After"><span class="hs-identifier hs-var">After</span></a></span></span><span>     </span><span class="annot"><span class="hs-comment">-- ^ Once after each test case.</span></span><span>
</span><span id="line-261"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="AfterAll"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#AfterAll"><span class="hs-identifier hs-var">AfterAll</span></a></span></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ Once after all test cases.</span></span><span>
</span><span id="line-262"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Around"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Around"><span class="hs-identifier hs-var">Around</span></a></span></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ Once around each test case (wrapper runs multiple times).</span></span><span>
</span><span id="line-263"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="AroundAll"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#AroundAll"><span class="hs-identifier hs-var">AroundAll</span></a></span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Once around all test cases (wrapper runs exactly once).</span></span><span>
</span><span id="line-264"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span id="local-6989586621679160304"><span id="local-6989586621679160306"><span class="annot"><span class="annottext">HookFlavour -&gt; HookFlavour -&gt; Bool
(HookFlavour -&gt; HookFlavour -&gt; Bool)
-&gt; (HookFlavour -&gt; HookFlavour -&gt; Bool) -&gt; Eq HookFlavour
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: HookFlavour -&gt; HookFlavour -&gt; Bool
== :: HookFlavour -&gt; HookFlavour -&gt; Bool
$c/= :: HookFlavour -&gt; HookFlavour -&gt; Bool
/= :: HookFlavour -&gt; HookFlavour -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span>
</span><span id="line-265"></span><span>
</span><span id="line-266"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679160309"><span id="local-6989586621679160313"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#HookFlavour"><span class="hs-identifier hs-type">HookFlavour</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-267"></span><span>  </span><span id="local-6989586621679160315"><span class="annot"><span class="annottext">show :: HookFlavour -&gt; [Char]
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></span></span><span> </span><span class="annot"><span class="annottext">HookFlavour
</span><a href="Test.DocTest.Driver.Extract.Ast.html#Before"><span class="hs-identifier hs-var">Before</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;before&quot;</span></span><span>
</span><span id="line-268"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">HookFlavour
</span><a href="Test.DocTest.Driver.Extract.Ast.html#BeforeAll"><span class="hs-identifier hs-var">BeforeAll</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;beforeAll&quot;</span></span><span>
</span><span id="line-269"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">HookFlavour
</span><a href="Test.DocTest.Driver.Extract.Ast.html#After"><span class="hs-identifier hs-var">After</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;after&quot;</span></span><span>
</span><span id="line-270"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">HookFlavour
</span><a href="Test.DocTest.Driver.Extract.Ast.html#AfterAll"><span class="hs-identifier hs-var">AfterAll</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;afterAll&quot;</span></span><span>
</span><span id="line-271"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">HookFlavour
</span><a href="Test.DocTest.Driver.Extract.Ast.html#Around"><span class="hs-identifier hs-var">Around</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;around&quot;</span></span><span>
</span><span id="line-272"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">HookFlavour
</span><a href="Test.DocTest.Driver.Extract.Ast.html#AroundAll"><span class="hs-identifier hs-var">AroundAll</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;aroundAll&quot;</span></span><span>
</span><span id="line-273"></span><span>
</span><span id="line-274"></span><span class="hs-keyword">data</span><span> </span><span id="SetupCode"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#SetupCode"><span class="hs-identifier hs-var">SetupCode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="SetupCode"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#SetupCode"><span class="hs-identifier hs-var">SetupCode</span></a></span></span><span>
</span><span id="line-275"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="%24sel%3AsetupImport%3ASetupCode"><span class="annot"><span class="annottext">SetupCode -&gt; [([Char], NonEmpty DocLine)]
</span><a href="Test.DocTest.Driver.Extract.Ast.html#%24sel%3AsetupImport%3ASetupCode"><span class="hs-identifier hs-var hs-var">setupImport</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocLine"><span class="hs-identifier hs-type">DocLine</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-276"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AsetupTop%3ASetupCode"><span class="annot"><span class="annottext">SetupCode -&gt; [([Char], NonEmpty DocLine)]
</span><a href="Test.DocTest.Driver.Extract.Ast.html#%24sel%3AsetupTop%3ASetupCode"><span class="hs-identifier hs-var hs-var">setupTop</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocLine"><span class="hs-identifier hs-type">DocLine</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-277"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-278"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679160320"><span id="local-6989586621679160326"><span id="local-6989586621679160330"><span class="annot"><span class="annottext">Int -&gt; SetupCode -&gt; ShowS
[SetupCode] -&gt; ShowS
SetupCode -&gt; [Char]
(Int -&gt; SetupCode -&gt; ShowS)
-&gt; (SetupCode -&gt; [Char])
-&gt; ([SetupCode] -&gt; ShowS)
-&gt; Show SetupCode
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; SetupCode -&gt; ShowS
showsPrec :: Int -&gt; SetupCode -&gt; ShowS
$cshow :: SetupCode -&gt; [Char]
show :: SetupCode -&gt; [Char]
$cshowList :: [SetupCode] -&gt; ShowS
showList :: [SetupCode] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679160338"><span id="local-6989586621679160343"><span class="annot"><span class="annottext">SetupCode -&gt; SetupCode -&gt; Bool
(SetupCode -&gt; SetupCode -&gt; Bool)
-&gt; (SetupCode -&gt; SetupCode -&gt; Bool) -&gt; Eq SetupCode
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: SetupCode -&gt; SetupCode -&gt; Bool
== :: SetupCode -&gt; SetupCode -&gt; Bool
$c/= :: SetupCode -&gt; SetupCode -&gt; Bool
/= :: SetupCode -&gt; SetupCode -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679160351"><span id="local-6989586621679160353"><span class="annot"><span class="annottext">(forall x. SetupCode -&gt; Rep SetupCode x)
-&gt; (forall x. Rep SetupCode x -&gt; SetupCode) -&gt; Generic SetupCode
forall x. Rep SetupCode x -&gt; SetupCode
forall x. SetupCode -&gt; Rep SetupCode x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x. SetupCode -&gt; Rep SetupCode x
from :: forall x. SetupCode -&gt; Rep SetupCode x
$cto :: forall x. Rep SetupCode x -&gt; SetupCode
to :: forall x. Rep SetupCode x -&gt; SetupCode
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-279"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679160357"><span id="local-6989586621679160364"><span id="local-6989586621679160372"><span class="annot"><span class="annottext">NonEmpty SetupCode -&gt; SetupCode
SetupCode -&gt; SetupCode -&gt; SetupCode
(SetupCode -&gt; SetupCode -&gt; SetupCode)
-&gt; (NonEmpty SetupCode -&gt; SetupCode)
-&gt; (forall b. Integral b =&gt; b -&gt; SetupCode -&gt; SetupCode)
-&gt; Semigroup SetupCode
forall b. Integral b =&gt; b -&gt; SetupCode -&gt; SetupCode
forall a.
(a -&gt; a -&gt; a)
-&gt; (NonEmpty a -&gt; a)
-&gt; (forall b. Integral b =&gt; b -&gt; a -&gt; a)
-&gt; Semigroup a
$c&lt;&gt; :: SetupCode -&gt; SetupCode -&gt; SetupCode
&lt;&gt; :: SetupCode -&gt; SetupCode -&gt; SetupCode
$csconcat :: NonEmpty SetupCode -&gt; SetupCode
sconcat :: NonEmpty SetupCode -&gt; SetupCode
$cstimes :: forall b. Integral b =&gt; b -&gt; SetupCode -&gt; SetupCode
stimes :: forall b. Integral b =&gt; b -&gt; SetupCode -&gt; SetupCode
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Semigroup</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679160408"><span id="local-6989586621679160415"><span id="local-6989586621679160421"><span class="annot"><span class="annottext">Semigroup SetupCode
SetupCode
Semigroup SetupCode =&gt;
SetupCode
-&gt; (SetupCode -&gt; SetupCode -&gt; SetupCode)
-&gt; ([SetupCode] -&gt; SetupCode)
-&gt; Monoid SetupCode
[SetupCode] -&gt; SetupCode
SetupCode -&gt; SetupCode -&gt; SetupCode
forall a.
Semigroup a =&gt;
a -&gt; (a -&gt; a -&gt; a) -&gt; ([a] -&gt; a) -&gt; Monoid a
$cmempty :: SetupCode
mempty :: SetupCode
$cmappend :: SetupCode -&gt; SetupCode -&gt; SetupCode
mappend :: SetupCode -&gt; SetupCode -&gt; SetupCode
$cmconcat :: [SetupCode] -&gt; SetupCode
mconcat :: [SetupCode] -&gt; SetupCode
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Monoid</span></span></span></span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">via</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Generically</span></span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#SetupCode"><span class="hs-identifier hs-type">SetupCode</span></a></span><span>
</span><span id="line-280"></span><span>
</span><span id="line-281"></span><span class="annot"><span class="hs-comment">-- | Extracted module.</span></span><span>
</span><span id="line-282"></span><span class="hs-keyword">data</span><span> </span><span id="Module"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Module"><span class="hs-identifier hs-var">Module</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Module"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Module"><span class="hs-identifier hs-var">Module</span></a></span></span><span>
</span><span id="line-283"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="%24sel%3AfilePath%3AModule"><span class="annot"><span class="annottext">Module -&gt; [Char]
</span><a href="Test.DocTest.Driver.Extract.Ast.html#%24sel%3AfilePath%3AModule"><span class="hs-identifier hs-var hs-var">filePath</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ Source file path to the original module.</span></span><span>
</span><span id="line-284"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AmodulePath%3AModule"><span class="annot"><span class="annottext">Module -&gt; [[Char]]
</span><a href="Test.DocTest.Driver.Extract.Ast.html#%24sel%3AmodulePath%3AModule"><span class="hs-identifier hs-var hs-var">modulePath</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span>    </span><span class="annot"><span class="hs-comment">-- ^ Module name path, separated by dots (@.@).</span></span><span>
</span><span id="line-285"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AimportList%3AModule"><span class="annot"><span class="annottext">Module -&gt; [DocLine]
</span><a href="Test.DocTest.Driver.Extract.Ast.html#%24sel%3AimportList%3AModule"><span class="hs-identifier hs-var hs-var">importList</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocLine"><span class="hs-identifier hs-type">DocLine</span></a></span><span class="hs-special">]</span><span>   </span><span class="annot"><span class="hs-comment">-- ^ List of import statements to be put at the top.</span></span><span>
</span><span id="line-286"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AtopSetup%3AModule"><span class="annot"><span class="annottext">Module -&gt; [DocLine]
</span><a href="Test.DocTest.Driver.Extract.Ast.html#%24sel%3AtopSetup%3AModule"><span class="hs-identifier hs-var hs-var">topSetup</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocLine"><span class="hs-identifier hs-type">DocLine</span></a></span><span class="hs-special">]</span><span>   </span><span class="annot"><span class="hs-comment">-- ^ Top-level setup code, e.g., data type definitions.</span></span><span>
</span><span id="line-287"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AtestCases%3AModule"><span class="annot"><span class="annottext">Module -&gt; [DocTests]
</span><a href="Test.DocTest.Driver.Extract.Ast.html#%24sel%3AtestCases%3AModule"><span class="hs-identifier hs-var hs-var">testCases</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocTests"><span class="hs-identifier hs-type">DocTests</span></a></span><span class="hs-special">]</span><span>  </span><span class="annot"><span class="hs-comment">-- ^ Extracted test cases.</span></span><span>
</span><span id="line-288"></span><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span id="local-6989586621679160458"><span id="local-6989586621679160469"><span id="local-6989586621679160473"><span class="annot"><span class="annottext">Int -&gt; Module -&gt; ShowS
[Module] -&gt; ShowS
Module -&gt; [Char]
(Int -&gt; Module -&gt; ShowS)
-&gt; (Module -&gt; [Char]) -&gt; ([Module] -&gt; ShowS) -&gt; Show Module
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; Module -&gt; ShowS
showsPrec :: Int -&gt; Module -&gt; ShowS
$cshow :: Module -&gt; [Char]
show :: Module -&gt; [Char]
$cshowList :: [Module] -&gt; ShowS
showList :: [Module] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span>
</span><span id="line-289"></span><span>
</span><span id="line-290"></span><span class="hs-comment">-- | Extract a 'Module' from a GHC 'ParsedModule'.</span><span>
</span><span id="line-291"></span><span class="hs-comment">--</span><span>
</span><span id="line-292"></span><span class="hs-comment">-- === Implementation Note</span><span>
</span><span id="line-293"></span><span class="hs-comment">--</span><span>
</span><span id="line-294"></span><span class="hs-comment">-- The documentation in a 'ParsedModule' is first extracted into a doc-tree (via 'GHC.collectDocs').</span><span>
</span><span id="line-295"></span><span class="hs-comment">-- By design, doctest instructions can appear as group names (Haddock markup @\$group-name@) and as</span><span>
</span><span id="line-296"></span><span class="hs-comment">-- comments in verbatim code block (Haddock markup @\@...\@@). Inside this doc-tree, we inspect</span><span>
</span><span id="line-297"></span><span class="hs-comment">-- these places, recognise the instructions, and apply the instructions. Some instructions modify</span><span>
</span><span id="line-298"></span><span class="hs-comment">-- their parent scope ('Capture's and 'IOHook's bring new names in scope), so we float them above.</span><span>
</span><span id="line-299"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#extractModule"><span class="hs-identifier hs-type">extractModule</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ParsedModule</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Module"><span class="hs-identifier hs-type">Module</span></a></span><span>
</span><span id="line-300"></span><span id="extractModule"><span class="annot"><span class="annottext">extractModule :: ParsedModule -&gt; Module
</span><a href="Test.DocTest.Driver.Extract.Ast.html#extractModule"><span class="hs-identifier hs-var hs-var">extractModule</span></a></span></span><span> </span><span id="local-6989586621679160476"><span class="annot"><span class="annottext">ParsedModule
</span><a href="#local-6989586621679160476"><span class="hs-identifier hs-var">m</span></a></span></span><span>
</span><span id="line-301"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpan (HsModule GhcPs) -&gt; HsModule GhcPs
forall l e. GenLocated l e -&gt; e
</span><span class="hs-identifier hs-var">unLoc</span></span><span> </span><span class="annot"><span class="annottext">ParsedModule
</span><a href="#local-6989586621679160476"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">pm_parsed_source</span><span>
</span><span id="line-302"></span><span>  </span><span class="annot"><span class="annottext">HsModule GhcPs
-&gt; (HsModule GhcPs -&gt; [DocTree (Either ([Char], LDoc) Doc)])
-&gt; [DocTree (Either ([Char], LDoc) Doc)]
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">HsModule GhcPs -&gt; [DocTree (Either ([Char], LDoc) Doc)]
</span><a href="Test.DocTest.Driver.Extract.Ast.html#moduleDocs"><span class="hs-identifier hs-var">moduleDocs</span></a></span><span>
</span><span id="line-303"></span><span>  </span><span class="hs-comment">-- abstract doc-tree</span><span>
</span><span id="line-304"></span><span>  </span><span class="annot"><span class="annottext">[DocTree (Either ([Char], LDoc) Doc)]
-&gt; ([DocTree (Either ([Char], LDoc) Doc)]
    -&gt; [DocTree (Either (Instruction, Doc) Doc)])
-&gt; [DocTree (Either (Instruction, Doc) Doc)]
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(DocTree (Either ([Char], LDoc) Doc)
 -&gt; DocTree (Either (Instruction, Doc) Doc))
-&gt; [DocTree (Either ([Char], LDoc) Doc)]
-&gt; [DocTree (Either (Instruction, Doc) Doc)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">DocTree (Either ([Char], LDoc) Doc)
-&gt; DocTree (Either (Instruction, Doc) Doc)
</span><a href="Test.DocTest.Driver.Extract.Ast.html#parseInstructions"><span class="hs-identifier hs-var">parseInstructions</span></a></span><span>
</span><span id="line-305"></span><span>  </span><span class="annot"><span class="annottext">[DocTree (Either (Instruction, Doc) Doc)]
-&gt; ([DocTree (Either (Instruction, Doc) Doc)]
    -&gt; [DocTree (Either (Instruction, [DocLine]) DocTests)])
-&gt; [DocTree (Either (Instruction, [DocLine]) DocTests)]
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Either (Instruction, Doc) Doc
 -&gt; [Either (Instruction, [DocLine]) DocTests])
-&gt; [DocTree (Either (Instruction, Doc) Doc)]
-&gt; [DocTree (Either (Instruction, [DocLine]) DocTests)]
forall a b. (a -&gt; [b]) -&gt; [DocTree a] -&gt; [DocTree b]
</span><a href="Test.DocTest.Driver.Extract.Ast.html#mapTreeList"><span class="hs-identifier hs-var">mapTreeList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Instruction, Doc) -&gt; [Either (Instruction, [DocLine]) DocTests])
-&gt; (Doc -&gt; [Either (Instruction, [DocLine]) DocTests])
-&gt; Either (Instruction, Doc) Doc
-&gt; [Either (Instruction, [DocLine]) DocTests]
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Instruction -&gt; Doc -&gt; [Either (Instruction, [DocLine]) DocTests])
-&gt; (Instruction, Doc) -&gt; [Either (Instruction, [DocLine]) DocTests]
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="annot"><span class="annottext">Instruction -&gt; Doc -&gt; [Either (Instruction, [DocLine]) DocTests]
</span><a href="Test.DocTest.Driver.Extract.Ast.html#docWithInstruction"><span class="hs-identifier hs-var">docWithInstruction</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; [Either (Instruction, [DocLine]) DocTests]
</span><a href="Test.DocTest.Driver.Extract.Ast.html#docNoInstruction"><span class="hs-identifier hs-var">docNoInstruction</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-306"></span><span>  </span><span class="hs-comment">-- instructions extracted &amp; properly attached</span><span>
</span><span id="line-307"></span><span>  </span><span class="annot"><span class="annottext">[DocTree (Either (Instruction, [DocLine]) DocTests)]
-&gt; ([DocTree (Either (Instruction, [DocLine]) DocTests)]
    -&gt; (SetupCode, [DocTree DocTests]))
-&gt; (SetupCode, [DocTree DocTests])
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Either (Instruction, [DocLine]) DocTests
 -&gt; Either SetupCode DocTests)
-&gt; [DocTree (Either (Instruction, [DocLine]) DocTests)]
-&gt; (SetupCode, [DocTree DocTests])
forall b a c.
Monoid b =&gt;
(a -&gt; Either b c) -&gt; [DocTree a] -&gt; (b, [DocTree c])
</span><a href="Test.DocTest.Driver.Extract.Ast.html#partitionTreeList"><span class="hs-identifier hs-var">partitionTreeList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Instruction, [DocLine]) -&gt; Either SetupCode DocTests)
-&gt; (DocTests -&gt; Either SetupCode DocTests)
-&gt; Either (Instruction, [DocLine]) DocTests
-&gt; Either SetupCode DocTests
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Instruction -&gt; [DocLine] -&gt; Either SetupCode DocTests)
-&gt; (Instruction, [DocLine]) -&gt; Either SetupCode DocTests
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="annot"><span class="annottext">Instruction -&gt; [DocLine] -&gt; Either SetupCode DocTests
</span><a href="Test.DocTest.Driver.Extract.Ast.html#handleInstruction"><span class="hs-identifier hs-var">handleInstruction</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DocTests -&gt; Either SetupCode DocTests
forall a. a -&gt; Either SetupCode a
forall (f :: Type -&gt; Type) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span class="hs-special">)</span><span>
</span><span id="line-308"></span><span>  </span><span class="hs-comment">-- instructions applied</span><span>
</span><span id="line-309"></span><span>  </span><span class="annot"><span class="annottext">(SetupCode, [DocTree DocTests])
-&gt; ((SetupCode, [DocTree DocTests]) -&gt; (SetupCode, [DocTests]))
-&gt; (SetupCode, [DocTests])
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">([DocTree DocTests] -&gt; [DocTests])
-&gt; (SetupCode, [DocTree DocTests]) -&gt; (SetupCode, [DocTests])
forall b c a. (b -&gt; c) -&gt; (a, b) -&gt; (a, c)
forall (p :: Type -&gt; Type -&gt; Type) b c a.
Bifunctor p =&gt;
(b -&gt; c) -&gt; p a b -&gt; p a c
</span><span class="hs-identifier hs-var">second</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[DocTests] -&gt; [DocTests]
</span><a href="Test.DocTest.Driver.Extract.Ast.html#resolveScopes"><span class="hs-identifier hs-var">resolveScopes</span></a></span><span> </span><span class="annot"><span class="annottext">([DocTests] -&gt; [DocTests])
-&gt; ([DocTree DocTests] -&gt; [DocTests])
-&gt; [DocTree DocTests]
-&gt; [DocTests]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(DocTree DocTests -&gt; DocTests) -&gt; [DocTree DocTests] -&gt; [DocTests]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">DocTree DocTests -&gt; DocTests
</span><a href="Test.DocTest.Driver.Extract.Ast.html#finaliseDocTree"><span class="hs-identifier hs-var">finaliseDocTree</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-310"></span><span>  </span><span class="hs-comment">-- doc-tree =&gt; doctest</span><span>
</span><span id="line-311"></span><span>  </span><span class="hs-comment">-- capture and hook floated above its parent scope</span><span>
</span><span id="line-312"></span><span>  </span><span class="annot"><span class="annottext">(SetupCode, [DocTests])
-&gt; ((SetupCode, [DocTests]) -&gt; Module) -&gt; Module
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(SetupCode -&gt; [DocTests] -&gt; Module)
-&gt; (SetupCode, [DocTests]) -&gt; Module
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParsedModule -&gt; SetupCode -&gt; [DocTests] -&gt; Module
</span><a href="Test.DocTest.Driver.Extract.Ast.html#collectModule"><span class="hs-identifier hs-var">collectModule</span></a></span><span> </span><span class="annot"><span class="annottext">ParsedModule
</span><a href="#local-6989586621679160476"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-313"></span><span>  </span><span class="hs-comment">-- module information collected</span><span>
</span><span id="line-314"></span><span>
</span><span id="line-315"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#moduleDocs"><span class="hs-identifier hs-type">moduleDocs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GHC.HsModule</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">GhcPs</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocTree"><span class="hs-identifier hs-type">DocTree</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#LDoc"><span class="hs-identifier hs-type">LDoc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-316"></span><span id="moduleDocs"><span class="annot"><span class="annottext">moduleDocs :: HsModule GhcPs -&gt; [DocTree (Either ([Char], LDoc) Doc)]
</span><a href="Test.DocTest.Driver.Extract.Ast.html#moduleDocs"><span class="hs-identifier hs-var hs-var">moduleDocs</span></a></span></span><span> </span><span id="local-6989586621679160488"><span class="annot"><span class="annottext">HsModule GhcPs
</span><a href="#local-6989586621679160488"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsModule GhcPs -&gt; [DocTree (Either ([Char], LDoc) Doc)]
</span><a href="Test.DocTest.Driver.Extract.Ast.html#moduleHeaderDocs"><span class="hs-identifier hs-var">moduleHeaderDocs</span></a></span><span> </span><span class="annot"><span class="annottext">HsModule GhcPs
</span><a href="#local-6989586621679160488"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">[DocTree (Either ([Char], LDoc) Doc)]
-&gt; [DocTree (Either ([Char], LDoc) Doc)]
-&gt; [DocTree (Either ([Char], LDoc) Doc)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">HsModule GhcPs -&gt; [DocTree (Either ([Char], LDoc) Doc)]
</span><a href="Test.DocTest.Driver.Extract.Ast.html#moduleExportDocs"><span class="hs-identifier hs-var">moduleExportDocs</span></a></span><span> </span><span class="annot"><span class="annottext">HsModule GhcPs
</span><a href="#local-6989586621679160488"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">[DocTree (Either ([Char], LDoc) Doc)]
-&gt; [DocTree (Either ([Char], LDoc) Doc)]
-&gt; [DocTree (Either ([Char], LDoc) Doc)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">HsModule GhcPs -&gt; [DocTree (Either ([Char], LDoc) Doc)]
</span><a href="Test.DocTest.Driver.Extract.Ast.html#moduleDeclDocs"><span class="hs-identifier hs-var">moduleDeclDocs</span></a></span><span> </span><span class="annot"><span class="annottext">HsModule GhcPs
</span><a href="#local-6989586621679160488"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-317"></span><span>
</span><span id="line-318"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#moduleHeaderDocs"><span class="hs-identifier hs-type">moduleHeaderDocs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GHC.HsModule</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">GhcPs</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocTree"><span class="hs-identifier hs-type">DocTree</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#LDoc"><span class="hs-identifier hs-type">LDoc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-319"></span><span id="moduleHeaderDocs"><span class="annot"><span class="annottext">moduleHeaderDocs :: HsModule GhcPs -&gt; [DocTree (Either ([Char], LDoc) Doc)]
</span><a href="Test.DocTest.Driver.Extract.Ast.html#moduleHeaderDocs"><span class="hs-identifier hs-var hs-var">moduleHeaderDocs</span></a></span></span><span>
</span><span id="line-320"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(LDoc -&gt; DocTree (Either ([Char], LDoc) Doc))
-&gt; [LDoc] -&gt; [DocTree (Either ([Char], LDoc) Doc)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Either ([Char], LDoc) Doc -&gt; DocTree (Either ([Char], LDoc) Doc)
forall a. a -&gt; DocTree a
</span><a href="Test.DocTest.Driver.Extract.Ast.html#DocEntry"><span class="hs-identifier hs-var">DocEntry</span></a></span><span> </span><span class="annot"><span class="annottext">(Either ([Char], LDoc) Doc -&gt; DocTree (Either ([Char], LDoc) Doc))
-&gt; (LDoc -&gt; Either ([Char], LDoc) Doc)
-&gt; LDoc
-&gt; DocTree (Either ([Char], LDoc) Doc)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Either ([Char], LDoc) Doc
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; Either ([Char], LDoc) Doc)
-&gt; (LDoc -&gt; Doc) -&gt; LDoc -&gt; Either ([Char], LDoc) Doc
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">LDoc -&gt; Doc
forall l e. GenLocated l e -&gt; e
</span><span class="hs-identifier hs-var">unLoc</span></span><span class="hs-special">)</span><span>
</span><span id="line-321"></span><span>  </span><span class="annot"><span class="annottext">([LDoc] -&gt; [DocTree (Either ([Char], LDoc) Doc)])
-&gt; (HsModule GhcPs -&gt; [LDoc])
-&gt; HsModule GhcPs
-&gt; [DocTree (Either ([Char], LDoc) Doc)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Maybe LDoc -&gt; [LDoc]
forall a. Maybe a -&gt; [a]
</span><span class="hs-identifier hs-var">maybeToList</span></span><span>
</span><span id="line-322"></span><span>  </span><span class="annot"><span class="annottext">(Maybe LDoc -&gt; [LDoc])
-&gt; (HsModule GhcPs -&gt; Maybe LDoc) -&gt; HsModule GhcPs -&gt; [LDoc]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">XModulePs -&gt; Maybe LDoc
</span><span class="hs-identifier hs-var">GHC.hsmodHaddockModHeader</span></span><span>
</span><span id="line-323"></span><span>  </span><span class="annot"><span class="annottext">(XModulePs -&gt; Maybe LDoc)
-&gt; (HsModule GhcPs -&gt; XModulePs) -&gt; HsModule GhcPs -&gt; Maybe LDoc
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">HsModule GhcPs -&gt; XCModule GhcPs
HsModule GhcPs -&gt; XModulePs
forall p. HsModule p -&gt; XCModule p
</span><span class="hs-identifier hs-var">GHC.hsmodExt</span></span><span>
</span><span id="line-324"></span><span>
</span><span id="line-325"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#moduleExportDocs"><span class="hs-identifier hs-type">moduleExportDocs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GHC.HsModule</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">GhcPs</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocTree"><span class="hs-identifier hs-type">DocTree</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#LDoc"><span class="hs-identifier hs-type">LDoc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-326"></span><span id="moduleExportDocs"><span class="annot"><span class="annottext">moduleExportDocs :: HsModule GhcPs -&gt; [DocTree (Either ([Char], LDoc) Doc)]
</span><a href="Test.DocTest.Driver.Extract.Ast.html#moduleExportDocs"><span class="hs-identifier hs-var hs-var">moduleExportDocs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[IE GhcPs] -&gt; [DocTree (Either ([Char], LDoc) Doc)]
</span><a href="Test.DocTest.Driver.Extract.Ast.html#exportToDocs"><span class="hs-identifier hs-var">exportToDocs</span></a></span><span> </span><span class="annot"><span class="annottext">([IE GhcPs] -&gt; [DocTree (Either ([Char], LDoc) Doc)])
-&gt; (HsModule GhcPs -&gt; [IE GhcPs])
-&gt; HsModule GhcPs
-&gt; [DocTree (Either ([Char], LDoc) Doc)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(GenLocated SrcSpanAnnA (IE GhcPs) -&gt; IE GhcPs)
-&gt; [GenLocated SrcSpanAnnA (IE GhcPs)] -&gt; [IE GhcPs]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (IE GhcPs) -&gt; IE GhcPs
forall l e. GenLocated l e -&gt; e
</span><span class="hs-identifier hs-var">unLoc</span></span><span> </span><span class="annot"><span class="annottext">([GenLocated SrcSpanAnnA (IE GhcPs)] -&gt; [IE GhcPs])
-&gt; (HsModule GhcPs -&gt; [GenLocated SrcSpanAnnA (IE GhcPs)])
-&gt; HsModule GhcPs
-&gt; [IE GhcPs]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[GenLocated SrcSpanAnnA (IE GhcPs)]
-&gt; (GenLocated SrcSpanAnnL [GenLocated SrcSpanAnnA (IE GhcPs)]
    -&gt; [GenLocated SrcSpanAnnA (IE GhcPs)])
-&gt; Maybe
     (GenLocated SrcSpanAnnL [GenLocated SrcSpanAnnA (IE GhcPs)])
-&gt; [GenLocated SrcSpanAnnA (IE GhcPs)]
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnL [GenLocated SrcSpanAnnA (IE GhcPs)]
-&gt; [GenLocated SrcSpanAnnA (IE GhcPs)]
forall l e. GenLocated l e -&gt; e
</span><span class="hs-identifier hs-var">unLoc</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (GenLocated SrcSpanAnnL [GenLocated SrcSpanAnnA (IE GhcPs)])
 -&gt; [GenLocated SrcSpanAnnA (IE GhcPs)])
-&gt; (HsModule GhcPs
    -&gt; Maybe
         (GenLocated SrcSpanAnnL [GenLocated SrcSpanAnnA (IE GhcPs)]))
-&gt; HsModule GhcPs
-&gt; [GenLocated SrcSpanAnnA (IE GhcPs)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">HsModule GhcPs -&gt; Maybe (XRec GhcPs [LIE GhcPs])
HsModule GhcPs
-&gt; Maybe
     (GenLocated SrcSpanAnnL [GenLocated SrcSpanAnnA (IE GhcPs)])
forall p. HsModule p -&gt; Maybe (XRec p [LIE p])
</span><span class="hs-identifier hs-var">GHC.hsmodExports</span></span><span>
</span><span id="line-327"></span><span>
</span><span id="line-328"></span><span class="hs-comment">-- NOTE: GHC 9.10.1 has 'Doc' attached to exported names</span><span>
</span><span id="line-329"></span><span class="hs-comment">-- those fields do not exist in GHC 9.6.6, so all we care about here is group and entry</span><span>
</span><span id="line-330"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#exportToDocs"><span class="hs-identifier hs-type">exportToDocs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">GHC.IE</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">GhcPs</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocTree"><span class="hs-identifier hs-type">DocTree</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#LDoc"><span class="hs-identifier hs-type">LDoc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-331"></span><span id="exportToDocs"><span class="annot"><span class="annottext">exportToDocs :: [IE GhcPs] -&gt; [DocTree (Either ([Char], LDoc) Doc)]
</span><a href="Test.DocTest.Driver.Extract.Ast.html#exportToDocs"><span class="hs-identifier hs-var hs-var">exportToDocs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GHC.IEGroup</span></span><span> </span><span class="annot"><span class="annottext">XIEGroup GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679160498"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679160498"><span class="hs-identifier hs-var">level</span></a></span></span><span> </span><span id="local-6989586621679160499"><span class="annot"><span class="annottext">LDoc
</span><a href="#local-6989586621679160499"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679160500"><span class="annot"><span class="annottext">[IE GhcPs]
</span><a href="#local-6989586621679160500"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DocTree (Either ([Char], LDoc) Doc)
</span><a href="#local-6989586621679160501"><span class="hs-identifier hs-var">current</span></a></span><span> </span><span class="annot"><span class="annottext">DocTree (Either ([Char], LDoc) Doc)
-&gt; [DocTree (Either ([Char], LDoc) Doc)]
-&gt; [DocTree (Either ([Char], LDoc) Doc)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[IE GhcPs] -&gt; [DocTree (Either ([Char], LDoc) Doc)]
</span><a href="Test.DocTest.Driver.Extract.Ast.html#exportToDocs"><span class="hs-identifier hs-var">exportToDocs</span></a></span><span> </span><span class="annot"><span class="annottext">[IE GhcPs]
</span><a href="#local-6989586621679160502"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-332"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679160501"><span class="annot"><span class="annottext">current :: DocTree (Either ([Char], LDoc) Doc)
</span><a href="#local-6989586621679160501"><span class="hs-identifier hs-var hs-var">current</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Entity
-&gt; Loc
-&gt; [DocTree (Either ([Char], LDoc) Doc)]
-&gt; DocTree (Either ([Char], LDoc) Doc)
forall a. Entity -&gt; Loc -&gt; [DocTree a] -&gt; DocTree a
</span><a href="Test.DocTest.Driver.Extract.Ast.html#DocGroup"><span class="hs-identifier hs-var">DocGroup</span></a></span><span> </span><span class="annot"><span class="annottext">Entity
</span><a href="#local-6989586621679160504"><span class="hs-identifier hs-var">entity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcLoc -&gt; Loc
</span><a href="Test.DocTest.Driver.Extract.Ast.html#toLoc"><span class="hs-identifier hs-var">toLoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpan -&gt; SrcLoc
</span><span class="hs-identifier hs-var">GHC.srcSpanStart</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LDoc -&gt; SrcSpan
forall l e. GenLocated l e -&gt; l
</span><span class="hs-identifier hs-var">getLoc</span></span><span> </span><span class="annot"><span class="annottext">LDoc
</span><a href="#local-6989586621679160499"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[IE GhcPs] -&gt; [DocTree (Either ([Char], LDoc) Doc)]
</span><a href="Test.DocTest.Driver.Extract.Ast.html#exportToDocs"><span class="hs-identifier hs-var">exportToDocs</span></a></span><span> </span><span class="annot"><span class="annottext">[IE GhcPs]
</span><a href="#local-6989586621679160506"><span class="hs-identifier hs-var">children</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-333"></span><span>        </span><span id="local-6989586621679160504"><span class="annot"><span class="annottext">entity :: Entity
</span><a href="#local-6989586621679160504"><span class="hs-identifier hs-var hs-var">entity</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">$sel:kind:Entity :: EntityKind
</span><a href="Test.DocTest.Driver.Extract.Ast.html#%24sel%3Akind%3AEntity"><span class="hs-identifier hs-var">kind</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EntityKind
</span><a href="Test.DocTest.Driver.Extract.Ast.html#Section"><span class="hs-identifier hs-var">Section</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:name:Entity :: FastString
</span><a href="Test.DocTest.Driver.Extract.Ast.html#%24sel%3Aname%3AEntity"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; FastString
</span><a href="Test.DocTest.Driver.Extract.Ast.html#singleLineDoc"><span class="hs-identifier hs-var">singleLineDoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LDoc -&gt; Doc
forall l e. GenLocated l e -&gt; e
</span><span class="hs-identifier hs-var">unLoc</span></span><span> </span><span class="annot"><span class="annottext">LDoc
</span><a href="#local-6989586621679160499"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-334"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679160506"><span class="annot"><span class="annottext">[IE GhcPs]
</span><a href="#local-6989586621679160506"><span class="hs-identifier hs-var">children</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679160502"><span class="annot"><span class="annottext">[IE GhcPs]
</span><a href="#local-6989586621679160502"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(IE GhcPs -&gt; Bool) -&gt; [IE GhcPs] -&gt; ([IE GhcPs], [IE GhcPs])
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">span</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; IE GhcPs -&gt; Bool
</span><a href="Test.DocTest.Driver.Extract.Ast.html#inDocGroup"><span class="hs-identifier hs-var">inDocGroup</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679160498"><span class="hs-identifier hs-var">level</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[IE GhcPs]
</span><a href="#local-6989586621679160500"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-335"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#exportToDocs"><span class="hs-identifier hs-var">exportToDocs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GHC.IEDoc</span></span><span> </span><span class="annot"><span class="annottext">XIEDoc GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679160510"><span class="annot"><span class="annottext">LDoc
</span><a href="#local-6989586621679160510"><span class="hs-identifier hs-var">doc</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679160511"><span class="annot"><span class="annottext">[IE GhcPs]
</span><a href="#local-6989586621679160511"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either ([Char], LDoc) Doc -&gt; DocTree (Either ([Char], LDoc) Doc)
forall a. a -&gt; DocTree a
</span><a href="Test.DocTest.Driver.Extract.Ast.html#DocEntry"><span class="hs-identifier hs-var">DocEntry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc -&gt; Either ([Char], LDoc) Doc
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LDoc -&gt; Doc
forall l e. GenLocated l e -&gt; e
</span><span class="hs-identifier hs-var">unLoc</span></span><span> </span><span class="annot"><span class="annottext">LDoc
</span><a href="#local-6989586621679160510"><span class="hs-identifier hs-var">doc</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DocTree (Either ([Char], LDoc) Doc)
-&gt; [DocTree (Either ([Char], LDoc) Doc)]
-&gt; [DocTree (Either ([Char], LDoc) Doc)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[IE GhcPs] -&gt; [DocTree (Either ([Char], LDoc) Doc)]
</span><a href="Test.DocTest.Driver.Extract.Ast.html#exportToDocs"><span class="hs-identifier hs-var">exportToDocs</span></a></span><span> </span><span class="annot"><span class="annottext">[IE GhcPs]
</span><a href="#local-6989586621679160511"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-336"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#exportToDocs"><span class="hs-identifier hs-var">exportToDocs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IE GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679160512"><span class="annot"><span class="annottext">[IE GhcPs]
</span><a href="#local-6989586621679160512"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[IE GhcPs] -&gt; [DocTree (Either ([Char], LDoc) Doc)]
</span><a href="Test.DocTest.Driver.Extract.Ast.html#exportToDocs"><span class="hs-identifier hs-var">exportToDocs</span></a></span><span> </span><span class="annot"><span class="annottext">[IE GhcPs]
</span><a href="#local-6989586621679160512"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-337"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#exportToDocs"><span class="hs-identifier hs-var">exportToDocs</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-338"></span><span>
</span><span id="line-339"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#inDocGroup"><span class="hs-identifier hs-type">inDocGroup</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GHC.IE</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">GhcPs</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-340"></span><span id="inDocGroup"><span class="annot"><span class="annottext">inDocGroup :: Int -&gt; IE GhcPs -&gt; Bool
</span><a href="Test.DocTest.Driver.Extract.Ast.html#inDocGroup"><span class="hs-identifier hs-var hs-var">inDocGroup</span></a></span></span><span> </span><span id="local-6989586621679160513"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679160513"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GHC.IEGroup</span></span><span> </span><span class="annot"><span class="annottext">XIEGroup GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679160514"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679160514"><span class="hs-identifier hs-var">level</span></a></span></span><span> </span><span class="annot"><span class="annottext">LDoc
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679160514"><span class="hs-identifier hs-var">level</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679160513"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-341"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#inDocGroup"><span class="hs-identifier hs-var">inDocGroup</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">IE GhcPs
</span><span class="hs-identifier">_</span></span><span>                       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-342"></span><span>
</span><span id="line-343"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#singleLineDoc"><span class="hs-identifier hs-type">singleLineDoc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FastString</span></span><span>
</span><span id="line-344"></span><span id="singleLineDoc"><span class="annot"><span class="annottext">singleLineDoc :: Doc -&gt; FastString
</span><a href="Test.DocTest.Driver.Extract.Ast.html#singleLineDoc"><span class="hs-identifier hs-var hs-var">singleLineDoc</span></a></span></span><span> </span><span id="local-6989586621679160516"><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679160516"><span class="hs-identifier hs-var">doc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; HsDocString
forall a pass. WithHsDocIdentifiers a pass -&gt; a
</span><span class="hs-identifier hs-var">GHC.hsDocString</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679160516"><span class="hs-identifier hs-var">doc</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-345"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">GHC.MultiLineDocString</span></span><span> </span><span class="annot"><span class="annottext">HsDocStringDecorator
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679160519"><span class="annot"><span class="annottext">NonEmpty LHsDocStringChunk
</span><a href="#local-6989586621679160519"><span class="hs-identifier hs-var">lcs</span></a></span></span><span>
</span><span id="line-346"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">L</span></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679160520"><span class="annot"><span class="annottext">HsDocStringChunk
</span><a href="#local-6989586621679160520"><span class="hs-identifier hs-var">line</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NonEmpty LHsDocStringChunk
</span><a href="#local-6989586621679160519"><span class="hs-identifier hs-var">lcs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; FastString
</span><span class="hs-identifier hs-var">mkFastString</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ShowS
</span><a href="#local-6989586621679160522"><span class="hs-identifier hs-var">trim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsDocStringChunk -&gt; [Char]
</span><span class="hs-identifier hs-var">GHC.unpackHDSC</span></span><span> </span><span class="annot"><span class="annottext">HsDocStringChunk
</span><a href="#local-6989586621679160520"><span class="hs-identifier hs-var">line</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-347"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; FastString
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;singleLineDoc: found multiline documentation&quot;</span></span><span>
</span><span id="line-348"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">GHC.NestedDocString</span></span><span> </span><span class="annot"><span class="annottext">HsDocStringDecorator
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">LHsDocStringChunk
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; FastString
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;singleLineDoc: found multiline documentation&quot;</span></span><span>
</span><span id="line-349"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">GHC.GeneratedDocString</span></span><span> </span><span class="annot"><span class="annottext">HsDocStringChunk
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; FastString
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;singleLineDoc: found generated documentation&quot;</span></span><span>
</span><span id="line-350"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679160522"><span class="annot"><span class="annottext">trim :: ShowS
</span><a href="#local-6989586621679160522"><span class="hs-identifier hs-var hs-var">trim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; ShowS
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">List.dropWhileEnd</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isSpace</span></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; ShowS
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">dropWhile</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isSpace</span></span><span>
</span><span id="line-351"></span><span>
</span><span id="line-352"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#moduleDeclDocs"><span class="hs-identifier hs-type">moduleDeclDocs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GHC.HsModule</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">GhcPs</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocTree"><span class="hs-identifier hs-type">DocTree</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#LDoc"><span class="hs-identifier hs-type">LDoc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-353"></span><span id="moduleDeclDocs"><span class="annot"><span class="annottext">moduleDeclDocs :: HsModule GhcPs -&gt; [DocTree (Either ([Char], LDoc) Doc)]
</span><a href="Test.DocTest.Driver.Extract.Ast.html#moduleDeclDocs"><span class="hs-identifier hs-var hs-var">moduleDeclDocs</span></a></span></span><span>
</span><span id="line-354"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((GenLocated SrcSpanAnnA (HsDecl GhcPs), [Doc])
 -&gt; [DocTree (Either ([Char], LDoc) Doc)])
-&gt; [(GenLocated SrcSpanAnnA (HsDecl GhcPs), [Doc])]
-&gt; [DocTree (Either ([Char], LDoc) Doc)]
forall (t :: Type -&gt; Type) a b.
Foldable t =&gt;
(a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(GenLocated SrcSpanAnnA (HsDecl GhcPs)
 -&gt; [Doc] -&gt; [DocTree (Either ([Char], LDoc) Doc)])
-&gt; (GenLocated SrcSpanAnnA (HsDecl GhcPs), [Doc])
-&gt; [DocTree (Either ([Char], LDoc) Doc)]
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="annot"><span class="annottext">LHsDecl GhcPs -&gt; [Doc] -&gt; [DocTree (Either ([Char], LDoc) Doc)]
GenLocated SrcSpanAnnA (HsDecl GhcPs)
-&gt; [Doc] -&gt; [DocTree (Either ([Char], LDoc) Doc)]
</span><a href="Test.DocTest.Driver.Extract.Ast.html#toDocTree"><span class="hs-identifier hs-var">toDocTree</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-355"></span><span>  </span><span class="annot"><span class="annottext">([(GenLocated SrcSpanAnnA (HsDecl GhcPs), [Doc])]
 -&gt; [DocTree (Either ([Char], LDoc) Doc)])
-&gt; (HsModule GhcPs
    -&gt; [(GenLocated SrcSpanAnnA (HsDecl GhcPs), [Doc])])
-&gt; HsModule GhcPs
-&gt; [DocTree (Either ([Char], LDoc) Doc)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[LHsDecl GhcPs] -&gt; [(LHsDecl GhcPs, [Doc])]
[GenLocated SrcSpanAnnA (HsDecl GhcPs)]
-&gt; [(GenLocated SrcSpanAnnA (HsDecl GhcPs), [Doc])]
forall p. UnXRec p =&gt; [LHsDecl p] -&gt; [(LHsDecl p, [HsDoc p])]
</span><span class="hs-identifier hs-var">GHC.collectDocs</span></span><span>
</span><span id="line-356"></span><span>  </span><span class="annot"><span class="annottext">([GenLocated SrcSpanAnnA (HsDecl GhcPs)]
 -&gt; [(GenLocated SrcSpanAnnA (HsDecl GhcPs), [Doc])])
-&gt; (HsModule GhcPs -&gt; [GenLocated SrcSpanAnnA (HsDecl GhcPs)])
-&gt; HsModule GhcPs
-&gt; [(GenLocated SrcSpanAnnA (HsDecl GhcPs), [Doc])]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(GenLocated SrcSpanAnnA (HsDecl GhcPs)
 -&gt; GenLocated SrcSpanAnnA (HsDecl GhcPs) -&gt; Ordering)
-&gt; [GenLocated SrcSpanAnnA (HsDecl GhcPs)]
-&gt; [GenLocated SrcSpanAnnA (HsDecl GhcPs)]
forall a. (a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">List.sortBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpan -&gt; SrcSpan -&gt; Ordering
</span><span class="hs-identifier hs-var">GHC.leftmost_smallest</span></span><span> </span><span class="annot"><span class="annottext">(SrcSpan -&gt; SrcSpan -&gt; Ordering)
-&gt; (GenLocated SrcSpanAnnA (HsDecl GhcPs) -&gt; SrcSpan)
-&gt; GenLocated SrcSpanAnnA (HsDecl GhcPs)
-&gt; GenLocated SrcSpanAnnA (HsDecl GhcPs)
-&gt; Ordering
forall b c a. (b -&gt; b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; c
</span><span class="hs-operator hs-var">`on`</span></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsDecl GhcPs) -&gt; SrcSpan
forall a e. GenLocated (SrcSpanAnn' a) e -&gt; SrcSpan
</span><span class="hs-identifier hs-var">getLocA</span></span><span class="hs-special">)</span><span>
</span><span id="line-357"></span><span>  </span><span class="annot"><span class="annottext">([GenLocated SrcSpanAnnA (HsDecl GhcPs)]
 -&gt; [GenLocated SrcSpanAnnA (HsDecl GhcPs)])
-&gt; (HsModule GhcPs -&gt; [GenLocated SrcSpanAnnA (HsDecl GhcPs)])
-&gt; HsModule GhcPs
-&gt; [GenLocated SrcSpanAnnA (HsDecl GhcPs)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">HsModule GhcPs -&gt; [LHsDecl GhcPs]
HsModule GhcPs -&gt; [GenLocated SrcSpanAnnA (HsDecl GhcPs)]
forall p. HsModule p -&gt; [LHsDecl p]
</span><span class="hs-identifier hs-var">GHC.hsmodDecls</span></span><span>
</span><span id="line-358"></span><span>
</span><span id="line-359"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#collectModule"><span class="hs-identifier hs-type">collectModule</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ParsedModule</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#SetupCode"><span class="hs-identifier hs-type">SetupCode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocTests"><span class="hs-identifier hs-type">DocTests</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Module"><span class="hs-identifier hs-type">Module</span></a></span><span>
</span><span id="line-360"></span><span id="collectModule"><span class="annot"><span class="annottext">collectModule :: ParsedModule -&gt; SetupCode -&gt; [DocTests] -&gt; Module
</span><a href="Test.DocTest.Driver.Extract.Ast.html#collectModule"><span class="hs-identifier hs-var hs-var">collectModule</span></a></span></span><span> </span><span id="local-6989586621679160533"><span class="annot"><span class="annottext">ParsedModule
</span><a href="#local-6989586621679160533"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679160534"><span class="annot"><span class="annottext">SetupCode
</span><a href="#local-6989586621679160534"><span class="hs-identifier hs-var">setup</span></a></span></span><span> </span><span id="local-6989586621679160535"><span class="annot"><span class="annottext">[DocTests]
</span><a href="#local-6989586621679160535"><span class="hs-identifier hs-var">testCases</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Module"><span class="hs-identifier hs-type">Module</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">[Char]
$sel:filePath:Module :: [Char]
filePath :: [Char]
</span><a href="Test.DocTest.Driver.Extract.Ast.html#%24sel%3AfilePath%3AModule"><span class="hs-identifier hs-var hs-var">filePath</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[[Char]]
$sel:modulePath:Module :: [[Char]]
modulePath :: [[Char]]
</span><a href="Test.DocTest.Driver.Extract.Ast.html#%24sel%3AmodulePath%3AModule"><span class="hs-identifier hs-var hs-var">modulePath</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[DocLine]
$sel:importList:Module :: [DocLine]
importList :: [DocLine]
</span><a href="Test.DocTest.Driver.Extract.Ast.html#%24sel%3AimportList%3AModule"><span class="hs-identifier hs-var hs-var">importList</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[DocLine]
$sel:topSetup:Module :: [DocLine]
topSetup :: [DocLine]
</span><a href="Test.DocTest.Driver.Extract.Ast.html#%24sel%3AtopSetup%3AModule"><span class="hs-identifier hs-var hs-var">topSetup</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[DocTests]
$sel:testCases:Module :: [DocTests]
testCases :: [DocTests]
</span><a href="Test.DocTest.Driver.Extract.Ast.html#%24sel%3AtestCases%3AModule"><span class="hs-identifier hs-var hs-var">testCases</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-361"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679160536"><span class="annot"><span class="annottext">filePath :: [Char]
</span><a href="#local-6989586621679160536"><span class="hs-identifier hs-var hs-var">filePath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ParsedModule
</span><a href="#local-6989586621679160533"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">pm_mod_summary</span><span class="hs-operator">.</span><span class="hs-identifier">ms_hspp_file</span><span>
</span><span id="line-362"></span><span>        </span><span id="local-6989586621679160537"><span class="annot"><span class="annottext">modulePath :: [[Char]]
</span><a href="#local-6989586621679160537"><span class="hs-identifier hs-var hs-var">modulePath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; [[Char]]
</span><a href="#local-6989586621679160540"><span class="hs-identifier hs-var">takeModulePath</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModSummary -&gt; ModuleName
</span><span class="hs-identifier hs-var">GHC.ms_mod_name</span></span><span> </span><span class="annot"><span class="annottext">ParsedModule
</span><a href="#local-6989586621679160533"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">pm_mod_summary</span><span class="hs-special">)</span><span>
</span><span id="line-363"></span><span>        </span><span id="local-6989586621679160540"><span class="annot"><span class="annottext">takeModulePath :: ModuleName -&gt; [[Char]]
</span><a href="#local-6989586621679160540"><span class="hs-identifier hs-var hs-var">takeModulePath</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GHC.ModuleName</span></span><span> </span><span id="local-6989586621679160543"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621679160543"><span class="hs-identifier hs-var">path</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; [Char] -&gt; [[Char]]
forall a. Eq a =&gt; a -&gt; [a] -&gt; [[a]]
</span><a href="Test.DocTest.Driver.Utils.html#splitBy"><span class="hs-identifier hs-var">splitBy</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'.'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FastString -&gt; [Char]
</span><span class="hs-identifier hs-var">unpackFS</span></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621679160543"><span class="hs-identifier hs-var">path</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-364"></span><span>        </span><span id="local-6989586621679160550"><span class="annot"><span class="annottext">mergeGroups :: [([Char], NonEmpty DocLine)] -&gt; [DocLine]
</span><a href="#local-6989586621679160550"><span class="hs-identifier hs-var hs-var">mergeGroups</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DocLine] -&gt; [[DocLine]] -&gt; [DocLine]
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">List.intercalate</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">DocLine
</span><a href="Test.DocTest.Driver.Extract.Ast.html#emptyLine"><span class="hs-identifier hs-var">emptyLine</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">([[DocLine]] -&gt; [DocLine])
-&gt; ([([Char], NonEmpty DocLine)] -&gt; [[DocLine]])
-&gt; [([Char], NonEmpty DocLine)]
-&gt; [DocLine]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(([Char], NonEmpty DocLine) -&gt; [DocLine])
-&gt; [([Char], NonEmpty DocLine)] -&gt; [[DocLine]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NonEmpty DocLine -&gt; [DocLine]
forall a. NonEmpty a -&gt; [a]
</span><span class="hs-identifier hs-var">NonEmpty.toList</span></span><span> </span><span class="annot"><span class="annottext">(NonEmpty DocLine -&gt; [DocLine])
-&gt; (([Char], NonEmpty DocLine) -&gt; NonEmpty DocLine)
-&gt; ([Char], NonEmpty DocLine)
-&gt; [DocLine]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">([Char], NonEmpty DocLine) -&gt; NonEmpty DocLine
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([([Char], NonEmpty DocLine)] -&gt; [[DocLine]])
-&gt; ([([Char], NonEmpty DocLine)] -&gt; [([Char], NonEmpty DocLine)])
-&gt; [([Char], NonEmpty DocLine)]
-&gt; [[DocLine]]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(([Char], NonEmpty DocLine) -&gt; [Char])
-&gt; [([Char], NonEmpty DocLine)] -&gt; [([Char], NonEmpty DocLine)]
forall b a. Ord b =&gt; (a -&gt; b) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">List.sortOn</span></span><span> </span><span class="annot"><span class="annottext">([Char], NonEmpty DocLine) -&gt; [Char]
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span>
</span><span id="line-365"></span><span>        </span><span id="local-6989586621679160538"><span class="annot"><span class="annottext">importList :: [DocLine]
</span><a href="#local-6989586621679160538"><span class="hs-identifier hs-var hs-var">importList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[([Char], NonEmpty DocLine)] -&gt; [DocLine]
</span><a href="#local-6989586621679160550"><span class="hs-identifier hs-var">mergeGroups</span></a></span><span> </span><span class="annot"><span class="annottext">SetupCode
</span><a href="#local-6989586621679160534"><span class="hs-identifier hs-var">setup</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">setupImport</span><span>
</span><span id="line-366"></span><span>        </span><span id="local-6989586621679160539"><span class="annot"><span class="annottext">topSetup :: [DocLine]
</span><a href="#local-6989586621679160539"><span class="hs-identifier hs-var hs-var">topSetup</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[([Char], NonEmpty DocLine)] -&gt; [DocLine]
</span><a href="#local-6989586621679160550"><span class="hs-identifier hs-var">mergeGroups</span></a></span><span> </span><span class="annot"><span class="annottext">SetupCode
</span><a href="#local-6989586621679160534"><span class="hs-identifier hs-var">setup</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">setupTop</span><span>
</span><span id="line-367"></span><span>
</span><span id="line-368"></span><span class="hs-keyword">type</span><span> </span><span id="Doc"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Doc"><span class="hs-identifier hs-var">Doc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GHC.HsDoc</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">GhcPs</span></span><span>
</span><span id="line-369"></span><span class="hs-keyword">type</span><span> </span><span id="LDoc"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#LDoc"><span class="hs-identifier hs-var">LDoc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GHC.LHsDoc</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">GhcPs</span></span><span>
</span><span id="line-370"></span><span>
</span><span id="line-371"></span><span class="hs-keyword">data</span><span> </span><span id="DocTree"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocTree"><span class="hs-identifier hs-var">DocTree</span></a></span></span><span> </span><span id="local-6989586621679159436"><span class="annot"><a href="#local-6989586621679159436"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-372"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="DocEntry"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocEntry"><span class="hs-identifier hs-var">DocEntry</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679159436"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-373"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="DocGroup"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocGroup"><span class="hs-identifier hs-var">DocGroup</span></a></span></span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Entity"><span class="hs-identifier hs-type">Entity</span></a></span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Loc"><span class="hs-identifier hs-type">Loc</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocTree"><span class="hs-identifier hs-type">DocTree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679159436"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-374"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679160558"><span id="local-6989586621679160567"><span class="annot"><span class="annottext">DocTree a -&gt; DocTree a -&gt; Bool
(DocTree a -&gt; DocTree a -&gt; Bool)
-&gt; (DocTree a -&gt; DocTree a -&gt; Bool) -&gt; Eq (DocTree a)
forall a. Eq a =&gt; DocTree a -&gt; DocTree a -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: forall a. Eq a =&gt; DocTree a -&gt; DocTree a -&gt; Bool
== :: DocTree a -&gt; DocTree a -&gt; Bool
$c/= :: forall a. Eq a =&gt; DocTree a -&gt; DocTree a -&gt; Bool
/= :: DocTree a -&gt; DocTree a -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679160572"><span id="local-6989586621679160583"><span id="local-6989586621679160587"><span class="annot"><span class="annottext">Int -&gt; DocTree a -&gt; ShowS
[DocTree a] -&gt; ShowS
DocTree a -&gt; [Char]
(Int -&gt; DocTree a -&gt; ShowS)
-&gt; (DocTree a -&gt; [Char])
-&gt; ([DocTree a] -&gt; ShowS)
-&gt; Show (DocTree a)
forall a. Show a =&gt; Int -&gt; DocTree a -&gt; ShowS
forall a. Show a =&gt; [DocTree a] -&gt; ShowS
forall a. Show a =&gt; DocTree a -&gt; [Char]
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: forall a. Show a =&gt; Int -&gt; DocTree a -&gt; ShowS
showsPrec :: Int -&gt; DocTree a -&gt; ShowS
$cshow :: forall a. Show a =&gt; DocTree a -&gt; [Char]
show :: DocTree a -&gt; [Char]
$cshowList :: forall a. Show a =&gt; [DocTree a] -&gt; ShowS
showList :: [DocTree a] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679160590"><span id="local-6989586621679160596"><span class="annot"><span class="annottext">(forall a b. (a -&gt; b) -&gt; DocTree a -&gt; DocTree b)
-&gt; (forall a b. a -&gt; DocTree b -&gt; DocTree a) -&gt; Functor DocTree
forall a b. a -&gt; DocTree b -&gt; DocTree a
forall a b. (a -&gt; b) -&gt; DocTree a -&gt; DocTree b
forall (f :: Type -&gt; Type).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
$cfmap :: forall a b. (a -&gt; b) -&gt; DocTree a -&gt; DocTree b
fmap :: forall a b. (a -&gt; b) -&gt; DocTree a -&gt; DocTree b
$c&lt;$ :: forall a b. a -&gt; DocTree b -&gt; DocTree a
&lt;$ :: forall a b. a -&gt; DocTree b -&gt; DocTree a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679160601"><span id="local-6989586621679160607"><span id="local-6989586621679160614"><span id="local-6989586621679160619"><span id="local-6989586621679160623"><span id="local-6989586621679160626"><span id="local-6989586621679160629"><span id="local-6989586621679160632"><span id="local-6989586621679160635"><span id="local-6989586621679160638"><span id="local-6989586621679160641"><span id="local-6989586621679160645"><span id="local-6989586621679160648"><span id="local-6989586621679160653"><span id="local-6989586621679160658"><span id="local-6989586621679160663"><span id="local-6989586621679160668"><span class="annot"><span class="annottext">(forall m. Monoid m =&gt; DocTree m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; DocTree a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; DocTree a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; DocTree a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; DocTree a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; DocTree a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; DocTree a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; DocTree a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; DocTree a -&gt; a)
-&gt; (forall a. DocTree a -&gt; [a])
-&gt; (forall a. DocTree a -&gt; Bool)
-&gt; (forall a. DocTree a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; DocTree a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; DocTree a -&gt; a)
-&gt; (forall a. Ord a =&gt; DocTree a -&gt; a)
-&gt; (forall a. Num a =&gt; DocTree a -&gt; a)
-&gt; (forall a. Num a =&gt; DocTree a -&gt; a)
-&gt; Foldable DocTree
forall a. Eq a =&gt; a -&gt; DocTree a -&gt; Bool
forall a. Num a =&gt; DocTree a -&gt; a
forall a. Ord a =&gt; DocTree a -&gt; a
forall m. Monoid m =&gt; DocTree m -&gt; m
forall a. DocTree a -&gt; Bool
forall a. DocTree a -&gt; Int
forall a. DocTree a -&gt; [a]
forall a. (a -&gt; a -&gt; a) -&gt; DocTree a -&gt; a
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; DocTree a -&gt; m
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; DocTree a -&gt; b
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; DocTree a -&gt; b
forall (t :: Type -&gt; Type).
(forall m. Monoid m =&gt; t m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. t a -&gt; [a])
-&gt; (forall a. t a -&gt; Bool)
-&gt; (forall a. t a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; t a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; Foldable t
$cfold :: forall m. Monoid m =&gt; DocTree m -&gt; m
fold :: forall m. Monoid m =&gt; DocTree m -&gt; m
$cfoldMap :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; DocTree a -&gt; m
foldMap :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; DocTree a -&gt; m
$cfoldMap' :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; DocTree a -&gt; m
foldMap' :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; DocTree a -&gt; m
$cfoldr :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; DocTree a -&gt; b
foldr :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; DocTree a -&gt; b
$cfoldr' :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; DocTree a -&gt; b
foldr' :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; DocTree a -&gt; b
$cfoldl :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; DocTree a -&gt; b
foldl :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; DocTree a -&gt; b
$cfoldl' :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; DocTree a -&gt; b
foldl' :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; DocTree a -&gt; b
$cfoldr1 :: forall a. (a -&gt; a -&gt; a) -&gt; DocTree a -&gt; a
foldr1 :: forall a. (a -&gt; a -&gt; a) -&gt; DocTree a -&gt; a
$cfoldl1 :: forall a. (a -&gt; a -&gt; a) -&gt; DocTree a -&gt; a
foldl1 :: forall a. (a -&gt; a -&gt; a) -&gt; DocTree a -&gt; a
$ctoList :: forall a. DocTree a -&gt; [a]
toList :: forall a. DocTree a -&gt; [a]
$cnull :: forall a. DocTree a -&gt; Bool
null :: forall a. DocTree a -&gt; Bool
$clength :: forall a. DocTree a -&gt; Int
length :: forall a. DocTree a -&gt; Int
$celem :: forall a. Eq a =&gt; a -&gt; DocTree a -&gt; Bool
elem :: forall a. Eq a =&gt; a -&gt; DocTree a -&gt; Bool
$cmaximum :: forall a. Ord a =&gt; DocTree a -&gt; a
maximum :: forall a. Ord a =&gt; DocTree a -&gt; a
$cminimum :: forall a. Ord a =&gt; DocTree a -&gt; a
minimum :: forall a. Ord a =&gt; DocTree a -&gt; a
$csum :: forall a. Num a =&gt; DocTree a -&gt; a
sum :: forall a. Num a =&gt; DocTree a -&gt; a
$cproduct :: forall a. Num a =&gt; DocTree a -&gt; a
product :: forall a. Num a =&gt; DocTree a -&gt; a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Foldable</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679160678"><span id="local-6989586621679160689"><span id="local-6989586621679160694"><span id="local-6989586621679160699"><span class="annot"><span class="annottext">Functor DocTree
Foldable DocTree
(Functor DocTree, Foldable DocTree) =&gt;
(forall (f :: Type -&gt; Type) a b.
 Applicative f =&gt;
 (a -&gt; f b) -&gt; DocTree a -&gt; f (DocTree b))
-&gt; (forall (f :: Type -&gt; Type) a.
    Applicative f =&gt;
    DocTree (f a) -&gt; f (DocTree a))
-&gt; (forall (m :: Type -&gt; Type) a b.
    Monad m =&gt;
    (a -&gt; m b) -&gt; DocTree a -&gt; m (DocTree b))
-&gt; (forall (m :: Type -&gt; Type) a.
    Monad m =&gt;
    DocTree (m a) -&gt; m (DocTree a))
-&gt; Traversable DocTree
forall (t :: Type -&gt; Type).
(Functor t, Foldable t) =&gt;
(forall (f :: Type -&gt; Type) a b.
 Applicative f =&gt;
 (a -&gt; f b) -&gt; t a -&gt; f (t b))
-&gt; (forall (f :: Type -&gt; Type) a.
    Applicative f =&gt;
    t (f a) -&gt; f (t a))
-&gt; (forall (m :: Type -&gt; Type) a b.
    Monad m =&gt;
    (a -&gt; m b) -&gt; t a -&gt; m (t b))
-&gt; (forall (m :: Type -&gt; Type) a. Monad m =&gt; t (m a) -&gt; m (t a))
-&gt; Traversable t
forall (m :: Type -&gt; Type) a.
Monad m =&gt;
DocTree (m a) -&gt; m (DocTree a)
forall (f :: Type -&gt; Type) a.
Applicative f =&gt;
DocTree (f a) -&gt; f (DocTree a)
forall (m :: Type -&gt; Type) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; DocTree a -&gt; m (DocTree b)
forall (f :: Type -&gt; Type) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; DocTree a -&gt; f (DocTree b)
$ctraverse :: forall (f :: Type -&gt; Type) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; DocTree a -&gt; f (DocTree b)
traverse :: forall (f :: Type -&gt; Type) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; DocTree a -&gt; f (DocTree b)
$csequenceA :: forall (f :: Type -&gt; Type) a.
Applicative f =&gt;
DocTree (f a) -&gt; f (DocTree a)
sequenceA :: forall (f :: Type -&gt; Type) a.
Applicative f =&gt;
DocTree (f a) -&gt; f (DocTree a)
$cmapM :: forall (m :: Type -&gt; Type) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; DocTree a -&gt; m (DocTree b)
mapM :: forall (m :: Type -&gt; Type) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; DocTree a -&gt; m (DocTree b)
$csequence :: forall (m :: Type -&gt; Type) a.
Monad m =&gt;
DocTree (m a) -&gt; m (DocTree a)
sequence :: forall (m :: Type -&gt; Type) a.
Monad m =&gt;
DocTree (m a) -&gt; m (DocTree a)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Traversable</span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-375"></span><span>
</span><span id="line-376"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679160710"><span id="local-6989586621679160714"><span id="local-6989586621679160717"><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocTree"><span class="hs-identifier hs-type">DocTree</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-377"></span><span>  </span><span id="local-6989586621679160720"><span class="annot"><span class="annottext">pure :: forall a. a -&gt; DocTree a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">pure</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; DocTree a
forall a. a -&gt; DocTree a
</span><a href="Test.DocTest.Driver.Extract.Ast.html#DocEntry"><span class="hs-identifier hs-var">DocEntry</span></a></span><span>
</span><span id="line-378"></span><span>  </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocEntry"><span class="hs-identifier hs-type">DocEntry</span></a></span><span> </span><span id="local-6989586621679160723"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679160723"><span class="hs-identifier hs-var">f</span></a></span></span><span>      </span><span id="local-6989586621679160724"><span class="annot"><span class="annottext">&lt;*&gt; :: forall a b. DocTree (a -&gt; b) -&gt; DocTree a -&gt; DocTree b
</span><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;*&gt;</span></span></span><span> </span><span id="local-6989586621679160725"><span class="annot"><span class="annottext">DocTree a
</span><a href="#local-6989586621679160725"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; DocTree a -&gt; DocTree b
forall a b. (a -&gt; b) -&gt; DocTree a -&gt; DocTree b
forall (f :: Type -&gt; Type) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679160723"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">DocTree a
</span><a href="#local-6989586621679160725"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-379"></span><span>  </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocGroup"><span class="hs-identifier hs-type">DocGroup</span></a></span><span> </span><span id="local-6989586621679160726"><span class="annot"><span class="annottext">Entity
</span><a href="#local-6989586621679160726"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679160727"><span class="annot"><span class="annottext">Loc
</span><a href="#local-6989586621679160727"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679160728"><span class="annot"><span class="annottext">[DocTree (a -&gt; b)]
</span><a href="#local-6989586621679160728"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span id="local-6989586621679160729"><span class="annot"><span class="annottext">DocTree a
</span><a href="#local-6989586621679160729"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Entity -&gt; Loc -&gt; [DocTree b] -&gt; DocTree b
forall a. Entity -&gt; Loc -&gt; [DocTree a] -&gt; DocTree a
</span><a href="Test.DocTest.Driver.Extract.Ast.html#DocGroup"><span class="hs-identifier hs-var">DocGroup</span></a></span><span> </span><span class="annot"><span class="annottext">Entity
</span><a href="#local-6989586621679160726"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Loc
</span><a href="#local-6989586621679160727"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DocTree (a -&gt; b) -&gt; DocTree b)
-&gt; [DocTree (a -&gt; b)] -&gt; [DocTree b]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DocTree (a -&gt; b) -&gt; DocTree a -&gt; DocTree b
forall a b. DocTree (a -&gt; b) -&gt; DocTree a -&gt; DocTree b
forall (f :: Type -&gt; Type) a b.
Applicative f =&gt;
f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">DocTree a
</span><a href="#local-6989586621679160729"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[DocTree (a -&gt; b)]
</span><a href="#local-6989586621679160728"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-380"></span><span>
</span><span id="line-381"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679160734"><span id="local-6989586621679160737"><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocTree"><span class="hs-identifier hs-type">DocTree</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-382"></span><span>  </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocEntry"><span class="hs-identifier hs-type">DocEntry</span></a></span><span> </span><span id="local-6989586621679160741"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679160741"><span class="hs-identifier hs-var">x</span></a></span></span><span>      </span><span id="local-6989586621679160742"><span class="annot"><span class="annottext">&gt;&gt;= :: forall a b. DocTree a -&gt; (a -&gt; DocTree b) -&gt; DocTree b
</span><span class="hs-operator hs-var hs-var hs-var hs-var">&gt;&gt;=</span></span></span><span> </span><span id="local-6989586621679160743"><span class="annot"><span class="annottext">a -&gt; DocTree b
</span><a href="#local-6989586621679160743"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; DocTree b
</span><a href="#local-6989586621679160743"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679160741"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-383"></span><span>  </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocGroup"><span class="hs-identifier hs-type">DocGroup</span></a></span><span> </span><span id="local-6989586621679160744"><span class="annot"><span class="annottext">Entity
</span><a href="#local-6989586621679160744"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679160745"><span class="annot"><span class="annottext">Loc
</span><a href="#local-6989586621679160745"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679160746"><span class="annot"><span class="annottext">[DocTree a]
</span><a href="#local-6989586621679160746"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span id="local-6989586621679160747"><span class="annot"><span class="annottext">a -&gt; DocTree b
</span><a href="#local-6989586621679160747"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Entity -&gt; Loc -&gt; [DocTree b] -&gt; DocTree b
forall a. Entity -&gt; Loc -&gt; [DocTree a] -&gt; DocTree a
</span><a href="Test.DocTest.Driver.Extract.Ast.html#DocGroup"><span class="hs-identifier hs-var">DocGroup</span></a></span><span> </span><span class="annot"><span class="annottext">Entity
</span><a href="#local-6989586621679160744"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Loc
</span><a href="#local-6989586621679160745"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DocTree a -&gt; DocTree b) -&gt; [DocTree a] -&gt; [DocTree b]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DocTree a -&gt; (a -&gt; DocTree b) -&gt; DocTree b
forall a b. DocTree a -&gt; (a -&gt; DocTree b) -&gt; DocTree b
forall (m :: Type -&gt; Type) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; DocTree b
</span><a href="#local-6989586621679160747"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[DocTree a]
</span><a href="#local-6989586621679160746"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-384"></span><span>
</span><span id="line-385"></span><span id="local-6989586621679159422"><span id="local-6989586621679159423"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#mapTreeList"><span class="hs-identifier hs-type">mapTreeList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679159422"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679159423"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocTree"><span class="hs-identifier hs-type">DocTree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679159422"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocTree"><span class="hs-identifier hs-type">DocTree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679159423"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-386"></span><span id="mapTreeList"><span class="annot"><span class="annottext">mapTreeList :: forall a b. (a -&gt; [b]) -&gt; [DocTree a] -&gt; [DocTree b]
</span><a href="Test.DocTest.Driver.Extract.Ast.html#mapTreeList"><span class="hs-identifier hs-var hs-var">mapTreeList</span></a></span></span><span> </span><span id="local-6989586621679160749"><span class="annot"><span class="annottext">a -&gt; [b]
</span><a href="#local-6989586621679160749"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(DocTree a -&gt; [DocTree b]) -&gt; [DocTree a] -&gt; [DocTree b]
forall (t :: Type -&gt; Type) a b.
Foldable t =&gt;
(a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">DocTree a -&gt; [DocTree b]
</span><a href="#local-6989586621679160750"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-387"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679160750"><span class="annot"><span class="annottext">go :: DocTree a -&gt; [DocTree b]
</span><a href="#local-6989586621679160750"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocEntry"><span class="hs-identifier hs-type">DocEntry</span></a></span><span> </span><span id="local-6989586621679160751"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679160751"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(b -&gt; DocTree b) -&gt; [b] -&gt; [DocTree b]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; DocTree b
forall a. a -&gt; DocTree a
</span><a href="Test.DocTest.Driver.Extract.Ast.html#DocEntry"><span class="hs-identifier hs-var">DocEntry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; [b]
</span><a href="#local-6989586621679160749"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679160751"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-388"></span><span>        </span><span class="annot"><a href="#local-6989586621679160750"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocGroup"><span class="hs-identifier hs-type">DocGroup</span></a></span><span> </span><span id="local-6989586621679160752"><span class="annot"><span class="annottext">Entity
</span><a href="#local-6989586621679160752"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679160753"><span class="annot"><span class="annottext">Loc
</span><a href="#local-6989586621679160753"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679160754"><span class="annot"><span class="annottext">[DocTree a]
</span><a href="#local-6989586621679160754"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Entity -&gt; Loc -&gt; [DocTree b] -&gt; DocTree b
forall a. Entity -&gt; Loc -&gt; [DocTree a] -&gt; DocTree a
</span><a href="Test.DocTest.Driver.Extract.Ast.html#DocGroup"><span class="hs-identifier hs-var">DocGroup</span></a></span><span> </span><span class="annot"><span class="annottext">Entity
</span><a href="#local-6989586621679160752"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Loc
</span><a href="#local-6989586621679160753"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; [b]) -&gt; [DocTree a] -&gt; [DocTree b]
forall a b. (a -&gt; [b]) -&gt; [DocTree a] -&gt; [DocTree b]
</span><a href="Test.DocTest.Driver.Extract.Ast.html#mapTreeList"><span class="hs-identifier hs-var">mapTreeList</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [b]
</span><a href="#local-6989586621679160749"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[DocTree a]
</span><a href="#local-6989586621679160754"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-389"></span><span>
</span><span id="line-390"></span><span id="local-6989586621679159427"><span id="local-6989586621679159428"><span id="local-6989586621679159429"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#partitionTreeList"><span class="hs-identifier hs-type">partitionTreeList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679159427"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679159428"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679159427"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679159429"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocTree"><span class="hs-identifier hs-type">DocTree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679159428"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679159427"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocTree"><span class="hs-identifier hs-type">DocTree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679159429"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-391"></span><span id="partitionTreeList"><span class="annot"><span class="annottext">partitionTreeList :: forall b a c.
Monoid b =&gt;
(a -&gt; Either b c) -&gt; [DocTree a] -&gt; (b, [DocTree c])
</span><a href="Test.DocTest.Driver.Extract.Ast.html#partitionTreeList"><span class="hs-identifier hs-var hs-var">partitionTreeList</span></a></span></span><span> </span><span id="local-6989586621679160763"><span class="annot"><span class="annottext">a -&gt; Either b c
</span><a href="#local-6989586621679160763"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Maybe (DocTree c)] -&gt; [DocTree c])
-&gt; (b, [Maybe (DocTree c)]) -&gt; (b, [DocTree c])
forall b c a. (b -&gt; c) -&gt; (a, b) -&gt; (a, c)
forall (p :: Type -&gt; Type -&gt; Type) b c a.
Bifunctor p =&gt;
(b -&gt; c) -&gt; p a b -&gt; p a c
</span><span class="hs-identifier hs-var">second</span></span><span> </span><span class="annot"><span class="annottext">[Maybe (DocTree c)] -&gt; [DocTree c]
forall a. [Maybe a] -&gt; [a]
</span><span class="hs-identifier hs-var">catMaybes</span></span><span> </span><span class="annot"><span class="annottext">((b, [Maybe (DocTree c)]) -&gt; (b, [DocTree c]))
-&gt; ([DocTree a] -&gt; (b, [Maybe (DocTree c)]))
-&gt; [DocTree a]
-&gt; (b, [DocTree c])
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(DocTree a -&gt; (b, Maybe (DocTree c)))
-&gt; [DocTree a] -&gt; (b, [Maybe (DocTree c)])
forall (t :: Type -&gt; Type) (f :: Type -&gt; Type) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: Type -&gt; Type) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; [a] -&gt; f [b]
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">DocTree a -&gt; (b, Maybe (DocTree c))
</span><a href="#local-6989586621679160765"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-392"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679160765"><span class="annot"><span class="annottext">go :: DocTree a -&gt; (b, Maybe (DocTree c))
</span><a href="#local-6989586621679160765"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocEntry"><span class="hs-identifier hs-type">DocEntry</span></a></span><span> </span><span id="local-6989586621679160766"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679160766"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(b -&gt; (b, Maybe (DocTree c)))
-&gt; (c -&gt; (b, Maybe (DocTree c)))
-&gt; Either b c
-&gt; (b, Maybe (DocTree c))
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe (DocTree c)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe (DocTree c) -&gt; (b, Maybe (DocTree c)))
-&gt; (c -&gt; Maybe (DocTree c)) -&gt; c -&gt; (b, Maybe (DocTree c))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">DocTree c -&gt; Maybe (DocTree c)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(DocTree c -&gt; Maybe (DocTree c))
-&gt; (c -&gt; DocTree c) -&gt; c -&gt; Maybe (DocTree c)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">c -&gt; DocTree c
forall a. a -&gt; DocTree a
</span><a href="Test.DocTest.Driver.Extract.Ast.html#DocEntry"><span class="hs-identifier hs-var">DocEntry</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Either b c
</span><a href="#local-6989586621679160763"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679160766"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-393"></span><span>        </span><span class="annot"><a href="#local-6989586621679160765"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocGroup"><span class="hs-identifier hs-type">DocGroup</span></a></span><span> </span><span id="local-6989586621679160767"><span class="annot"><span class="annottext">Entity
</span><a href="#local-6989586621679160767"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679160768"><span class="annot"><span class="annottext">Loc
</span><a href="#local-6989586621679160768"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679160769"><span class="annot"><span class="annottext">[DocTree a]
</span><a href="#local-6989586621679160769"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Entity -&gt; Loc -&gt; [DocTree c] -&gt; Maybe (DocTree c)
forall {a}. Entity -&gt; Loc -&gt; [DocTree a] -&gt; Maybe (DocTree a)
</span><a href="#local-6989586621679160770"><span class="hs-identifier hs-var">mkGroup</span></a></span><span> </span><span class="annot"><span class="annottext">Entity
</span><a href="#local-6989586621679160767"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Loc
</span><a href="#local-6989586621679160768"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">([DocTree c] -&gt; Maybe (DocTree c))
-&gt; (b, [DocTree c]) -&gt; (b, Maybe (DocTree c))
forall (f :: Type -&gt; Type) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Either b c) -&gt; [DocTree a] -&gt; (b, [DocTree c])
forall b a c.
Monoid b =&gt;
(a -&gt; Either b c) -&gt; [DocTree a] -&gt; (b, [DocTree c])
</span><a href="Test.DocTest.Driver.Extract.Ast.html#partitionTreeList"><span class="hs-identifier hs-var">partitionTreeList</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Either b c
</span><a href="#local-6989586621679160763"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[DocTree a]
</span><a href="#local-6989586621679160769"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-394"></span><span>        </span><span id="local-6989586621679160770"><span class="annot"><span class="annottext">mkGroup :: Entity -&gt; Loc -&gt; [DocTree a] -&gt; Maybe (DocTree a)
</span><a href="#local-6989586621679160770"><span class="hs-identifier hs-var hs-var">mkGroup</span></a></span></span><span> </span><span id="local-6989586621679160772"><span class="annot"><span class="annottext">Entity
</span><a href="#local-6989586621679160772"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679160773"><span class="annot"><span class="annottext">Loc
</span><a href="#local-6989586621679160773"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679160774"><span class="annot"><span class="annottext">[DocTree a]
</span><a href="#local-6989586621679160774"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[DocTree a] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: Type -&gt; Type) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[DocTree a]
</span><a href="#local-6989586621679160774"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Maybe (DocTree a)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">DocTree a -&gt; Maybe (DocTree a)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Entity -&gt; Loc -&gt; [DocTree a] -&gt; DocTree a
forall a. Entity -&gt; Loc -&gt; [DocTree a] -&gt; DocTree a
</span><a href="Test.DocTest.Driver.Extract.Ast.html#DocGroup"><span class="hs-identifier hs-var">DocGroup</span></a></span><span> </span><span class="annot"><span class="annottext">Entity
</span><a href="#local-6989586621679160772"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Loc
</span><a href="#local-6989586621679160773"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">[DocTree a]
</span><a href="#local-6989586621679160774"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-395"></span><span>
</span><span id="line-396"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#toDocTree"><span class="hs-identifier hs-type">toDocTree</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GHC.LHsDecl</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">GhcPs</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocTree"><span class="hs-identifier hs-type">DocTree</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#LDoc"><span class="hs-identifier hs-type">LDoc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-397"></span><span id="toDocTree"><span class="annot"><span class="annottext">toDocTree :: LHsDecl GhcPs -&gt; [Doc] -&gt; [DocTree (Either ([Char], LDoc) Doc)]
</span><a href="Test.DocTest.Driver.Extract.Ast.html#toDocTree"><span class="hs-identifier hs-var hs-var">toDocTree</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">L</span></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GHC.DocD</span></span><span> </span><span class="annot"><span class="annottext">XDocD GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679160776"><span class="annot"><span class="annottext">DocDecl GhcPs
</span><a href="#local-6989586621679160776"><span class="hs-identifier hs-var">docD</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679160777"><span class="annot"><span class="annottext">[Doc]
</span><a href="#local-6989586621679160777"><span class="hs-identifier hs-var">docs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; [DocTree (Either ([Char], LDoc) Doc)]
-&gt; [DocTree (Either ([Char], LDoc) Doc)]
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><span class="hs-identifier hs-var hs-var">assert</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Doc] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: Type -&gt; Type) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Doc]
</span><a href="#local-6989586621679160777"><span class="hs-identifier hs-var">docs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">DocDecl GhcPs
</span><a href="#local-6989586621679160776"><span class="hs-identifier hs-var">docD</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-398"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">GHC.DocCommentNamed</span></span><span> </span><span id="local-6989586621679160779"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679160779"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679160780"><span class="annot"><span class="annottext">LDoc
</span><a href="#local-6989586621679160780"><span class="hs-identifier hs-var">doc</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Either ([Char], LDoc) Doc -&gt; DocTree (Either ([Char], LDoc) Doc)
forall a. a -&gt; DocTree a
</span><a href="Test.DocTest.Driver.Extract.Ast.html#DocEntry"><span class="hs-identifier hs-var">DocEntry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([Char], LDoc) -&gt; Either ([Char], LDoc) Doc
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679160779"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LDoc
</span><a href="#local-6989586621679160780"><span class="hs-identifier hs-var">doc</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-399"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">GHC.DocCommentNext</span></span><span> </span><span id="local-6989586621679160782"><span class="annot"><span class="annottext">LDoc
</span><a href="#local-6989586621679160782"><span class="hs-identifier hs-var">doc</span></a></span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Either ([Char], LDoc) Doc -&gt; DocTree (Either ([Char], LDoc) Doc)
forall a. a -&gt; DocTree a
</span><a href="Test.DocTest.Driver.Extract.Ast.html#DocEntry"><span class="hs-identifier hs-var">DocEntry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc -&gt; Either ([Char], LDoc) Doc
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LDoc -&gt; Doc
forall l e. GenLocated l e -&gt; e
</span><span class="hs-identifier hs-var">unLoc</span></span><span> </span><span class="annot"><span class="annottext">LDoc
</span><a href="#local-6989586621679160782"><span class="hs-identifier hs-var">doc</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-400"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">GHC.DocCommentPrev</span></span><span> </span><span id="local-6989586621679160784"><span class="annot"><span class="annottext">LDoc
</span><a href="#local-6989586621679160784"><span class="hs-identifier hs-var">doc</span></a></span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Either ([Char], LDoc) Doc -&gt; DocTree (Either ([Char], LDoc) Doc)
forall a. a -&gt; DocTree a
</span><a href="Test.DocTest.Driver.Extract.Ast.html#DocEntry"><span class="hs-identifier hs-var">DocEntry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc -&gt; Either ([Char], LDoc) Doc
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LDoc -&gt; Doc
forall l e. GenLocated l e -&gt; e
</span><span class="hs-identifier hs-var">unLoc</span></span><span> </span><span class="annot"><span class="annottext">LDoc
</span><a href="#local-6989586621679160784"><span class="hs-identifier hs-var">doc</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-401"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">GHC.DocGroup</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679160786"><span class="annot"><span class="annottext">LDoc
</span><a href="#local-6989586621679160786"><span class="hs-identifier hs-var">doc</span></a></span></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Either ([Char], LDoc) Doc -&gt; DocTree (Either ([Char], LDoc) Doc)
forall a. a -&gt; DocTree a
</span><a href="Test.DocTest.Driver.Extract.Ast.html#DocEntry"><span class="hs-identifier hs-var">DocEntry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc -&gt; Either ([Char], LDoc) Doc
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LDoc -&gt; Doc
forall l e. GenLocated l e -&gt; e
</span><span class="hs-identifier hs-var">unLoc</span></span><span> </span><span class="annot"><span class="annottext">LDoc
</span><a href="#local-6989586621679160786"><span class="hs-identifier hs-var">doc</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-402"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#toDocTree"><span class="hs-identifier hs-var">toDocTree</span></a></span><span> </span><span id="local-6989586621679160787"><span class="annot"><span class="annottext">LHsDecl GhcPs
</span><a href="#local-6989586621679160787"><span class="hs-identifier hs-var">decl</span></a></span></span><span> </span><span id="local-6989586621679160788"><span class="annot"><span class="annottext">[Doc]
</span><a href="#local-6989586621679160788"><span class="hs-identifier hs-var">docs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HsDecl GhcPs -&gt; Maybe Entity
</span><a href="Test.DocTest.Driver.Extract.Ast.html#declEntity"><span class="hs-identifier hs-var">declEntity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsDecl GhcPs) -&gt; HsDecl GhcPs
forall l e. GenLocated l e -&gt; e
</span><span class="hs-identifier hs-var">unLoc</span></span><span> </span><span class="annot"><span class="annottext">LHsDecl GhcPs
GenLocated SrcSpanAnnA (HsDecl GhcPs)
</span><a href="#local-6989586621679160787"><span class="hs-identifier hs-var">decl</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-403"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679160789"><span class="annot"><span class="annottext">Entity
</span><a href="#local-6989586621679160789"><span class="hs-identifier hs-var">entity</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Entity
-&gt; Loc
-&gt; [DocTree (Either ([Char], LDoc) Doc)]
-&gt; DocTree (Either ([Char], LDoc) Doc)
forall a. Entity -&gt; Loc -&gt; [DocTree a] -&gt; DocTree a
</span><a href="Test.DocTest.Driver.Extract.Ast.html#DocGroup"><span class="hs-identifier hs-var">DocGroup</span></a></span><span> </span><span class="annot"><span class="annottext">Entity
</span><a href="#local-6989586621679160789"><span class="hs-identifier hs-var">entity</span></a></span><span> </span><span class="annot"><span class="annottext">Loc
</span><a href="#local-6989586621679160790"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Doc -&gt; DocTree (Either ([Char], LDoc) Doc))
-&gt; [Doc] -&gt; [DocTree (Either ([Char], LDoc) Doc)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Either ([Char], LDoc) Doc -&gt; DocTree (Either ([Char], LDoc) Doc)
forall a. a -&gt; DocTree a
</span><a href="Test.DocTest.Driver.Extract.Ast.html#DocEntry"><span class="hs-identifier hs-var">DocEntry</span></a></span><span> </span><span class="annot"><span class="annottext">(Either ([Char], LDoc) Doc -&gt; DocTree (Either ([Char], LDoc) Doc))
-&gt; (Doc -&gt; Either ([Char], LDoc) Doc)
-&gt; Doc
-&gt; DocTree (Either ([Char], LDoc) Doc)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Either ([Char], LDoc) Doc
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Doc]
</span><a href="#local-6989586621679160791"><span class="hs-identifier hs-var">allDocs</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-404"></span><span>  </span><span class="annot"><span class="annottext">Maybe Entity
</span><span class="hs-identifier hs-var">Nothing</span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; DocTree (Either ([Char], LDoc) Doc))
-&gt; [Doc] -&gt; [DocTree (Either ([Char], LDoc) Doc)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Either ([Char], LDoc) Doc -&gt; DocTree (Either ([Char], LDoc) Doc)
forall a. a -&gt; DocTree a
</span><a href="Test.DocTest.Driver.Extract.Ast.html#DocEntry"><span class="hs-identifier hs-var">DocEntry</span></a></span><span> </span><span class="annot"><span class="annottext">(Either ([Char], LDoc) Doc -&gt; DocTree (Either ([Char], LDoc) Doc))
-&gt; (Doc -&gt; Either ([Char], LDoc) Doc)
-&gt; Doc
-&gt; DocTree (Either ([Char], LDoc) Doc)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Either ([Char], LDoc) Doc
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Doc]
</span><a href="#local-6989586621679160791"><span class="hs-identifier hs-var">allDocs</span></a></span><span>
</span><span id="line-405"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679160790"><span class="annot"><span class="annottext">loc :: Loc
</span><a href="#local-6989586621679160790"><span class="hs-identifier hs-var hs-var">loc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SrcLoc -&gt; Loc
</span><a href="Test.DocTest.Driver.Extract.Ast.html#toLoc"><span class="hs-identifier hs-var">toLoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpan -&gt; SrcLoc
</span><span class="hs-identifier hs-var">GHC.srcSpanStart</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsDecl GhcPs) -&gt; SrcSpan
forall a e. GenLocated (SrcSpanAnn' a) e -&gt; SrcSpan
</span><span class="hs-identifier hs-var">getLocA</span></span><span> </span><span class="annot"><span class="annottext">LHsDecl GhcPs
GenLocated SrcSpanAnnA (HsDecl GhcPs)
</span><a href="#local-6989586621679160787"><span class="hs-identifier hs-var">decl</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-406"></span><span>        </span><span id="local-6989586621679160791"><span class="annot"><span class="annottext">allDocs :: [Doc]
</span><a href="#local-6989586621679160791"><span class="hs-identifier hs-var hs-var">allDocs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Doc] -&gt; [Doc] -&gt; [Doc]) -&gt; GenericQ [Doc] -&gt; GenericQ [Doc]
forall r. (r -&gt; r -&gt; r) -&gt; GenericQ r -&gt; GenericQ r
</span><span class="hs-identifier hs-var">everything</span></span><span> </span><span class="annot"><span class="annottext">[Doc] -&gt; [Doc] -&gt; [Doc]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">(++)</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Doc] -&gt; (Doc -&gt; [Doc]) -&gt; a -&gt; [Doc]
forall a b r. (Typeable a, Typeable b) =&gt; r -&gt; (b -&gt; r) -&gt; a -&gt; r
</span><span class="hs-identifier hs-var">mkQ</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; [Doc]
forall a. a -&gt; [a]
forall (f :: Type -&gt; Type) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LHsDecl GhcPs
GenLocated SrcSpanAnnA (HsDecl GhcPs)
</span><a href="#local-6989586621679160787"><span class="hs-identifier hs-var">decl</span></a></span><span> </span><span class="annot"><span class="annottext">[Doc] -&gt; [Doc] -&gt; [Doc]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Doc]
</span><a href="#local-6989586621679160788"><span class="hs-identifier hs-var">docs</span></a></span><span>
</span><span id="line-407"></span><span>
</span><span id="line-408"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#finaliseDocTree"><span class="hs-identifier hs-type">finaliseDocTree</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocTree"><span class="hs-identifier hs-type">DocTree</span></a></span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocTests"><span class="hs-identifier hs-type">DocTests</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocTests"><span class="hs-identifier hs-type">DocTests</span></a></span><span>
</span><span id="line-409"></span><span id="finaliseDocTree"><span class="annot"><span class="annottext">finaliseDocTree :: DocTree DocTests -&gt; DocTests
</span><a href="Test.DocTest.Driver.Extract.Ast.html#finaliseDocTree"><span class="hs-identifier hs-var hs-var">finaliseDocTree</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocEntry"><span class="hs-identifier hs-type">DocEntry</span></a></span><span> </span><span id="local-6989586621679160803"><span class="annot"><span class="annottext">DocTests
</span><a href="#local-6989586621679160803"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DocTests
</span><a href="#local-6989586621679160803"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-410"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#finaliseDocTree"><span class="hs-identifier hs-var">finaliseDocTree</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocGroup"><span class="hs-identifier hs-type">DocGroup</span></a></span><span> </span><span id="local-6989586621679160804"><span class="annot"><span class="annottext">Entity
</span><a href="#local-6989586621679160804"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679160805"><span class="annot"><span class="annottext">Loc
</span><a href="#local-6989586621679160805"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679160806"><span class="annot"><span class="annottext">[DocTree DocTests]
</span><a href="#local-6989586621679160806"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Entity -&gt; Loc -&gt; [DocTests] -&gt; DocTests
</span><a href="Test.DocTest.Driver.Extract.Ast.html#Group"><span class="hs-identifier hs-var">Group</span></a></span><span> </span><span class="annot"><span class="annottext">Entity
</span><a href="#local-6989586621679160804"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Loc
</span><a href="#local-6989586621679160805"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DocTree DocTests -&gt; DocTests) -&gt; [DocTree DocTests] -&gt; [DocTests]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">DocTree DocTests -&gt; DocTests
</span><a href="Test.DocTest.Driver.Extract.Ast.html#finaliseDocTree"><span class="hs-identifier hs-var">finaliseDocTree</span></a></span><span> </span><span class="annot"><span class="annottext">[DocTree DocTests]
</span><a href="#local-6989586621679160806"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-411"></span><span>
</span><span id="line-412"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#resolveScopes"><span class="hs-identifier hs-type">resolveScopes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocTests"><span class="hs-identifier hs-type">DocTests</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocTests"><span class="hs-identifier hs-type">DocTests</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-413"></span><span id="resolveScopes"><span class="annot"><span class="annottext">resolveScopes :: [DocTests] -&gt; [DocTests]
</span><a href="Test.DocTest.Driver.Extract.Ast.html#resolveScopes"><span class="hs-identifier hs-var hs-var">resolveScopes</span></a></span></span><span> </span><span id="local-6989586621679160807"><span class="annot"><span class="annottext">[DocTests]
</span><a href="#local-6989586621679160807"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(([DocTests] -&gt; [DocTests]) -&gt; [DocTests] -&gt; [DocTests])
-&gt; [DocTests] -&gt; [[DocTests] -&gt; [DocTests]] -&gt; [DocTests]
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: Type -&gt; Type) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">([DocTests] -&gt; [DocTests]) -&gt; [DocTests] -&gt; [DocTests]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">($)</span></span><span> </span><span class="annot"><span class="annottext">[DocTests]
</span><a href="#local-6989586621679160808"><span class="hs-identifier hs-var">tests</span></a></span><span> </span><span class="annot"><span class="annottext">[[DocTests] -&gt; [DocTests]]
</span><a href="#local-6989586621679160809"><span class="hs-identifier hs-var">scopes</span></a></span><span>
</span><span id="line-414"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679160809"><span class="annot"><span class="annottext">[[DocTests] -&gt; [DocTests]]
</span><a href="#local-6989586621679160809"><span class="hs-identifier hs-var">scopes</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679160808"><span class="annot"><span class="annottext">[DocTests]
</span><a href="#local-6989586621679160808"><span class="hs-identifier hs-var">tests</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Either ([DocTests] -&gt; [DocTests]) DocTests]
-&gt; ([[DocTests] -&gt; [DocTests]], [DocTests])
forall a b. [Either a b] -&gt; ([a], [b])
</span><span class="hs-identifier hs-var">partitionEithers</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DocTests -&gt; Either ([DocTests] -&gt; [DocTests]) DocTests)
-&gt; [DocTests] -&gt; [Either ([DocTests] -&gt; [DocTests]) DocTests]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">DocTests -&gt; Either ([DocTests] -&gt; [DocTests]) DocTests
</span><a href="Test.DocTest.Driver.Extract.Ast.html#resolveScope"><span class="hs-identifier hs-var">resolveScope</span></a></span><span> </span><span class="annot"><span class="annottext">[DocTests]
</span><a href="#local-6989586621679160807"><span class="hs-identifier hs-var">ts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-415"></span><span>
</span><span id="line-416"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#resolveScope"><span class="hs-identifier hs-type">resolveScope</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocTests"><span class="hs-identifier hs-type">DocTests</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocTests"><span class="hs-identifier hs-type">DocTests</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocTests"><span class="hs-identifier hs-type">DocTests</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocTests"><span class="hs-identifier hs-type">DocTests</span></a></span><span>
</span><span id="line-417"></span><span id="resolveScope"><span class="annot"><span class="annottext">resolveScope :: DocTests -&gt; Either ([DocTests] -&gt; [DocTests]) DocTests
</span><a href="Test.DocTest.Driver.Extract.Ast.html#resolveScope"><span class="hs-identifier hs-var hs-var">resolveScope</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Group"><span class="hs-identifier hs-type">Group</span></a></span><span> </span><span id="local-6989586621679160811"><span class="annot"><span class="annottext">Entity
</span><a href="#local-6989586621679160811"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679160812"><span class="annot"><span class="annottext">Loc
</span><a href="#local-6989586621679160812"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621679160813"><span class="annot"><span class="annottext">[DocTests]
</span><a href="#local-6989586621679160813"><span class="hs-identifier hs-var">tests</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DocTests -&gt; Either ([DocTests] -&gt; [DocTests]) DocTests
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Entity -&gt; Loc -&gt; [DocTests] -&gt; DocTests
</span><a href="Test.DocTest.Driver.Extract.Ast.html#Group"><span class="hs-identifier hs-var">Group</span></a></span><span> </span><span class="annot"><span class="annottext">Entity
</span><a href="#local-6989586621679160811"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Loc
</span><a href="#local-6989586621679160812"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[DocTests] -&gt; [DocTests]
</span><a href="Test.DocTest.Driver.Extract.Ast.html#resolveScopes"><span class="hs-identifier hs-var">resolveScopes</span></a></span><span> </span><span class="annot"><span class="annottext">[DocTests]
</span><a href="#local-6989586621679160813"><span class="hs-identifier hs-var">tests</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-418"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#resolveScope"><span class="hs-identifier hs-var">resolveScope</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#TestHook"><span class="hs-identifier hs-type">TestHook</span></a></span><span> </span><span id="local-6989586621679160814"><span class="annot"><span class="annottext">IOHook
</span><a href="#local-6989586621679160814"><span class="hs-identifier hs-var">hook</span></a></span></span><span> </span><span id="local-6989586621679160815"><span class="annot"><span class="annottext">[DocTests]
</span><a href="#local-6989586621679160815"><span class="hs-identifier hs-var">tests</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; Either ([DocTests] -&gt; [DocTests]) DocTests
-&gt; Either ([DocTests] -&gt; [DocTests]) DocTests
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><span class="hs-identifier hs-var hs-var">assert</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[DocTests] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: Type -&gt; Type) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[DocTests]
</span><a href="#local-6989586621679160815"><span class="hs-identifier hs-var">tests</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([DocTests] -&gt; [DocTests])
-&gt; Either ([DocTests] -&gt; [DocTests]) DocTests
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DocTests -&gt; [DocTests]
forall a. a -&gt; [a]
forall (f :: Type -&gt; Type) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(DocTests -&gt; [DocTests])
-&gt; ([DocTests] -&gt; DocTests) -&gt; [DocTests] -&gt; [DocTests]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IOHook -&gt; [DocTests] -&gt; DocTests
</span><a href="Test.DocTest.Driver.Extract.Ast.html#TestHook"><span class="hs-identifier hs-var">TestHook</span></a></span><span> </span><span class="annot"><span class="annottext">IOHook
</span><a href="#local-6989586621679160814"><span class="hs-identifier hs-var">hook</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-419"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#resolveScope"><span class="hs-identifier hs-var">resolveScope</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Capture"><span class="hs-identifier hs-type">Capture</span></a></span><span> </span><span id="local-6989586621679160816"><span class="annot"><span class="annottext">CapturedContent
</span><a href="#local-6989586621679160816"><span class="hs-identifier hs-var">content</span></a></span></span><span> </span><span id="local-6989586621679160817"><span class="annot"><span class="annottext">[DocTests]
</span><a href="#local-6989586621679160817"><span class="hs-identifier hs-var">tests</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; Either ([DocTests] -&gt; [DocTests]) DocTests
-&gt; Either ([DocTests] -&gt; [DocTests]) DocTests
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><span class="hs-identifier hs-var hs-var">assert</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[DocTests] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: Type -&gt; Type) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[DocTests]
</span><a href="#local-6989586621679160817"><span class="hs-identifier hs-var">tests</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([DocTests] -&gt; [DocTests])
-&gt; Either ([DocTests] -&gt; [DocTests]) DocTests
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DocTests -&gt; [DocTests]
forall a. a -&gt; [a]
forall (f :: Type -&gt; Type) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(DocTests -&gt; [DocTests])
-&gt; ([DocTests] -&gt; DocTests) -&gt; [DocTests] -&gt; [DocTests]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CapturedContent -&gt; [DocTests] -&gt; DocTests
</span><a href="Test.DocTest.Driver.Extract.Ast.html#Capture"><span class="hs-identifier hs-var">Capture</span></a></span><span> </span><span class="annot"><span class="annottext">CapturedContent
</span><a href="#local-6989586621679160816"><span class="hs-identifier hs-var">content</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-420"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#resolveScope"><span class="hs-identifier hs-var">resolveScope</span></a></span><span> </span><span id="local-6989586621679160818"><span class="annot"><span class="annottext">t :: DocTests
</span><a href="#local-6989586621679160818"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#TestExample"><span class="hs-identifier hs-type">TestExample</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty ExampleLine
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DocTests -&gt; Either ([DocTests] -&gt; [DocTests]) DocTests
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">DocTests
</span><a href="#local-6989586621679160818"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-421"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#resolveScope"><span class="hs-identifier hs-var">resolveScope</span></a></span><span> </span><span id="local-6989586621679160819"><span class="annot"><span class="annottext">t :: DocTests
</span><a href="#local-6989586621679160819"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#TestProperty"><span class="hs-identifier hs-type">TestProperty</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty DocLine
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DocTests -&gt; Either ([DocTests] -&gt; [DocTests]) DocTests
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">DocTests
</span><a href="#local-6989586621679160819"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-422"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#resolveScope"><span class="hs-identifier hs-var">resolveScope</span></a></span><span> </span><span id="local-6989586621679160820"><span class="annot"><span class="annottext">t :: DocTests
</span><a href="#local-6989586621679160820"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#TestMultiline"><span class="hs-identifier hs-type">TestMultiline</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty DocLine
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DocTests -&gt; Either ([DocTests] -&gt; [DocTests]) DocTests
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">DocTests
</span><a href="#local-6989586621679160820"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-423"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#resolveScope"><span class="hs-identifier hs-var">resolveScope</span></a></span><span> </span><span id="local-6989586621679160821"><span class="annot"><span class="annottext">t :: DocTests
</span><a href="#local-6989586621679160821"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Warning"><span class="hs-identifier hs-type">Warning</span></a></span><span> </span><span class="annot"><span class="annottext">Loc
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DocTests -&gt; Either ([DocTests] -&gt; [DocTests]) DocTests
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">DocTests
</span><a href="#local-6989586621679160821"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-424"></span><span>
</span><span id="line-425"></span><span class="hs-keyword">data</span><span> </span><span id="Instruction"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Instruction"><span class="hs-identifier hs-var">Instruction</span></a></span></span><span>
</span><span id="line-426"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="SetupImport"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#SetupImport"><span class="hs-identifier hs-var">SetupImport</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-427"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="SetupOther"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#SetupOther"><span class="hs-identifier hs-var">SetupOther</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-428"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="SetupAuto"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#SetupAuto"><span class="hs-identifier hs-var">SetupAuto</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-429"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="UseHook"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#UseHook"><span class="hs-identifier hs-var">UseHook</span></a></span></span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#HookFlavour"><span class="hs-identifier hs-type">HookFlavour</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span>
</span><span id="line-430"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="IsExample"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#IsExample"><span class="hs-identifier hs-var">IsExample</span></a></span></span><span>
</span><span id="line-431"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="IsProperty"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#IsProperty"><span class="hs-identifier hs-var">IsProperty</span></a></span></span><span>
</span><span id="line-432"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="CaptureText"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#CaptureText"><span class="hs-identifier hs-var">CaptureText</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#CaptureMethod"><span class="hs-identifier hs-type">CaptureMethod</span></a></span><span>
</span><span id="line-433"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span id="local-6989586621679160830"><span id="local-6989586621679160839"><span class="annot"><span class="annottext">Instruction -&gt; Instruction -&gt; Bool
(Instruction -&gt; Instruction -&gt; Bool)
-&gt; (Instruction -&gt; Instruction -&gt; Bool) -&gt; Eq Instruction
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: Instruction -&gt; Instruction -&gt; Bool
== :: Instruction -&gt; Instruction -&gt; Bool
$c/= :: Instruction -&gt; Instruction -&gt; Bool
/= :: Instruction -&gt; Instruction -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span>
</span><span id="line-434"></span><span>
</span><span id="line-435"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#mkParen"><span class="hs-identifier hs-type">mkParen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-436"></span><span id="mkParen"><span class="annot"><span class="annottext">mkParen :: ShowS
</span><a href="Test.DocTest.Driver.Extract.Ast.html#mkParen"><span class="hs-identifier hs-var hs-var">mkParen</span></a></span></span><span> </span><span id="local-6989586621679160843"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679160843"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: Type -&gt; Type) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679160843"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679160843"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;(&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679160843"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-437"></span><span>
</span><span id="line-438"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679160845"><span id="local-6989586621679160849"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Instruction"><span class="hs-identifier hs-type">Instruction</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-439"></span><span>  </span><span id="local-6989586621679160861"><span class="annot"><span class="annottext">show :: Instruction -&gt; [Char]
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#SetupImport"><span class="hs-identifier hs-type">SetupImport</span></a></span><span> </span><span id="local-6989586621679160862"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679160862"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;setup-import&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ShowS
</span><a href="Test.DocTest.Driver.Extract.Ast.html#mkParen"><span class="hs-identifier hs-var">mkParen</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679160862"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-440"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#SetupOther"><span class="hs-identifier hs-type">SetupOther</span></a></span><span> </span><span id="local-6989586621679160863"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679160863"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;setup-top&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ShowS
</span><a href="Test.DocTest.Driver.Extract.Ast.html#mkParen"><span class="hs-identifier hs-var">mkParen</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679160863"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-441"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#SetupAuto"><span class="hs-identifier hs-type">SetupAuto</span></a></span><span> </span><span id="local-6989586621679160864"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679160864"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;setup&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ShowS
</span><a href="Test.DocTest.Driver.Extract.Ast.html#mkParen"><span class="hs-identifier hs-var">mkParen</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679160864"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-442"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#UseHook"><span class="hs-identifier hs-type">UseHook</span></a></span><span> </span><span id="local-6989586621679160865"><span class="annot"><span class="annottext">HookFlavour
</span><a href="#local-6989586621679160865"><span class="hs-identifier hs-var">flavour</span></a></span></span><span> </span><span id="local-6989586621679160866"><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621679160866"><span class="hs-identifier hs-var">vars</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HookFlavour -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">HookFlavour
</span><a href="#local-6989586621679160865"><span class="hs-identifier hs-var">flavour</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ShowS
</span><a href="Test.DocTest.Driver.Extract.Ast.html#mkParen"><span class="hs-identifier hs-var">mkParen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; [[Char]] -&gt; [Char]
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">List.intercalate</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;, &quot;</span></span><span> </span><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621679160866"><span class="hs-identifier hs-var">vars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-443"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Instruction
</span><a href="Test.DocTest.Driver.Extract.Ast.html#IsExample"><span class="hs-identifier hs-var">IsExample</span></a></span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;test&quot;</span></span><span>
</span><span id="line-444"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Instruction
</span><a href="Test.DocTest.Driver.Extract.Ast.html#IsProperty"><span class="hs-identifier hs-var">IsProperty</span></a></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;property&quot;</span></span><span>
</span><span id="line-445"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#CaptureText"><span class="hs-identifier hs-type">CaptureText</span></a></span><span> </span><span id="local-6989586621679160867"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679160867"><span class="hs-identifier hs-var">var</span></a></span></span><span> </span><span id="local-6989586621679160868"><span class="annot"><span class="annottext">CaptureMethod
</span><a href="#local-6989586621679160868"><span class="hs-identifier hs-var">method</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;capture(&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679160867"><span class="hs-identifier hs-var">var</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; :: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">CaptureMethod -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">CaptureMethod
</span><a href="#local-6989586621679160868"><span class="hs-identifier hs-var">method</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-446"></span><span>
</span><span id="line-447"></span><span id="local-6989586621679159552"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#lexeme"><span class="hs-identifier hs-type">lexeme</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">R.ReadP</span></span><span> </span><span class="annot"><a href="#local-6989586621679159552"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">R.ReadP</span></span><span> </span><span class="annot"><a href="#local-6989586621679159552"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-448"></span><span id="lexeme"><span class="annot"><span class="annottext">lexeme :: forall a. ReadP a -&gt; ReadP a
</span><a href="Test.DocTest.Driver.Extract.Ast.html#lexeme"><span class="hs-identifier hs-var hs-var">lexeme</span></a></span></span><span> </span><span id="local-6989586621679160871"><span class="annot"><span class="annottext">ReadP a
</span><a href="#local-6989586621679160871"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReadP a
</span><a href="#local-6989586621679160871"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">ReadP a -&gt; ReadP () -&gt; ReadP a
forall a b. ReadP a -&gt; ReadP b -&gt; ReadP a
forall (f :: Type -&gt; Type) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">ReadP ()
</span><span class="hs-identifier hs-var">R.skipSpaces</span></span><span>
</span><span id="line-449"></span><span>
</span><span id="line-450"></span><span id="local-6989586621679160874"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#paren"><span class="hs-identifier hs-type">paren</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">R.ReadP</span></span><span> </span><span class="annot"><a href="#local-6989586621679160874"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">R.ReadP</span></span><span> </span><span class="annot"><a href="#local-6989586621679160874"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-451"></span><span id="paren"><span class="annot"><span class="annottext">paren :: forall a. ReadP a -&gt; ReadP a
</span><a href="Test.DocTest.Driver.Extract.Ast.html#paren"><span class="hs-identifier hs-var hs-var">paren</span></a></span></span><span> </span><span id="local-6989586621679160878"><span class="annot"><span class="annottext">ReadP a
</span><a href="#local-6989586621679160878"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReadP Char -&gt; ReadP Char
forall a. ReadP a -&gt; ReadP a
</span><a href="Test.DocTest.Driver.Extract.Ast.html#lexeme"><span class="hs-identifier hs-var">lexeme</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; ReadP Char
</span><span class="hs-identifier hs-var">R.char</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'('</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ReadP Char -&gt; ReadP a -&gt; ReadP a
forall a b. ReadP a -&gt; ReadP b -&gt; ReadP b
forall (f :: Type -&gt; Type) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ReadP a
</span><a href="#local-6989586621679160878"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">ReadP a -&gt; ReadP Char -&gt; ReadP a
forall a b. ReadP a -&gt; ReadP b -&gt; ReadP a
forall (f :: Type -&gt; Type) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">ReadP Char -&gt; ReadP Char
forall a. ReadP a -&gt; ReadP a
</span><a href="Test.DocTest.Driver.Extract.Ast.html#lexeme"><span class="hs-identifier hs-var">lexeme</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; ReadP Char
</span><span class="hs-identifier hs-var">R.char</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">')'</span></span><span class="hs-special">)</span><span>
</span><span id="line-452"></span><span>
</span><span id="line-453"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">R.ReadP</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-454"></span><span id="text"><span class="annot"><span class="annottext">text :: [Char] -&gt; ReadP ()
</span><a href="Test.DocTest.Driver.Extract.Ast.html#text"><span class="hs-identifier hs-var hs-var">text</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReadP [Char] -&gt; ReadP ()
forall (f :: Type -&gt; Type) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(ReadP [Char] -&gt; ReadP ())
-&gt; ([Char] -&gt; ReadP [Char]) -&gt; [Char] -&gt; ReadP ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ReadP [Char] -&gt; ReadP [Char]
forall a. ReadP a -&gt; ReadP a
</span><a href="Test.DocTest.Driver.Extract.Ast.html#lexeme"><span class="hs-identifier hs-var">lexeme</span></a></span><span> </span><span class="annot"><span class="annottext">(ReadP [Char] -&gt; ReadP [Char])
-&gt; ([Char] -&gt; ReadP [Char]) -&gt; [Char] -&gt; ReadP [Char]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ReadP [Char]
</span><span class="hs-identifier hs-var">R.string</span></span><span>
</span><span id="line-455"></span><span>
</span><span id="line-456"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#anything"><span class="hs-identifier hs-type">anything</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">R.ReadP</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-457"></span><span id="anything"><span class="annot"><span class="annottext">anything :: ReadP [Char]
</span><a href="Test.DocTest.Driver.Extract.Ast.html#anything"><span class="hs-identifier hs-var hs-var">anything</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Char], ()) -&gt; [Char]
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">(([Char], ()) -&gt; [Char]) -&gt; ReadP ([Char], ()) -&gt; ReadP [Char]
forall (f :: Type -&gt; Type) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ReadP () -&gt; ReadP ([Char], ())
forall a. ReadP a -&gt; ReadP ([Char], a)
</span><span class="hs-identifier hs-var">R.gather</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ReadP [Char] -&gt; ReadP ()
forall a. ReadP a -&gt; ReadP ()
</span><span class="hs-identifier hs-var">R.skipMany</span></span><span> </span><span class="annot"><span class="annottext">ReadP [Char]
</span><a href="#local-6989586621679160885"><span class="hs-identifier hs-var">paired</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-458"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679160888"><span class="annot"><span class="annottext">normal :: ReadP [Char]
</span><a href="#local-6989586621679160888"><span class="hs-identifier hs-var hs-var">normal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; ReadP [Char]
</span><span class="hs-identifier hs-var">R.munch1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; [Char] -&gt; Bool
forall (t :: Type -&gt; Type) a.
(Foldable t, Eq a) =&gt;
a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`notElem`</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;()&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-459"></span><span>        </span><span id="local-6989586621679160885"><span class="annot"><span class="annottext">paired :: ReadP [Char]
</span><a href="#local-6989586621679160885"><span class="hs-identifier hs-var hs-var">paired</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReadP [Char]
</span><a href="#local-6989586621679160888"><span class="hs-identifier hs-var">normal</span></a></span><span> </span><span class="annot"><span class="annottext">ReadP [Char] -&gt; ReadP [Char] -&gt; ReadP [Char]
forall a. ReadP a -&gt; ReadP a -&gt; ReadP a
forall (f :: Type -&gt; Type) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; ReadP Char
</span><span class="hs-identifier hs-var">R.char</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'('</span></span><span> </span><span class="annot"><span class="annottext">ReadP Char -&gt; ReadP [Char] -&gt; ReadP [Char]
forall a b. ReadP a -&gt; ReadP b -&gt; ReadP b
forall (f :: Type -&gt; Type) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ReadP [Char]
</span><a href="#local-6989586621679160885"><span class="hs-identifier hs-var">paired</span></a></span><span> </span><span class="annot"><span class="annottext">ReadP [Char] -&gt; ReadP Char -&gt; ReadP [Char]
forall a b. ReadP a -&gt; ReadP b -&gt; ReadP a
forall (f :: Type -&gt; Type) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; ReadP Char
</span><span class="hs-identifier hs-var">R.char</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">')'</span></span><span>
</span><span id="line-460"></span><span>
</span><span id="line-461"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#ident"><span class="hs-identifier hs-type">ident</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">R.ReadP</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-462"></span><span id="ident"><span class="annot"><span class="annottext">ident :: ReadP [Char]
</span><a href="Test.DocTest.Driver.Extract.Ast.html#ident"><span class="hs-identifier hs-var hs-var">ident</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span>
</span><span id="line-463"></span><span>  </span><span class="annot"><span class="annottext">(Char -&gt; ShowS) -&gt; ReadP Char -&gt; ReadP ShowS
forall (f :: Type -&gt; Type) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; ReadP Char
</span><span class="hs-identifier hs-var">R.satisfy</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679160896"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679160896"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isLower</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679160896"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679160896"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'_'</span></span><span class="hs-special">)</span><span>
</span><span id="line-464"></span><span>  </span><span class="annot"><span class="annottext">ReadP ShowS -&gt; ReadP [Char] -&gt; ReadP [Char]
forall a b. ReadP (a -&gt; b) -&gt; ReadP a -&gt; ReadP b
forall (f :: Type -&gt; Type) a b.
Applicative f =&gt;
f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; ReadP [Char]
</span><span class="hs-identifier hs-var">R.munch</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679160899"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679160899"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isAlphaNum</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679160899"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679160899"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'_'</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679160899"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\''</span></span><span class="hs-special">)</span><span>
</span><span id="line-465"></span><span>
</span><span id="line-466"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#pInstruction"><span class="hs-identifier hs-type">pInstruction</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">R.ReadP</span></span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Instruction"><span class="hs-identifier hs-type">Instruction</span></a></span><span>
</span><span id="line-467"></span><span id="pInstruction"><span class="annot"><span class="annottext">pInstruction :: ReadP Instruction
</span><a href="Test.DocTest.Driver.Extract.Ast.html#pInstruction"><span class="hs-identifier hs-var hs-var">pInstruction</span></a></span></span><span>
</span><span id="line-468"></span><span>  </span><span class="hs-glyph">=</span><span>   </span><span class="annot"><span class="annottext">ReadP ([Char] -&gt; Instruction)
</span><a href="Test.DocTest.Driver.Extract.Ast.html#pSetup"><span class="hs-identifier hs-var">pSetup</span></a></span><span> </span><span class="annot"><span class="annottext">ReadP ([Char] -&gt; Instruction) -&gt; ReadP [Char] -&gt; ReadP Instruction
forall a b. ReadP (a -&gt; b) -&gt; ReadP a -&gt; ReadP b
forall (f :: Type -&gt; Type) a b.
Applicative f =&gt;
f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ReadP [Char] -&gt; ReadP [Char]
forall a. a -&gt; ReadP a -&gt; ReadP a
</span><span class="hs-identifier hs-var">R.option</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ReadP [Char] -&gt; ReadP [Char]
forall a. ReadP a -&gt; ReadP a
</span><a href="Test.DocTest.Driver.Extract.Ast.html#paren"><span class="hs-identifier hs-var">paren</span></a></span><span> </span><span class="annot"><span class="annottext">ReadP [Char]
</span><a href="Test.DocTest.Driver.Extract.Ast.html#anything"><span class="hs-identifier hs-var">anything</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-469"></span><span>  </span><span class="annot"><span class="annottext">ReadP Instruction -&gt; ReadP Instruction -&gt; ReadP Instruction
forall a. ReadP a -&gt; ReadP a -&gt; ReadP a
forall (f :: Type -&gt; Type) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">ReadP ([[Char]] -&gt; Instruction)
</span><a href="Test.DocTest.Driver.Extract.Ast.html#pBeforeAfterHook"><span class="hs-identifier hs-var">pBeforeAfterHook</span></a></span><span> </span><span class="annot"><span class="annottext">ReadP ([[Char]] -&gt; Instruction)
-&gt; ReadP [[Char]] -&gt; ReadP Instruction
forall a b. ReadP (a -&gt; b) -&gt; ReadP a -&gt; ReadP b
forall (f :: Type -&gt; Type) a b.
Applicative f =&gt;
f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">[[Char]] -&gt; ReadP [[Char]] -&gt; ReadP [[Char]]
forall a. a -&gt; ReadP a -&gt; ReadP a
</span><span class="hs-identifier hs-var">R.option</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ReadP [[Char]] -&gt; ReadP [[Char]]
forall a. ReadP a -&gt; ReadP a
</span><a href="Test.DocTest.Driver.Extract.Ast.html#paren"><span class="hs-identifier hs-var">paren</span></a></span><span> </span><span class="annot"><span class="annottext">ReadP [[Char]]
</span><a href="Test.DocTest.Driver.Extract.Ast.html#pArgs"><span class="hs-identifier hs-var">pArgs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-470"></span><span>  </span><span class="annot"><span class="annottext">ReadP Instruction -&gt; ReadP Instruction -&gt; ReadP Instruction
forall a. ReadP a -&gt; ReadP a -&gt; ReadP a
forall (f :: Type -&gt; Type) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">ReadP ([[Char]] -&gt; Instruction)
</span><a href="Test.DocTest.Driver.Extract.Ast.html#pAroundHook"><span class="hs-identifier hs-var">pAroundHook</span></a></span><span> </span><span class="annot"><span class="annottext">ReadP ([[Char]] -&gt; Instruction)
-&gt; ReadP [[Char]] -&gt; ReadP Instruction
forall a b. ReadP (a -&gt; b) -&gt; ReadP a -&gt; ReadP b
forall (f :: Type -&gt; Type) a b.
Applicative f =&gt;
f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">[[Char]] -&gt; ReadP [[Char]] -&gt; ReadP [[Char]]
forall a. a -&gt; ReadP a -&gt; ReadP a
</span><span class="hs-identifier hs-var">R.option</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ReadP [[Char]] -&gt; ReadP [[Char]]
forall a. ReadP a -&gt; ReadP a
</span><a href="Test.DocTest.Driver.Extract.Ast.html#paren"><span class="hs-identifier hs-var">paren</span></a></span><span> </span><span class="annot"><span class="annottext">ReadP [[Char]]
</span><a href="Test.DocTest.Driver.Extract.Ast.html#pAroundArgs"><span class="hs-identifier hs-var">pAroundArgs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-471"></span><span>  </span><span class="annot"><span class="annottext">ReadP Instruction -&gt; ReadP Instruction -&gt; ReadP Instruction
forall a. ReadP a -&gt; ReadP a -&gt; ReadP a
forall (f :: Type -&gt; Type) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ReadP ()
</span><a href="Test.DocTest.Driver.Extract.Ast.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;test&quot;</span></span><span> </span><span class="annot"><span class="annottext">ReadP () -&gt; Instruction -&gt; ReadP Instruction
forall (f :: Type -&gt; Type) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><span class="hs-operator hs-var">$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Instruction
</span><a href="Test.DocTest.Driver.Extract.Ast.html#IsExample"><span class="hs-identifier hs-var">IsExample</span></a></span><span>
</span><span id="line-472"></span><span>  </span><span class="annot"><span class="annottext">ReadP Instruction -&gt; ReadP Instruction -&gt; ReadP Instruction
forall a. ReadP a -&gt; ReadP a -&gt; ReadP a
forall (f :: Type -&gt; Type) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ReadP ()
</span><a href="Test.DocTest.Driver.Extract.Ast.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;property&quot;</span></span><span> </span><span class="annot"><span class="annottext">ReadP () -&gt; Instruction -&gt; ReadP Instruction
forall (f :: Type -&gt; Type) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><span class="hs-operator hs-var">$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Instruction
</span><a href="Test.DocTest.Driver.Extract.Ast.html#IsProperty"><span class="hs-identifier hs-var">IsProperty</span></a></span><span>
</span><span id="line-473"></span><span>  </span><span class="annot"><span class="annottext">ReadP Instruction -&gt; ReadP Instruction -&gt; ReadP Instruction
forall a. ReadP a -&gt; ReadP a -&gt; ReadP a
forall (f :: Type -&gt; Type) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ReadP ()
</span><a href="Test.DocTest.Driver.Extract.Ast.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;capture&quot;</span></span><span> </span><span class="annot"><span class="annottext">ReadP () -&gt; ReadP Instruction -&gt; ReadP Instruction
forall a b. ReadP a -&gt; ReadP b -&gt; ReadP b
forall (f :: Type -&gt; Type) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ReadP Instruction -&gt; ReadP Instruction
forall a. ReadP a -&gt; ReadP a
</span><a href="Test.DocTest.Driver.Extract.Ast.html#paren"><span class="hs-identifier hs-var">paren</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; CaptureMethod -&gt; Instruction
</span><a href="Test.DocTest.Driver.Extract.Ast.html#CaptureText"><span class="hs-identifier hs-var">CaptureText</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; CaptureMethod -&gt; Instruction)
-&gt; ReadP [Char] -&gt; ReadP (CaptureMethod -&gt; Instruction)
forall (f :: Type -&gt; Type) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ReadP [Char] -&gt; ReadP [Char]
forall a. ReadP a -&gt; ReadP a
</span><a href="Test.DocTest.Driver.Extract.Ast.html#lexeme"><span class="hs-identifier hs-var">lexeme</span></a></span><span> </span><span class="annot"><span class="annottext">ReadP [Char]
</span><a href="Test.DocTest.Driver.Extract.Ast.html#ident"><span class="hs-identifier hs-var">ident</span></a></span><span> </span><span class="annot"><span class="annottext">ReadP (CaptureMethod -&gt; Instruction)
-&gt; ReadP () -&gt; ReadP (CaptureMethod -&gt; Instruction)
forall a b. ReadP a -&gt; ReadP b -&gt; ReadP a
forall (f :: Type -&gt; Type) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ReadP ()
</span><a href="Test.DocTest.Driver.Extract.Ast.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;::&quot;</span></span><span> </span><span class="annot"><span class="annottext">ReadP (CaptureMethod -&gt; Instruction)
-&gt; ReadP CaptureMethod -&gt; ReadP Instruction
forall a b. ReadP (a -&gt; b) -&gt; ReadP a -&gt; ReadP b
forall (f :: Type -&gt; Type) a b.
Applicative f =&gt;
f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ReadP CaptureMethod -&gt; ReadP CaptureMethod
forall a. ReadP a -&gt; ReadP a
</span><a href="Test.DocTest.Driver.Extract.Ast.html#lexeme"><span class="hs-identifier hs-var">lexeme</span></a></span><span> </span><span class="annot"><span class="annottext">ReadP CaptureMethod
</span><a href="Test.DocTest.Driver.Extract.Ast.html#pCaptureMethod"><span class="hs-identifier hs-var">pCaptureMethod</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-474"></span><span>
</span><span id="line-475"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#pSetup"><span class="hs-identifier hs-type">pSetup</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">R.ReadP</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Instruction"><span class="hs-identifier hs-type">Instruction</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-476"></span><span id="pSetup"><span class="annot"><span class="annottext">pSetup :: ReadP ([Char] -&gt; Instruction)
</span><a href="Test.DocTest.Driver.Extract.Ast.html#pSetup"><span class="hs-identifier hs-var hs-var">pSetup</span></a></span></span><span>
</span><span id="line-477"></span><span>  </span><span class="hs-glyph">=</span><span>   </span><span class="annot"><span class="annottext">[Char] -&gt; Instruction
</span><a href="Test.DocTest.Driver.Extract.Ast.html#SetupImport"><span class="hs-identifier hs-var">SetupImport</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Instruction)
-&gt; ReadP () -&gt; ReadP ([Char] -&gt; Instruction)
forall a b. a -&gt; ReadP b -&gt; ReadP a
forall (f :: Type -&gt; Type) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ReadP ()
</span><a href="Test.DocTest.Driver.Extract.Ast.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;setup-import&quot;</span></span><span>
</span><span id="line-478"></span><span>  </span><span class="annot"><span class="annottext">ReadP ([Char] -&gt; Instruction)
-&gt; ReadP ([Char] -&gt; Instruction) -&gt; ReadP ([Char] -&gt; Instruction)
forall a. ReadP a -&gt; ReadP a -&gt; ReadP a
forall (f :: Type -&gt; Type) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Instruction
</span><a href="Test.DocTest.Driver.Extract.Ast.html#SetupOther"><span class="hs-identifier hs-var">SetupOther</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Instruction)
-&gt; ReadP () -&gt; ReadP ([Char] -&gt; Instruction)
forall a b. a -&gt; ReadP b -&gt; ReadP a
forall (f :: Type -&gt; Type) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ReadP ()
</span><a href="Test.DocTest.Driver.Extract.Ast.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;setup-top&quot;</span></span><span>
</span><span id="line-479"></span><span>  </span><span class="annot"><span class="annottext">ReadP ([Char] -&gt; Instruction)
-&gt; ReadP ([Char] -&gt; Instruction) -&gt; ReadP ([Char] -&gt; Instruction)
forall a. ReadP a -&gt; ReadP a -&gt; ReadP a
forall (f :: Type -&gt; Type) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Instruction
</span><a href="Test.DocTest.Driver.Extract.Ast.html#SetupAuto"><span class="hs-identifier hs-var">SetupAuto</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Instruction)
-&gt; ReadP () -&gt; ReadP ([Char] -&gt; Instruction)
forall a b. a -&gt; ReadP b -&gt; ReadP a
forall (f :: Type -&gt; Type) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ReadP ()
</span><a href="Test.DocTest.Driver.Extract.Ast.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;setup&quot;</span></span><span>
</span><span id="line-480"></span><span>
</span><span id="line-481"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#pBeforeAfterHook"><span class="hs-identifier hs-type">pBeforeAfterHook</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">R.ReadP</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Instruction"><span class="hs-identifier hs-type">Instruction</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-482"></span><span id="pBeforeAfterHook"><span class="annot"><span class="annottext">pBeforeAfterHook :: ReadP ([[Char]] -&gt; Instruction)
</span><a href="Test.DocTest.Driver.Extract.Ast.html#pBeforeAfterHook"><span class="hs-identifier hs-var hs-var">pBeforeAfterHook</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[HookFlavour] -&gt; ReadP ([[Char]] -&gt; Instruction)
</span><a href="Test.DocTest.Driver.Extract.Ast.html#pHookOf"><span class="hs-identifier hs-var">pHookOf</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">HookFlavour
</span><a href="Test.DocTest.Driver.Extract.Ast.html#Before"><span class="hs-identifier hs-var">Before</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">HookFlavour
</span><a href="Test.DocTest.Driver.Extract.Ast.html#BeforeAll"><span class="hs-identifier hs-var">BeforeAll</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">HookFlavour
</span><a href="Test.DocTest.Driver.Extract.Ast.html#After"><span class="hs-identifier hs-var">After</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">HookFlavour
</span><a href="Test.DocTest.Driver.Extract.Ast.html#AfterAll"><span class="hs-identifier hs-var">AfterAll</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-483"></span><span>
</span><span id="line-484"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#pHookOf"><span class="hs-identifier hs-type">pHookOf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#HookFlavour"><span class="hs-identifier hs-type">HookFlavour</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">R.ReadP</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Instruction"><span class="hs-identifier hs-type">Instruction</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-485"></span><span id="pHookOf"><span class="annot"><span class="annottext">pHookOf :: [HookFlavour] -&gt; ReadP ([[Char]] -&gt; Instruction)
</span><a href="Test.DocTest.Driver.Extract.Ast.html#pHookOf"><span class="hs-identifier hs-var hs-var">pHookOf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ReadP ([[Char]] -&gt; Instruction)]
-&gt; ReadP ([[Char]] -&gt; Instruction)
forall a. [ReadP a] -&gt; ReadP a
</span><span class="hs-identifier hs-var">R.choice</span></span><span> </span><span class="annot"><span class="annottext">([ReadP ([[Char]] -&gt; Instruction)]
 -&gt; ReadP ([[Char]] -&gt; Instruction))
-&gt; ([HookFlavour] -&gt; [ReadP ([[Char]] -&gt; Instruction)])
-&gt; [HookFlavour]
-&gt; ReadP ([[Char]] -&gt; Instruction)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(HookFlavour -&gt; ReadP ([[Char]] -&gt; Instruction))
-&gt; [HookFlavour] -&gt; [ReadP ([[Char]] -&gt; Instruction)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">HookFlavour -&gt; ReadP ([[Char]] -&gt; Instruction)
</span><a href="#local-6989586621679160911"><span class="hs-identifier hs-var">branch</span></a></span><span>
</span><span id="line-486"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679160911"><span class="annot"><span class="annottext">branch :: HookFlavour -&gt; ReadP ([[Char]] -&gt; Instruction)
</span><a href="#local-6989586621679160911"><span class="hs-identifier hs-var hs-var">branch</span></a></span></span><span> </span><span id="local-6989586621679160914"><span class="annot"><span class="annottext">HookFlavour
</span><a href="#local-6989586621679160914"><span class="hs-identifier hs-var">flavour</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HookFlavour -&gt; [[Char]] -&gt; Instruction
</span><a href="Test.DocTest.Driver.Extract.Ast.html#UseHook"><span class="hs-identifier hs-var">UseHook</span></a></span><span> </span><span class="annot"><span class="annottext">HookFlavour
</span><a href="#local-6989586621679160914"><span class="hs-identifier hs-var">flavour</span></a></span><span> </span><span class="annot"><span class="annottext">([[Char]] -&gt; Instruction)
-&gt; ReadP () -&gt; ReadP ([[Char]] -&gt; Instruction)
forall a b. a -&gt; ReadP b -&gt; ReadP a
forall (f :: Type -&gt; Type) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ReadP ()
</span><a href="Test.DocTest.Driver.Extract.Ast.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HookFlavour -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">HookFlavour
</span><a href="#local-6989586621679160914"><span class="hs-identifier hs-var">flavour</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-487"></span><span>
</span><span id="line-488"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#pArgs"><span class="hs-identifier hs-type">pArgs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">R.ReadP</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span>
</span><span id="line-489"></span><span id="pArgs"><span class="annot"><span class="annottext">pArgs :: ReadP [[Char]]
</span><a href="Test.DocTest.Driver.Extract.Ast.html#pArgs"><span class="hs-identifier hs-var hs-var">pArgs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReadP [Char]
</span><a href="Test.DocTest.Driver.Extract.Ast.html#ident"><span class="hs-identifier hs-var">ident</span></a></span><span> </span><span class="annot"><span class="annottext">ReadP [Char] -&gt; ReadP () -&gt; ReadP [[Char]]
forall a sep. ReadP a -&gt; ReadP sep -&gt; ReadP [a]
</span><span class="hs-operator hs-var">`R.sepBy`</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ReadP ()
</span><a href="Test.DocTest.Driver.Extract.Ast.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;,&quot;</span></span><span>
</span><span id="line-490"></span><span>
</span><span id="line-491"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#pAroundHook"><span class="hs-identifier hs-type">pAroundHook</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">R.ReadP</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Instruction"><span class="hs-identifier hs-type">Instruction</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-492"></span><span id="pAroundHook"><span class="annot"><span class="annottext">pAroundHook :: ReadP ([[Char]] -&gt; Instruction)
</span><a href="Test.DocTest.Driver.Extract.Ast.html#pAroundHook"><span class="hs-identifier hs-var hs-var">pAroundHook</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[HookFlavour] -&gt; ReadP ([[Char]] -&gt; Instruction)
</span><a href="Test.DocTest.Driver.Extract.Ast.html#pHookOf"><span class="hs-identifier hs-var">pHookOf</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">HookFlavour
</span><a href="Test.DocTest.Driver.Extract.Ast.html#Around"><span class="hs-identifier hs-var">Around</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">HookFlavour
</span><a href="Test.DocTest.Driver.Extract.Ast.html#AroundAll"><span class="hs-identifier hs-var">AroundAll</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-493"></span><span>
</span><span id="line-494"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#pAroundArgs"><span class="hs-identifier hs-type">pAroundArgs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">R.ReadP</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span>
</span><span id="line-495"></span><span id="pAroundArgs"><span class="annot"><span class="annottext">pAroundArgs :: ReadP [[Char]]
</span><a href="Test.DocTest.Driver.Extract.Ast.html#pAroundArgs"><span class="hs-identifier hs-var hs-var">pAroundArgs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; [[Char]] -&gt; [[Char]])
-&gt; ReadP [Char] -&gt; ReadP ([[Char]] -&gt; [[Char]])
forall (f :: Type -&gt; Type) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; ReadP ()
</span><a href="Test.DocTest.Driver.Extract.Ast.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;cont&quot;</span></span><span> </span><span class="annot"><span class="annottext">ReadP () -&gt; ReadP () -&gt; ReadP ()
forall a b. ReadP a -&gt; ReadP b -&gt; ReadP b
forall (f :: Type -&gt; Type) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ReadP ()
</span><a href="Test.DocTest.Driver.Extract.Ast.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;=&quot;</span></span><span> </span><span class="annot"><span class="annottext">ReadP () -&gt; ReadP [Char] -&gt; ReadP [Char]
forall a b. ReadP a -&gt; ReadP b -&gt; ReadP b
forall (f :: Type -&gt; Type) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ReadP [Char]
</span><a href="Test.DocTest.Driver.Extract.Ast.html#ident"><span class="hs-identifier hs-var">ident</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ReadP ([[Char]] -&gt; [[Char]]) -&gt; ReadP [[Char]] -&gt; ReadP [[Char]]
forall a b. ReadP (a -&gt; b) -&gt; ReadP a -&gt; ReadP b
forall (f :: Type -&gt; Type) a b.
Applicative f =&gt;
f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">[[Char]] -&gt; ReadP [[Char]] -&gt; ReadP [[Char]]
forall a. a -&gt; ReadP a -&gt; ReadP a
</span><span class="hs-identifier hs-var">R.option</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; ReadP ()
</span><a href="Test.DocTest.Driver.Extract.Ast.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;,&quot;</span></span><span> </span><span class="annot"><span class="annottext">ReadP () -&gt; ReadP [[Char]] -&gt; ReadP [[Char]]
forall a b. ReadP a -&gt; ReadP b -&gt; ReadP b
forall (f :: Type -&gt; Type) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ReadP [[Char]]
</span><a href="Test.DocTest.Driver.Extract.Ast.html#pArgs"><span class="hs-identifier hs-var">pArgs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-496"></span><span>
</span><span id="line-497"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#pCaptureMethod"><span class="hs-identifier hs-type">pCaptureMethod</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">R.ReadP</span></span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#CaptureMethod"><span class="hs-identifier hs-type">CaptureMethod</span></a></span><span>
</span><span id="line-498"></span><span id="pCaptureMethod"><span class="annot"><span class="annottext">pCaptureMethod :: ReadP CaptureMethod
</span><a href="Test.DocTest.Driver.Extract.Ast.html#pCaptureMethod"><span class="hs-identifier hs-var hs-var">pCaptureMethod</span></a></span></span><span>
</span><span id="line-499"></span><span>  </span><span class="hs-glyph">=</span><span>   </span><span class="annot"><span class="annottext">CaptureMethod
</span><a href="Test.DocTest.Driver.Extract.Ast.html#String"><span class="hs-identifier hs-var">String</span></a></span><span> </span><span class="annot"><span class="annottext">CaptureMethod -&gt; ReadP [Char] -&gt; ReadP CaptureMethod
forall a b. a -&gt; ReadP b -&gt; ReadP a
forall (f :: Type -&gt; Type) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ReadP [Char]
</span><span class="hs-identifier hs-var">R.string</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;String&quot;</span></span><span>
</span><span id="line-500"></span><span>  </span><span class="annot"><span class="annottext">ReadP CaptureMethod -&gt; ReadP CaptureMethod -&gt; ReadP CaptureMethod
forall a. ReadP a -&gt; ReadP a -&gt; ReadP a
forall (f :: Type -&gt; Type) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">CaptureMethod
</span><a href="Test.DocTest.Driver.Extract.Ast.html#TextStrict"><span class="hs-identifier hs-var">TextStrict</span></a></span><span> </span><span class="annot"><span class="annottext">CaptureMethod -&gt; ReadP () -&gt; ReadP CaptureMethod
forall a b. a -&gt; ReadP b -&gt; ReadP a
forall (f :: Type -&gt; Type) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">ReadP [Char] -&gt; ReadP ()
forall a. ReadP a -&gt; ReadP ()
</span><span class="hs-identifier hs-var">R.optional</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; ReadP [Char]
</span><span class="hs-identifier hs-var">R.string</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Strict.&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ReadP CaptureMethod -&gt; ReadP [Char] -&gt; ReadP CaptureMethod
forall a b. ReadP a -&gt; ReadP b -&gt; ReadP a
forall (f :: Type -&gt; Type) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ReadP [Char]
</span><span class="hs-identifier hs-var">R.string</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Text&quot;</span></span><span>
</span><span id="line-501"></span><span>  </span><span class="annot"><span class="annottext">ReadP CaptureMethod -&gt; ReadP CaptureMethod -&gt; ReadP CaptureMethod
forall a. ReadP a -&gt; ReadP a -&gt; ReadP a
forall (f :: Type -&gt; Type) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">CaptureMethod
</span><a href="Test.DocTest.Driver.Extract.Ast.html#TextLazy"><span class="hs-identifier hs-var">TextLazy</span></a></span><span> </span><span class="annot"><span class="annottext">CaptureMethod -&gt; ReadP [Char] -&gt; ReadP CaptureMethod
forall a b. a -&gt; ReadP b -&gt; ReadP a
forall (f :: Type -&gt; Type) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ReadP [Char]
</span><span class="hs-identifier hs-var">R.string</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Lazy.Text&quot;</span></span><span>
</span><span id="line-502"></span><span>  </span><span class="annot"><span class="annottext">ReadP CaptureMethod -&gt; ReadP CaptureMethod -&gt; ReadP CaptureMethod
forall a. ReadP a -&gt; ReadP a -&gt; ReadP a
forall (f :: Type -&gt; Type) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">CaptureMethod
</span><a href="Test.DocTest.Driver.Extract.Ast.html#ByteStringStrict"><span class="hs-identifier hs-var">ByteStringStrict</span></a></span><span> </span><span class="annot"><span class="annottext">CaptureMethod -&gt; ReadP () -&gt; ReadP CaptureMethod
forall a b. a -&gt; ReadP b -&gt; ReadP a
forall (f :: Type -&gt; Type) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">ReadP [Char] -&gt; ReadP ()
forall a. ReadP a -&gt; ReadP ()
</span><span class="hs-identifier hs-var">R.optional</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; ReadP [Char]
</span><span class="hs-identifier hs-var">R.string</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Strict.&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ReadP CaptureMethod -&gt; ReadP [Char] -&gt; ReadP CaptureMethod
forall a b. ReadP a -&gt; ReadP b -&gt; ReadP a
forall (f :: Type -&gt; Type) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ReadP [Char]
</span><span class="hs-identifier hs-var">R.string</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;ByteString&quot;</span></span><span>
</span><span id="line-503"></span><span>  </span><span class="annot"><span class="annottext">ReadP CaptureMethod -&gt; ReadP CaptureMethod -&gt; ReadP CaptureMethod
forall a. ReadP a -&gt; ReadP a -&gt; ReadP a
forall (f :: Type -&gt; Type) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">CaptureMethod
</span><a href="Test.DocTest.Driver.Extract.Ast.html#ByteStringLazy"><span class="hs-identifier hs-var">ByteStringLazy</span></a></span><span> </span><span class="annot"><span class="annottext">CaptureMethod -&gt; ReadP [Char] -&gt; ReadP CaptureMethod
forall a b. a -&gt; ReadP b -&gt; ReadP a
forall (f :: Type -&gt; Type) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ReadP [Char]
</span><span class="hs-identifier hs-var">R.string</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Lazy.ByteString&quot;</span></span><span>
</span><span id="line-504"></span><span>  </span><span class="annot"><span class="annottext">ReadP CaptureMethod -&gt; ReadP CaptureMethod -&gt; ReadP CaptureMethod
forall a. ReadP a -&gt; ReadP a -&gt; ReadP a
forall (f :: Type -&gt; Type) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">CaptureMethod
</span><a href="Test.DocTest.Driver.Extract.Ast.html#ShortByteString"><span class="hs-identifier hs-var">ShortByteString</span></a></span><span> </span><span class="annot"><span class="annottext">CaptureMethod -&gt; ReadP [Char] -&gt; ReadP CaptureMethod
forall a b. a -&gt; ReadP b -&gt; ReadP a
forall (f :: Type -&gt; Type) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ReadP [Char]
</span><span class="hs-identifier hs-var">R.string</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;ShortByteString&quot;</span></span><span>
</span><span id="line-505"></span><span>  </span><span class="annot"><span class="annottext">ReadP CaptureMethod -&gt; ReadP CaptureMethod -&gt; ReadP CaptureMethod
forall a. ReadP a -&gt; ReadP a -&gt; ReadP a
forall (f :: Type -&gt; Type) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">CaptureMethod
</span><a href="Test.DocTest.Driver.Extract.Ast.html#TempFile"><span class="hs-identifier hs-var">TempFile</span></a></span><span> </span><span class="annot"><span class="annottext">CaptureMethod -&gt; ReadP [Char] -&gt; ReadP CaptureMethod
forall a b. a -&gt; ReadP b -&gt; ReadP a
forall (f :: Type -&gt; Type) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ReadP [Char]
</span><span class="hs-identifier hs-var">R.string</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;FilePath&quot;</span></span><span>
</span><span id="line-506"></span><span>
</span><span id="line-507"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#pCommentHead"><span class="hs-identifier hs-type">pCommentHead</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">R.ReadP</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-508"></span><span id="pCommentHead"><span class="annot"><span class="annottext">pCommentHead :: ReadP ()
</span><a href="Test.DocTest.Driver.Extract.Ast.html#pCommentHead"><span class="hs-identifier hs-var hs-var">pCommentHead</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ReadP ()
</span><a href="Test.DocTest.Driver.Extract.Ast.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;--&quot;</span></span><span> </span><span class="annot"><span class="annottext">ReadP () -&gt; ReadP () -&gt; ReadP ()
forall a b. ReadP a -&gt; ReadP b -&gt; ReadP b
forall (f :: Type -&gt; Type) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ReadP ()
</span><a href="Test.DocTest.Driver.Extract.Ast.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;doctest:&quot;</span></span><span>
</span><span id="line-509"></span><span>
</span><span id="line-510"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#pInstructionComment"><span class="hs-identifier hs-type">pInstructionComment</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">R.ReadP</span></span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Instruction"><span class="hs-identifier hs-type">Instruction</span></a></span><span>
</span><span id="line-511"></span><span id="pInstructionComment"><span class="annot"><span class="annottext">pInstructionComment :: ReadP Instruction
</span><a href="Test.DocTest.Driver.Extract.Ast.html#pInstructionComment"><span class="hs-identifier hs-var hs-var">pInstructionComment</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReadP ()
</span><a href="Test.DocTest.Driver.Extract.Ast.html#pCommentHead"><span class="hs-identifier hs-var">pCommentHead</span></a></span><span> </span><span class="annot"><span class="annottext">ReadP () -&gt; ReadP Instruction -&gt; ReadP Instruction
forall a b. ReadP a -&gt; ReadP b -&gt; ReadP b
forall (f :: Type -&gt; Type) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Instruction -&gt; ReadP Instruction -&gt; ReadP Instruction
forall a. a -&gt; ReadP a -&gt; ReadP a
</span><span class="hs-identifier hs-var">R.option</span></span><span> </span><span class="annot"><span class="annottext">Instruction
</span><a href="Test.DocTest.Driver.Extract.Ast.html#IsExample"><span class="hs-identifier hs-var">IsExample</span></a></span><span> </span><span class="annot"><span class="annottext">ReadP Instruction
</span><a href="Test.DocTest.Driver.Extract.Ast.html#pInstruction"><span class="hs-identifier hs-var">pInstruction</span></a></span><span>
</span><span id="line-512"></span><span>
</span><span id="line-513"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#parseInstructions"><span class="hs-identifier hs-type">parseInstructions</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocTree"><span class="hs-identifier hs-type">DocTree</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#LDoc"><span class="hs-identifier hs-type">LDoc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocTree"><span class="hs-identifier hs-type">DocTree</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Instruction"><span class="hs-identifier hs-type">Instruction</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-514"></span><span id="parseInstructions"><span class="annot"><span class="annottext">parseInstructions :: DocTree (Either ([Char], LDoc) Doc)
-&gt; DocTree (Either (Instruction, Doc) Doc)
</span><a href="Test.DocTest.Driver.Extract.Ast.html#parseInstructions"><span class="hs-identifier hs-var hs-var">parseInstructions</span></a></span></span><span> </span><span id="local-6989586621679160919"><span class="annot"><span class="annottext">DocTree (Either ([Char], LDoc) Doc)
</span><a href="#local-6989586621679160919"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DocTree (Either ([Char], LDoc) Doc)
</span><a href="#local-6989586621679160919"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">DocTree (Either ([Char], LDoc) Doc)
-&gt; (Either ([Char], LDoc) Doc
    -&gt; DocTree (Either (Instruction, Doc) Doc))
-&gt; DocTree (Either (Instruction, Doc) Doc)
forall a b. DocTree a -&gt; (a -&gt; DocTree b) -&gt; DocTree b
forall (m :: Type -&gt; Type) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">(([Char], LDoc) -&gt; DocTree (Either (Instruction, Doc) Doc))
-&gt; (Doc -&gt; DocTree (Either (Instruction, Doc) Doc))
-&gt; Either ([Char], LDoc) Doc
-&gt; DocTree (Either (Instruction, Doc) Doc)
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([Char] -&gt; LDoc -&gt; DocTree (Either (Instruction, Doc) Doc))
-&gt; ([Char], LDoc) -&gt; DocTree (Either (Instruction, Doc) Doc)
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; LDoc -&gt; DocTree (Either (Instruction, Doc) Doc)
</span><a href="Test.DocTest.Driver.Extract.Ast.html#nameToInstruction"><span class="hs-identifier hs-var">nameToInstruction</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Either (Instruction, Doc) Doc
-&gt; DocTree (Either (Instruction, Doc) Doc)
forall a. a -&gt; DocTree a
</span><a href="Test.DocTest.Driver.Extract.Ast.html#DocEntry"><span class="hs-identifier hs-var">DocEntry</span></a></span><span> </span><span class="annot"><span class="annottext">(Either (Instruction, Doc) Doc
 -&gt; DocTree (Either (Instruction, Doc) Doc))
-&gt; (Doc -&gt; Either (Instruction, Doc) Doc)
-&gt; Doc
-&gt; DocTree (Either (Instruction, Doc) Doc)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Either (Instruction, Doc) Doc
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span class="hs-special">)</span><span>
</span><span id="line-515"></span><span>
</span><span id="line-516"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#nameToInstruction"><span class="hs-identifier hs-type">nameToInstruction</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#LDoc"><span class="hs-identifier hs-type">LDoc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocTree"><span class="hs-identifier hs-type">DocTree</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Instruction"><span class="hs-identifier hs-type">Instruction</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-517"></span><span id="nameToInstruction"><span class="annot"><span class="annottext">nameToInstruction :: [Char] -&gt; LDoc -&gt; DocTree (Either (Instruction, Doc) Doc)
</span><a href="Test.DocTest.Driver.Extract.Ast.html#nameToInstruction"><span class="hs-identifier hs-var hs-var">nameToInstruction</span></a></span></span><span> </span><span id="local-6989586621679160921"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679160921"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679160922"><span class="annot"><span class="annottext">LDoc
</span><a href="#local-6989586621679160922"><span class="hs-identifier hs-var">doc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ReadP Instruction -&gt; ReadS Instruction
forall a. ReadP a -&gt; ReadS a
</span><span class="hs-identifier hs-var">R.readP_to_S</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ReadP Instruction
</span><a href="Test.DocTest.Driver.Extract.Ast.html#pInstruction"><span class="hs-identifier hs-var">pInstruction</span></a></span><span> </span><span class="annot"><span class="annottext">ReadP Instruction -&gt; ReadP () -&gt; ReadP Instruction
forall a b. ReadP a -&gt; ReadP b -&gt; ReadP a
forall (f :: Type -&gt; Type) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">ReadP ()
</span><span class="hs-identifier hs-var">R.skipSpaces</span></span><span> </span><span class="annot"><span class="annottext">ReadP Instruction -&gt; ReadP () -&gt; ReadP Instruction
forall a b. ReadP a -&gt; ReadP b -&gt; ReadP a
forall (f :: Type -&gt; Type) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">ReadP ()
</span><span class="hs-identifier hs-var">R.eof</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679160921"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-518"></span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Entity
-&gt; Loc
-&gt; [DocTree (Either (Instruction, Doc) Doc)]
-&gt; DocTree (Either (Instruction, Doc) Doc)
forall a. Entity -&gt; Loc -&gt; [DocTree a] -&gt; DocTree a
</span><a href="Test.DocTest.Driver.Extract.Ast.html#DocGroup"><span class="hs-identifier hs-var">DocGroup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Entity
</span><a href="Test.DocTest.Driver.Extract.Ast.html#nameEntity"><span class="hs-identifier hs-var">nameEntity</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679160921"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Loc
</span><a href="#local-6989586621679160925"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Either (Instruction, Doc) Doc
-&gt; DocTree (Either (Instruction, Doc) Doc)
forall a. a -&gt; DocTree a
</span><a href="Test.DocTest.Driver.Extract.Ast.html#DocEntry"><span class="hs-identifier hs-var">DocEntry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc -&gt; Either (Instruction, Doc) Doc
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LDoc -&gt; Doc
forall l e. GenLocated l e -&gt; e
</span><span class="hs-identifier hs-var">unLoc</span></span><span> </span><span class="annot"><span class="annottext">LDoc
</span><a href="#local-6989586621679160922"><span class="hs-identifier hs-var">doc</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-519"></span><span>  </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621679160926"><span class="annot"><span class="annottext">Instruction
</span><a href="#local-6989586621679160926"><span class="hs-identifier hs-var">instr</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either (Instruction, Doc) Doc
-&gt; DocTree (Either (Instruction, Doc) Doc)
forall a. a -&gt; DocTree a
</span><a href="Test.DocTest.Driver.Extract.Ast.html#DocEntry"><span class="hs-identifier hs-var">DocEntry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Instruction, Doc) -&gt; Either (Instruction, Doc) Doc
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Instruction
</span><a href="#local-6989586621679160926"><span class="hs-identifier hs-var">instr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LDoc -&gt; Doc
forall l e. GenLocated l e -&gt; e
</span><span class="hs-identifier hs-var">unLoc</span></span><span> </span><span class="annot"><span class="annottext">LDoc
</span><a href="#local-6989586621679160922"><span class="hs-identifier hs-var">doc</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-520"></span><span>  </span><span class="annot"><span class="annottext">(Instruction, [Char])
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">(Instruction, [Char])
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[(Instruction, [Char])]
</span><span class="hs-identifier">_</span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; DocTree (Either (Instruction, Doc) Doc)
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;impossible: no ambiguity allowed in instruction syntax&quot;</span></span><span>
</span><span id="line-521"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679160925"><span class="annot"><span class="annottext">loc :: Loc
</span><a href="#local-6989586621679160925"><span class="hs-identifier hs-var hs-var">loc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SrcLoc -&gt; Loc
</span><a href="Test.DocTest.Driver.Extract.Ast.html#toLoc"><span class="hs-identifier hs-var">toLoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpan -&gt; SrcLoc
</span><span class="hs-identifier hs-var">GHC.srcSpanStart</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LDoc -&gt; SrcSpan
forall l e. GenLocated l e -&gt; l
</span><span class="hs-identifier hs-var">getLoc</span></span><span> </span><span class="annot"><span class="annottext">LDoc
</span><a href="#local-6989586621679160922"><span class="hs-identifier hs-var">doc</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-522"></span><span>
</span><span id="line-523"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#docLines"><span class="hs-identifier hs-type">docLines</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GHC.HsDocString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocLine"><span class="hs-identifier hs-type">DocLine</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-524"></span><span id="docLines"><span class="annot"><span class="annottext">docLines :: HsDocString -&gt; [DocLine]
</span><a href="Test.DocTest.Driver.Extract.Ast.html#docLines"><span class="hs-identifier hs-var hs-var">docLines</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GHC.MultiLineDocString</span></span><span> </span><span class="annot"><span class="annottext">HsDocStringDecorator
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679160928"><span class="annot"><span class="annottext">NonEmpty LHsDocStringChunk
</span><a href="#local-6989586621679160928"><span class="hs-identifier hs-var">lcs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(LHsDocStringChunk -&gt; DocLine) -&gt; [LHsDocStringChunk] -&gt; [DocLine]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">LHsDocStringChunk -&gt; DocLine
</span><a href="Test.DocTest.Driver.Extract.Ast.html#docChunkLine"><span class="hs-identifier hs-var">docChunkLine</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NonEmpty LHsDocStringChunk -&gt; [LHsDocStringChunk]
forall a. NonEmpty a -&gt; [a]
</span><span class="hs-identifier hs-var">NonEmpty.toList</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty LHsDocStringChunk
</span><a href="#local-6989586621679160928"><span class="hs-identifier hs-var">lcs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-525"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#docLines"><span class="hs-identifier hs-var">docLines</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GHC.NestedDocString</span></span><span> </span><span class="annot"><span class="annottext">HsDocStringDecorator
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679160930"><span class="annot"><span class="annottext">LHsDocStringChunk
</span><a href="#local-6989586621679160930"><span class="hs-identifier hs-var">lc</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LHsDocStringChunk -&gt; [DocLine]
</span><a href="Test.DocTest.Driver.Extract.Ast.html#docChunkLines"><span class="hs-identifier hs-var">docChunkLines</span></a></span><span> </span><span class="annot"><span class="annottext">LHsDocStringChunk
</span><a href="#local-6989586621679160930"><span class="hs-identifier hs-var">lc</span></a></span><span>
</span><span id="line-526"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#docLines"><span class="hs-identifier hs-var">docLines</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GHC.GeneratedDocString</span></span><span> </span><span id="local-6989586621679160932"><span class="annot"><span class="annottext">HsDocStringChunk
</span><a href="#local-6989586621679160932"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LHsDocStringChunk -&gt; [DocLine]
</span><a href="Test.DocTest.Driver.Extract.Ast.html#docChunkLines"><span class="hs-identifier hs-var">docChunkLines</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpan -&gt; HsDocStringChunk -&gt; LHsDocStringChunk
forall l e. l -&gt; e -&gt; GenLocated l e
</span><span class="hs-identifier hs-var">L</span></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><span class="hs-identifier hs-var">GHC.generatedSrcSpan</span></span><span> </span><span class="annot"><span class="annottext">HsDocStringChunk
</span><a href="#local-6989586621679160932"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-527"></span><span>
</span><span id="line-528"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#docChunkLine"><span class="hs-identifier hs-type">docChunkLine</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GHC.LHsDocStringChunk</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocLine"><span class="hs-identifier hs-type">DocLine</span></a></span><span>
</span><span id="line-529"></span><span id="docChunkLine"><span class="annot"><span class="annottext">docChunkLine :: LHsDocStringChunk -&gt; DocLine
</span><a href="Test.DocTest.Driver.Extract.Ast.html#docChunkLine"><span class="hs-identifier hs-var hs-var">docChunkLine</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">L</span></span><span> </span><span id="local-6989586621679160934"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621679160934"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679160935"><span class="annot"><span class="annottext">HsDocStringChunk
</span><a href="#local-6989586621679160935"><span class="hs-identifier hs-var">docText</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Loc -&gt; [Char] -&gt; DocLine
</span><a href="Test.DocTest.Driver.Extract.Ast.html#DocLine"><span class="hs-identifier hs-var">DocLine</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcLoc -&gt; Loc
</span><a href="Test.DocTest.Driver.Extract.Ast.html#toLoc"><span class="hs-identifier hs-var">toLoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpan -&gt; SrcLoc
</span><span class="hs-identifier hs-var">GHC.srcSpanStart</span></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621679160934"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsDocStringChunk -&gt; [Char]
</span><span class="hs-identifier hs-var">GHC.unpackHDSC</span></span><span> </span><span class="annot"><span class="annottext">HsDocStringChunk
</span><a href="#local-6989586621679160935"><span class="hs-identifier hs-var">docText</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-530"></span><span>
</span><span id="line-531"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#docChunkLines"><span class="hs-identifier hs-type">docChunkLines</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GHC.LHsDocStringChunk</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocLine"><span class="hs-identifier hs-type">DocLine</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-532"></span><span id="docChunkLines"><span class="annot"><span class="annottext">docChunkLines :: LHsDocStringChunk -&gt; [DocLine]
</span><a href="Test.DocTest.Driver.Extract.Ast.html#docChunkLines"><span class="hs-identifier hs-var hs-var">docChunkLines</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">L</span></span><span> </span><span id="local-6989586621679160936"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621679160936"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679160937"><span class="annot"><span class="annottext">HsDocStringChunk
</span><a href="#local-6989586621679160937"><span class="hs-identifier hs-var">docText</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Loc -&gt; [Char] -&gt; DocLine) -&gt; [Loc] -&gt; [[Char]] -&gt; [DocLine]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="annot"><span class="annottext">Loc -&gt; [Char] -&gt; DocLine
</span><a href="Test.DocTest.Driver.Extract.Ast.html#DocLine"><span class="hs-identifier hs-var">DocLine</span></a></span><span> </span><span class="annot"><span class="annottext">[Loc]
</span><a href="#local-6989586621679160939"><span class="hs-identifier hs-var">locs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; [[Char]]
</span><a href="Test.DocTest.Driver.Utils.html#dosLines"><span class="hs-identifier hs-var">dosLines</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsDocStringChunk -&gt; [Char]
</span><span class="hs-identifier hs-var">GHC.unpackHDSC</span></span><span> </span><span class="annot"><span class="annottext">HsDocStringChunk
</span><a href="#local-6989586621679160937"><span class="hs-identifier hs-var">docText</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-533"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679160939"><span class="annot"><span class="annottext">locs :: [Loc]
</span><a href="#local-6989586621679160939"><span class="hs-identifier hs-var hs-var">locs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Loc -&gt; Loc) -&gt; Loc -&gt; [Loc]
forall a. (a -&gt; a) -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">iterate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Loc -&gt; Loc
</span><a href="Test.DocTest.Driver.Extract.Ast.html#advanceLoc"><span class="hs-identifier hs-var">advanceLoc</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;\n&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcLoc -&gt; Loc
</span><a href="Test.DocTest.Driver.Extract.Ast.html#toLoc"><span class="hs-identifier hs-var">toLoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpan -&gt; SrcLoc
</span><span class="hs-identifier hs-var">GHC.srcSpanStart</span></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621679160936"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-534"></span><span>
</span><span id="line-535"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#docNoInstruction"><span class="hs-identifier hs-type">docNoInstruction</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Instruction"><span class="hs-identifier hs-type">Instruction</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocLine"><span class="hs-identifier hs-type">DocLine</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocTests"><span class="hs-identifier hs-type">DocTests</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-536"></span><span id="docNoInstruction"><span class="annot"><span class="annottext">docNoInstruction :: Doc -&gt; [Either (Instruction, [DocLine]) DocTests]
</span><a href="Test.DocTest.Driver.Extract.Ast.html#docNoInstruction"><span class="hs-identifier hs-var hs-var">docNoInstruction</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(DocGroup -&gt; Maybe (Either (Instruction, [DocLine]) DocTests))
-&gt; [DocGroup] -&gt; [Either (Instruction, [DocLine]) DocTests]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="annot"><span class="annottext">DocGroup -&gt; Maybe (Either (Instruction, [DocLine]) DocTests)
</span><a href="Test.DocTest.Driver.Extract.Ast.html#docGroupNormal"><span class="hs-identifier hs-var">docGroupNormal</span></a></span><span> </span><span class="annot"><span class="annottext">([DocGroup] -&gt; [Either (Instruction, [DocLine]) DocTests])
-&gt; (Doc -&gt; [DocGroup])
-&gt; Doc
-&gt; [Either (Instruction, [DocLine]) DocTests]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; [DocGroup]
</span><a href="Test.DocTest.Driver.Extract.Ast.html#groupDoc"><span class="hs-identifier hs-var">groupDoc</span></a></span><span>
</span><span id="line-537"></span><span>
</span><span id="line-538"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#docWithInstruction"><span class="hs-identifier hs-type">docWithInstruction</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Instruction"><span class="hs-identifier hs-type">Instruction</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Instruction"><span class="hs-identifier hs-type">Instruction</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocLine"><span class="hs-identifier hs-type">DocLine</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocTests"><span class="hs-identifier hs-type">DocTests</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-539"></span><span id="docWithInstruction"><span class="annot"><span class="annottext">docWithInstruction :: Instruction -&gt; Doc -&gt; [Either (Instruction, [DocLine]) DocTests]
</span><a href="Test.DocTest.Driver.Extract.Ast.html#docWithInstruction"><span class="hs-identifier hs-var hs-var">docWithInstruction</span></a></span></span><span> </span><span id="local-6989586621679160944"><span class="annot"><span class="annottext">Instruction
</span><a href="#local-6989586621679160944"><span class="hs-identifier hs-var">instr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Instruction
-&gt; [DocGroup] -&gt; [Either (Instruction, [DocLine]) DocTests]
</span><a href="Test.DocTest.Driver.Extract.Ast.html#applyInstruction"><span class="hs-identifier hs-var">applyInstruction</span></a></span><span> </span><span class="annot"><span class="annottext">Instruction
</span><a href="#local-6989586621679160944"><span class="hs-identifier hs-var">instr</span></a></span><span> </span><span class="annot"><span class="annottext">([DocGroup] -&gt; [Either (Instruction, [DocLine]) DocTests])
-&gt; (Doc -&gt; [DocGroup])
-&gt; Doc
-&gt; [Either (Instruction, [DocLine]) DocTests]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; [DocGroup]
</span><a href="Test.DocTest.Driver.Extract.Ast.html#groupDoc"><span class="hs-identifier hs-var">groupDoc</span></a></span><span>
</span><span id="line-540"></span><span>
</span><span id="line-541"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#groupDoc"><span class="hs-identifier hs-type">groupDoc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocGroup"><span class="hs-identifier hs-type">DocGroup</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-542"></span><span id="groupDoc"><span class="annot"><span class="annottext">groupDoc :: Doc -&gt; [DocGroup]
</span><a href="Test.DocTest.Driver.Extract.Ast.html#groupDoc"><span class="hs-identifier hs-var hs-var">groupDoc</span></a></span></span><span>
</span><span id="line-543"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((LineType, NonEmpty (LineType, DocLine)) -&gt; Maybe DocGroup)
-&gt; [(LineType, NonEmpty (LineType, DocLine))] -&gt; [DocGroup]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(LineType -&gt; NonEmpty (LineType, DocLine) -&gt; Maybe DocGroup)
-&gt; (LineType, NonEmpty (LineType, DocLine)) -&gt; Maybe DocGroup
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="annot"><span class="annottext">LineType -&gt; NonEmpty (LineType, DocLine) -&gt; Maybe DocGroup
</span><a href="Test.DocTest.Driver.Extract.Ast.html#toDocGroup"><span class="hs-identifier hs-var">toDocGroup</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-544"></span><span>  </span><span class="annot"><span class="annottext">([(LineType, NonEmpty (LineType, DocLine))] -&gt; [DocGroup])
-&gt; (Doc -&gt; [(LineType, NonEmpty (LineType, DocLine))])
-&gt; Doc
-&gt; [DocGroup]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(DocLine -&gt; LineType)
-&gt; (LineType -&gt; LineType -&gt; Bool)
-&gt; [DocLine]
-&gt; [(LineType, NonEmpty (LineType, DocLine))]
forall a k.
(a -&gt; k) -&gt; (k -&gt; k -&gt; Bool) -&gt; [a] -&gt; [(k, NonEmpty (k, a))]
</span><a href="Test.DocTest.Driver.Extract.Ast.html#groupByKey"><span class="hs-identifier hs-var">groupByKey</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679160948"><span class="annot"><span class="annottext">DocLine
</span><a href="#local-6989586621679160948"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; LineType
</span><a href="Test.DocTest.Driver.Extract.Ast.html#docLineType"><span class="hs-identifier hs-var">docLineType</span></a></span><span> </span><span class="annot"><span class="annottext">DocLine
</span><a href="#local-6989586621679160948"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">textLine</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LineType -&gt; LineType -&gt; Bool
</span><a href="Test.DocTest.Driver.Extract.Ast.html#assocLineType"><span class="hs-identifier hs-var">assocLineType</span></a></span><span>
</span><span id="line-545"></span><span>  </span><span class="annot"><span class="annottext">([DocLine] -&gt; [(LineType, NonEmpty (LineType, DocLine))])
-&gt; (Doc -&gt; [DocLine])
-&gt; Doc
-&gt; [(LineType, NonEmpty (LineType, DocLine))]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">HsDocString -&gt; [DocLine]
</span><a href="Test.DocTest.Driver.Extract.Ast.html#docLines"><span class="hs-identifier hs-var">docLines</span></a></span><span> </span><span class="annot"><span class="annottext">(HsDocString -&gt; [DocLine])
-&gt; (Doc -&gt; HsDocString) -&gt; Doc -&gt; [DocLine]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; HsDocString
forall a pass. WithHsDocIdentifiers a pass -&gt; a
</span><span class="hs-identifier hs-var">GHC.hsDocString</span></span><span>
</span><span id="line-546"></span><span>
</span><span id="line-547"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#docGroupNormal"><span class="hs-identifier hs-type">docGroupNormal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocGroup"><span class="hs-identifier hs-type">DocGroup</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Instruction"><span class="hs-identifier hs-type">Instruction</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocLine"><span class="hs-identifier hs-type">DocLine</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocTests"><span class="hs-identifier hs-type">DocTests</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-548"></span><span id="docGroupNormal"><span class="annot"><span class="annottext">docGroupNormal :: DocGroup -&gt; Maybe (Either (Instruction, [DocLine]) DocTests)
</span><a href="Test.DocTest.Driver.Extract.Ast.html#docGroupNormal"><span class="hs-identifier hs-var hs-var">docGroupNormal</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#GExample"><span class="hs-identifier hs-type">GExample</span></a></span><span> </span><span id="local-6989586621679160952"><span class="annot"><span class="annottext">NonEmpty ExampleLine
</span><a href="#local-6989586621679160952"><span class="hs-identifier hs-var">ex</span></a></span></span><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either (Instruction, [DocLine]) DocTests
-&gt; Maybe (Either (Instruction, [DocLine]) DocTests)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DocTests -&gt; Either (Instruction, [DocLine]) DocTests
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NonEmpty ExampleLine -&gt; DocTests
</span><a href="Test.DocTest.Driver.Extract.Ast.html#TestExample"><span class="hs-identifier hs-var">TestExample</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty ExampleLine
</span><a href="#local-6989586621679160952"><span class="hs-identifier hs-var">ex</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-549"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#docGroupNormal"><span class="hs-identifier hs-var">docGroupNormal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#GProperty"><span class="hs-identifier hs-type">GProperty</span></a></span><span> </span><span id="local-6989586621679160954"><span class="annot"><span class="annottext">DocLine
</span><a href="#local-6989586621679160954"><span class="hs-identifier hs-var">prop</span></a></span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either (Instruction, [DocLine]) DocTests
-&gt; Maybe (Either (Instruction, [DocLine]) DocTests)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DocTests -&gt; Either (Instruction, [DocLine]) DocTests
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NonEmpty DocLine -&gt; DocTests
</span><a href="Test.DocTest.Driver.Extract.Ast.html#TestProperty"><span class="hs-identifier hs-var">TestProperty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DocLine -&gt; NonEmpty DocLine
forall a. a -&gt; NonEmpty a
</span><span class="hs-identifier hs-var">NonEmpty.singleton</span></span><span> </span><span class="annot"><span class="annottext">DocLine
</span><a href="#local-6989586621679160954"><span class="hs-identifier hs-var">prop</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-550"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#docGroupNormal"><span class="hs-identifier hs-var">docGroupNormal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#GVerbatim"><span class="hs-identifier hs-type">GVerbatim</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679160957"><span class="annot"><span class="annottext">DocLine
</span><a href="#local-6989586621679160957"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span> </span><span id="local-6989586621679160958"><span class="annot"><span class="annottext">[DocLine]
</span><a href="#local-6989586621679160958"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Instruction, [DocLine])
-&gt; Either (Instruction, [DocLine]) DocTests
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">((Instruction, [DocLine])
 -&gt; Either (Instruction, [DocLine]) DocTests)
-&gt; (Instruction -&gt; (Instruction, [DocLine]))
-&gt; Instruction
-&gt; Either (Instruction, [DocLine]) DocTests
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[DocLine]
</span><a href="#local-6989586621679160958"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Instruction -&gt; Either (Instruction, [DocLine]) DocTests)
-&gt; Maybe Instruction
-&gt; Maybe (Either (Instruction, [DocLine]) DocTests)
forall (f :: Type -&gt; Type) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Maybe Instruction
</span><a href="Test.DocTest.Driver.Extract.Ast.html#parseInstructionComment"><span class="hs-identifier hs-var">parseInstructionComment</span></a></span><span> </span><span class="annot"><span class="annottext">DocLine
</span><a href="#local-6989586621679160957"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">textLine</span><span>
</span><span id="line-551"></span><span>
</span><span id="line-552"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#applyInstruction"><span class="hs-identifier hs-type">applyInstruction</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Instruction"><span class="hs-identifier hs-type">Instruction</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocGroup"><span class="hs-identifier hs-type">DocGroup</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Instruction"><span class="hs-identifier hs-type">Instruction</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocLine"><span class="hs-identifier hs-type">DocLine</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocTests"><span class="hs-identifier hs-type">DocTests</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-553"></span><span id="applyInstruction"><span class="annot"><span class="annottext">applyInstruction :: Instruction
-&gt; [DocGroup] -&gt; [Either (Instruction, [DocLine]) DocTests]
</span><a href="Test.DocTest.Driver.Extract.Ast.html#applyInstruction"><span class="hs-identifier hs-var hs-var">applyInstruction</span></a></span></span><span> </span><span id="local-6989586621679160960"><span class="annot"><span class="annottext">Instruction
</span><a href="#local-6989586621679160960"><span class="hs-identifier hs-var">instr</span></a></span></span><span> </span><span id="local-6989586621679160961"><span class="annot"><span class="annottext">[DocGroup]
</span><a href="#local-6989586621679160961"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Instruction, [DocLine])
-&gt; Either (Instruction, [DocLine]) DocTests
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Instruction
</span><a href="#local-6989586621679160960"><span class="hs-identifier hs-var">instr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[DocLine]
</span><a href="#local-6989586621679160962"><span class="hs-identifier hs-var">code</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Either (Instruction, [DocLine]) DocTests
-&gt; [Either (Instruction, [DocLine]) DocTests]
-&gt; [Either (Instruction, [DocLine]) DocTests]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">(DocTests -&gt; Either (Instruction, [DocLine]) DocTests)
-&gt; [DocTests] -&gt; [Either (Instruction, [DocLine]) DocTests]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">DocTests -&gt; Either (Instruction, [DocLine]) DocTests
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">[DocTests]
</span><a href="#local-6989586621679160963"><span class="hs-identifier hs-var">warnings</span></a></span><span>
</span><span id="line-554"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679160963"><span class="annot"><span class="annottext">[DocTests]
</span><a href="#local-6989586621679160963"><span class="hs-identifier hs-var">warnings</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679160962"><span class="annot"><span class="annottext">[DocLine]
</span><a href="#local-6989586621679160962"><span class="hs-identifier hs-var">code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(DocGroup -&gt; ([DocTests], [DocLine]))
-&gt; [DocGroup] -&gt; ([DocTests], [DocLine])
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; [a] -&gt; m
forall (t :: Type -&gt; Type) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">DocGroup -&gt; ([DocTests], [DocLine])
</span><a href="Test.DocTest.Driver.Extract.Ast.html#plainCode"><span class="hs-identifier hs-var">plainCode</span></a></span><span> </span><span class="annot"><span class="annottext">[DocGroup]
</span><a href="#local-6989586621679160961"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-555"></span><span>
</span><span id="line-556"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#plainCode"><span class="hs-identifier hs-type">plainCode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocGroup"><span class="hs-identifier hs-type">DocGroup</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocTests"><span class="hs-identifier hs-type">DocTests</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocLine"><span class="hs-identifier hs-type">DocLine</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-557"></span><span id="plainCode"><span class="annot"><span class="annottext">plainCode :: DocGroup -&gt; ([DocTests], [DocLine])
</span><a href="Test.DocTest.Driver.Extract.Ast.html#plainCode"><span class="hs-identifier hs-var hs-var">plainCode</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#GExample"><span class="hs-identifier hs-type">GExample</span></a></span><span> </span><span id="local-6989586621679160966"><span class="annot"><span class="annottext">NonEmpty ExampleLine
</span><a href="#local-6989586621679160966"><span class="hs-identifier hs-var">ls</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ExampleLine -&gt; ([DocTests], DocLine))
-&gt; [ExampleLine] -&gt; ([DocTests], [DocLine])
forall (t :: Type -&gt; Type) (f :: Type -&gt; Type) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: Type -&gt; Type) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; [a] -&gt; f [b]
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">ExampleLine -&gt; ([DocTests], DocLine)
forall {r} {r} {b}.
(HasField &quot;location&quot; r Loc, HasField &quot;programLine&quot; r b,
 HasField &quot;expectedOutput&quot; r [r]) =&gt;
r -&gt; ([DocTests], b)
</span><a href="#local-6989586621679160967"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NonEmpty ExampleLine -&gt; [ExampleLine]
forall a. NonEmpty a -&gt; [a]
</span><span class="hs-identifier hs-var">NonEmpty.toList</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty ExampleLine
</span><a href="#local-6989586621679160966"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-558"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679160967"><span class="annot"><span class="annottext">go :: r -&gt; ([DocTests], b)
</span><a href="#local-6989586621679160967"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679160975"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679160975"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[DocTests]
-&gt; (NonEmpty r -&gt; [DocTests]) -&gt; Maybe (NonEmpty r) -&gt; [DocTests]
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DocTests -&gt; [DocTests]
forall a. a -&gt; [a]
forall (f :: Type -&gt; Type) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(DocTests -&gt; [DocTests])
-&gt; (NonEmpty r -&gt; DocTests) -&gt; NonEmpty r -&gt; [DocTests]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty r -&gt; DocTests
forall {r}. HasField &quot;location&quot; r Loc =&gt; NonEmpty r -&gt; DocTests
</span><a href="#local-6989586621679160976"><span class="hs-identifier hs-var">warn</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[r] -&gt; Maybe (NonEmpty r)
forall a. [a] -&gt; Maybe (NonEmpty a)
</span><span class="hs-identifier hs-var">nonEmpty</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679160975"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">expectedOutput</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679160975"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">programLine</span><span class="hs-special">)</span><span>
</span><span id="line-559"></span><span>        </span><span id="local-6989586621679160976"><span class="annot"><span class="annottext">warn :: NonEmpty r -&gt; DocTests
</span><a href="#local-6989586621679160976"><span class="hs-identifier hs-var hs-var">warn</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679160979"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679160979"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span> </span><span class="annot"><span class="annottext">[r]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Loc -&gt; [Char] -&gt; DocTests
</span><a href="Test.DocTest.Driver.Extract.Ast.html#Warning"><span class="hs-identifier hs-var">Warning</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679160979"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">location</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;unexpected output text, expecting plain code&quot;</span></span><span>
</span><span id="line-560"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#plainCode"><span class="hs-identifier hs-var">plainCode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#GProperty"><span class="hs-identifier hs-type">GProperty</span></a></span><span> </span><span id="local-6989586621679160980"><span class="annot"><span class="annottext">DocLine
</span><a href="#local-6989586621679160980"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Loc -&gt; [Char] -&gt; DocTests
</span><a href="Test.DocTest.Driver.Extract.Ast.html#Warning"><span class="hs-identifier hs-var">Warning</span></a></span><span> </span><span class="annot"><span class="annottext">DocLine
</span><a href="#local-6989586621679160980"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">location</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;unexpected property, expecting plain code&quot;</span></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-561"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#plainCode"><span class="hs-identifier hs-var">plainCode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#GVerbatim"><span class="hs-identifier hs-type">GVerbatim</span></a></span><span> </span><span id="local-6989586621679160981"><span class="annot"><span class="annottext">ls :: NonEmpty DocLine
</span><a href="#local-6989586621679160981"><span class="hs-identifier hs-var">ls</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679160982"><span class="annot"><span class="annottext">DocLine
</span><a href="#local-6989586621679160982"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span> </span><span class="annot"><span class="annottext">[DocLine]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Instruction -&gt; ([DocTests], [DocLine])
</span><a href="#local-6989586621679160983"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Maybe Instruction
</span><a href="Test.DocTest.Driver.Extract.Ast.html#parseInstructionComment"><span class="hs-identifier hs-var">parseInstructionComment</span></a></span><span> </span><span class="annot"><span class="annottext">DocLine
</span><a href="#local-6989586621679160982"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">textLine</span><span class="hs-special">)</span><span>
</span><span id="line-562"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679160983"><span class="annot"><span class="annottext">go :: Maybe Instruction -&gt; ([DocTests], [DocLine])
</span><a href="#local-6989586621679160983"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([DocTests], [DocLine])
-&gt; (Instruction -&gt; ([DocTests], [DocLine]))
-&gt; Maybe Instruction
-&gt; ([DocTests], [DocLine])
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NonEmpty DocLine -&gt; [DocLine]
forall a. NonEmpty a -&gt; [a]
</span><span class="hs-identifier hs-var">NonEmpty.toList</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty DocLine
</span><a href="#local-6989586621679160981"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([DocTests], [DocLine]) -&gt; Instruction -&gt; ([DocTests], [DocLine])
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">DocTests
</span><a href="#local-6989586621679160984"><span class="hs-identifier hs-var">warning</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-563"></span><span>        </span><span id="local-6989586621679160984"><span class="annot"><span class="annottext">warning :: DocTests
</span><a href="#local-6989586621679160984"><span class="hs-identifier hs-var hs-var">warning</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Loc -&gt; [Char] -&gt; DocTests
</span><a href="Test.DocTest.Driver.Extract.Ast.html#Warning"><span class="hs-identifier hs-var">Warning</span></a></span><span> </span><span class="annot"><span class="annottext">DocLine
</span><a href="#local-6989586621679160982"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">location</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;unexpected instruction, expecting plain code&quot;</span></span><span>
</span><span id="line-564"></span><span>
</span><span id="line-565"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#parseInstructionComment"><span class="hs-identifier hs-type">parseInstructionComment</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Instruction"><span class="hs-identifier hs-type">Instruction</span></a></span><span>
</span><span id="line-566"></span><span id="parseInstructionComment"><span class="annot"><span class="annottext">parseInstructionComment :: [Char] -&gt; Maybe Instruction
</span><a href="Test.DocTest.Driver.Extract.Ast.html#parseInstructionComment"><span class="hs-identifier hs-var hs-var">parseInstructionComment</span></a></span></span><span> </span><span id="local-6989586621679160985"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679160985"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ReadP Instruction -&gt; ReadS Instruction
forall a. ReadP a -&gt; ReadS a
</span><span class="hs-identifier hs-var">R.readP_to_S</span></span><span> </span><span class="annot"><span class="annottext">ReadP Instruction
</span><a href="#local-6989586621679160986"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679160985"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-567"></span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Instruction
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-568"></span><span>  </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621679160987"><span class="annot"><span class="annottext">Instruction
</span><a href="#local-6989586621679160987"><span class="hs-identifier hs-var">instr</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Instruction -&gt; Maybe Instruction
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Instruction
</span><a href="#local-6989586621679160987"><span class="hs-identifier hs-var">instr</span></a></span><span>
</span><span id="line-569"></span><span>  </span><span class="annot"><span class="annottext">(Instruction, [Char])
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">(Instruction, [Char])
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[(Instruction, [Char])]
</span><span class="hs-identifier">_</span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Maybe Instruction
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;impossible: no ambiguity allowed in instruction syntax&quot;</span></span><span>
</span><span id="line-570"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679160986"><span class="annot"><span class="annottext">p :: ReadP Instruction
</span><a href="#local-6989586621679160986"><span class="hs-identifier hs-var hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReadP Instruction
</span><a href="Test.DocTest.Driver.Extract.Ast.html#pInstructionComment"><span class="hs-identifier hs-var">pInstructionComment</span></a></span><span> </span><span class="annot"><span class="annottext">ReadP Instruction -&gt; ReadP () -&gt; ReadP Instruction
forall a b. ReadP a -&gt; ReadP b -&gt; ReadP a
forall (f :: Type -&gt; Type) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">ReadP ()
</span><span class="hs-identifier hs-var">R.skipSpaces</span></span><span> </span><span class="annot"><span class="annottext">ReadP Instruction -&gt; ReadP () -&gt; ReadP Instruction
forall a b. ReadP a -&gt; ReadP b -&gt; ReadP a
forall (f :: Type -&gt; Type) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">ReadP ()
</span><span class="hs-identifier hs-var">R.eof</span></span><span>
</span><span id="line-571"></span><span>
</span><span id="line-572"></span><span class="hs-keyword">data</span><span> </span><span id="DocGroup"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocGroup"><span class="hs-identifier hs-var">DocGroup</span></a></span></span><span>
</span><span id="line-573"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="GProperty"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#GProperty"><span class="hs-identifier hs-var">GProperty</span></a></span></span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocLine"><span class="hs-identifier hs-type">DocLine</span></a></span><span>
</span><span id="line-574"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="GExample"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#GExample"><span class="hs-identifier hs-var">GExample</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#ExampleLine"><span class="hs-identifier hs-type">ExampleLine</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-575"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="GVerbatim"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#GVerbatim"><span class="hs-identifier hs-var">GVerbatim</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocLine"><span class="hs-identifier hs-type">DocLine</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-576"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679160991"><span id="local-6989586621679161000"><span id="local-6989586621679161004"><span class="annot"><span class="annottext">Int -&gt; DocGroup -&gt; ShowS
[DocGroup] -&gt; ShowS
DocGroup -&gt; [Char]
(Int -&gt; DocGroup -&gt; ShowS)
-&gt; (DocGroup -&gt; [Char]) -&gt; ([DocGroup] -&gt; ShowS) -&gt; Show DocGroup
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; DocGroup -&gt; ShowS
showsPrec :: Int -&gt; DocGroup -&gt; ShowS
$cshow :: DocGroup -&gt; [Char]
show :: DocGroup -&gt; [Char]
$cshowList :: [DocGroup] -&gt; ShowS
showList :: [DocGroup] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679161007"><span id="local-6989586621679161013"><span class="annot"><span class="annottext">DocGroup -&gt; DocGroup -&gt; Bool
(DocGroup -&gt; DocGroup -&gt; Bool)
-&gt; (DocGroup -&gt; DocGroup -&gt; Bool) -&gt; Eq DocGroup
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: DocGroup -&gt; DocGroup -&gt; Bool
== :: DocGroup -&gt; DocGroup -&gt; Bool
$c/= :: DocGroup -&gt; DocGroup -&gt; Bool
/= :: DocGroup -&gt; DocGroup -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-577"></span><span>
</span><span id="line-578"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#toDocGroup"><span class="hs-identifier hs-type">toDocGroup</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#LineType"><span class="hs-identifier hs-type">LineType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#LineType"><span class="hs-identifier hs-type">LineType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocLine"><span class="hs-identifier hs-type">DocLine</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocGroup"><span class="hs-identifier hs-type">DocGroup</span></a></span><span>
</span><span id="line-579"></span><span class="hs-comment">-- properties are one in each group</span><span>
</span><span id="line-580"></span><span id="toDocGroup"><span class="annot"><span class="annottext">toDocGroup :: LineType -&gt; NonEmpty (LineType, DocLine) -&gt; Maybe DocGroup
</span><a href="Test.DocTest.Driver.Extract.Ast.html#toDocGroup"><span class="hs-identifier hs-var hs-var">toDocGroup</span></a></span></span><span> </span><span class="annot"><span class="annottext">LineType
</span><a href="Test.DocTest.Driver.Extract.Ast.html#Property"><span class="hs-identifier hs-var">Property</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">LineType
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679161017"><span class="annot"><span class="annottext">DocLine
</span><a href="#local-6989586621679161017"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span> </span><span id="local-6989586621679161018"><span class="annot"><span class="annottext">[(LineType, DocLine)]
</span><a href="#local-6989586621679161018"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe DocGroup -&gt; Maybe DocGroup
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><span class="hs-identifier hs-var hs-var">assert</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(LineType, DocLine)] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: Type -&gt; Type) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[(LineType, DocLine)]
</span><a href="#local-6989586621679161018"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DocGroup -&gt; Maybe DocGroup
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DocLine -&gt; DocGroup
</span><a href="Test.DocTest.Driver.Extract.Ast.html#GProperty"><span class="hs-identifier hs-var">GProperty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DocLine -&gt; DocLine
</span><a href="Test.DocTest.Driver.Extract.Ast.html#trimProperty"><span class="hs-identifier hs-var">trimProperty</span></a></span><span> </span><span class="annot"><span class="annottext">DocLine
</span><a href="#local-6989586621679161017"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-581"></span><span class="hs-comment">-- examples are optionally followed by expected output</span><span>
</span><span id="line-582"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#toDocGroup"><span class="hs-identifier hs-var">toDocGroup</span></a></span><span> </span><span class="annot"><span class="annottext">LineType
</span><a href="Test.DocTest.Driver.Extract.Ast.html#Example"><span class="hs-identifier hs-var">Example</span></a></span><span> </span><span id="local-6989586621679161021"><span class="annot"><span class="annottext">NonEmpty (LineType, DocLine)
</span><a href="#local-6989586621679161021"><span class="hs-identifier hs-var">exampleLines</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DocGroup -&gt; Maybe DocGroup
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NonEmpty (LineType, DocLine) -&gt; DocGroup
</span><a href="#local-6989586621679161022"><span class="hs-identifier hs-var">collectExample</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty (LineType, DocLine)
</span><a href="#local-6989586621679161021"><span class="hs-identifier hs-var">exampleLines</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-583"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679161032"><span class="annot"><span class="annottext">mkExampleLine :: NonEmpty (LineType, DocLine) -&gt; ExampleLine
</span><a href="#local-6989586621679161032"><span class="hs-identifier hs-var hs-var">mkExampleLine</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679161033"><span class="annot"><span class="annottext">(LineType, DocLine)
</span><a href="#local-6989586621679161033"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span> </span><span id="local-6989586621679161034"><span class="annot"><span class="annottext">[(LineType, DocLine)]
</span><a href="#local-6989586621679161034"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-584"></span><span>          </span><span class="annot"><span class="annottext">Bool
-&gt; (Bool -&gt; ExampleLine -&gt; ExampleLine)
-&gt; Bool
-&gt; ExampleLine
-&gt; ExampleLine
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><span class="hs-identifier hs-var hs-var">assert</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(LineType, DocLine) -&gt; LineType
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">(LineType, DocLine)
</span><a href="#local-6989586621679161033"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">LineType -&gt; LineType -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">LineType
</span><a href="Test.DocTest.Driver.Extract.Ast.html#Example"><span class="hs-identifier hs-var">Example</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-585"></span><span>          </span><span class="annot"><span class="annottext">Bool -&gt; ExampleLine -&gt; ExampleLine
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><span class="hs-identifier hs-var hs-var">assert</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((LineType, DocLine) -&gt; Bool) -&gt; [(LineType, DocLine)] -&gt; Bool
forall (t :: Type -&gt; Type) a.
Foldable t =&gt;
(a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">LineType -&gt; LineType -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">LineType
</span><a href="Test.DocTest.Driver.Extract.Ast.html#Other"><span class="hs-identifier hs-var">Other</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(LineType -&gt; Bool)
-&gt; ((LineType, DocLine) -&gt; LineType) -&gt; (LineType, DocLine) -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(LineType, DocLine) -&gt; LineType
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(LineType, DocLine)]
</span><a href="#local-6989586621679161034"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-586"></span><span>          </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#ExampleLine"><span class="hs-identifier hs-type">ExampleLine</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">DocLine
$sel:programLine:ExampleLine :: DocLine
programLine :: DocLine
</span><a href="Test.DocTest.Driver.Extract.Ast.html#%24sel%3AprogramLine%3AExampleLine"><span class="hs-identifier hs-var hs-var">programLine</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[DocLine]
$sel:expectedOutput:ExampleLine :: [DocLine]
expectedOutput :: [DocLine]
</span><a href="Test.DocTest.Driver.Extract.Ast.html#%24sel%3AexpectedOutput%3AExampleLine"><span class="hs-identifier hs-var hs-var">expectedOutput</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-587"></span><span>          </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679161037"><span class="annot"><span class="annottext">programLine :: DocLine
</span><a href="#local-6989586621679161037"><span class="hs-identifier hs-var hs-var">programLine</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DocLine -&gt; DocLine
</span><a href="Test.DocTest.Driver.Extract.Ast.html#trimExample"><span class="hs-identifier hs-var">trimExample</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(LineType, DocLine) -&gt; DocLine
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">(LineType, DocLine)
</span><a href="#local-6989586621679161033"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-588"></span><span>                </span><span id="local-6989586621679161038"><span class="annot"><span class="annottext">expectedOutput :: [DocLine]
</span><a href="#local-6989586621679161038"><span class="hs-identifier hs-var hs-var">expectedOutput</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DocLine] -&gt; [DocLine]
forall (t :: Type -&gt; Type). Traversable t =&gt; t DocLine -&gt; t DocLine
</span><a href="Test.DocTest.Driver.Extract.Ast.html#unindentLines"><span class="hs-identifier hs-var">unindentLines</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((LineType, DocLine) -&gt; DocLine)
-&gt; [(LineType, DocLine)] -&gt; [DocLine]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(LineType, DocLine) -&gt; DocLine
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">[(LineType, DocLine)]
</span><a href="#local-6989586621679161034"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-589"></span><span>        </span><span class="hs-comment">-- one example optionally followed by several responses</span><span>
</span><span id="line-590"></span><span>        </span><span id="local-6989586621679161042"><span class="annot"><span class="annottext">assocExampleLine :: LineType -&gt; LineType -&gt; Bool
</span><a href="#local-6989586621679161042"><span class="hs-identifier hs-var hs-var">assocExampleLine</span></a></span></span><span> </span><span id="local-6989586621679161043"><span class="annot"><span class="annottext">LineType
</span><a href="#local-6989586621679161043"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679161044"><span class="annot"><span class="annottext">LineType
</span><a href="#local-6989586621679161044"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LineType
</span><a href="#local-6989586621679161043"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">LineType -&gt; LineType -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">LineType
</span><a href="Test.DocTest.Driver.Extract.Ast.html#Example"><span class="hs-identifier hs-var">Example</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">LineType
</span><a href="#local-6989586621679161044"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">LineType -&gt; LineType -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">LineType
</span><a href="Test.DocTest.Driver.Extract.Ast.html#Other"><span class="hs-identifier hs-var">Other</span></a></span><span>
</span><span id="line-591"></span><span>        </span><span id="local-6989586621679161046"><span class="annot"><span class="annottext">groupExamples :: NonEmpty (LineType, b) -&gt; NonEmpty (NonEmpty (LineType, b))
</span><a href="#local-6989586621679161046"><span class="hs-identifier hs-var hs-var">groupExamples</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((LineType, b) -&gt; (LineType, b) -&gt; Bool)
-&gt; NonEmpty (LineType, b) -&gt; NonEmpty (NonEmpty (LineType, b))
forall a. (a -&gt; a -&gt; Bool) -&gt; NonEmpty a -&gt; NonEmpty (NonEmpty a)
</span><span class="hs-identifier hs-var">NonEmpty.groupBy1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LineType -&gt; LineType -&gt; Bool
</span><a href="#local-6989586621679161042"><span class="hs-identifier hs-var">assocExampleLine</span></a></span><span> </span><span class="annot"><span class="annottext">(LineType -&gt; LineType -&gt; Bool)
-&gt; ((LineType, b) -&gt; LineType)
-&gt; (LineType, b)
-&gt; (LineType, b)
-&gt; Bool
forall b c a. (b -&gt; b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; c
</span><span class="hs-operator hs-var">`on`</span></span><span> </span><span class="annot"><span class="annottext">(LineType, b) -&gt; LineType
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span>
</span><span id="line-592"></span><span>        </span><span id="local-6989586621679161022"><span class="annot"><span class="annottext">collectExample :: NonEmpty (LineType, DocLine) -&gt; DocGroup
</span><a href="#local-6989586621679161022"><span class="hs-identifier hs-var hs-var">collectExample</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NonEmpty ExampleLine -&gt; DocGroup
</span><a href="Test.DocTest.Driver.Extract.Ast.html#GExample"><span class="hs-identifier hs-var">GExample</span></a></span><span> </span><span class="annot"><span class="annottext">(NonEmpty ExampleLine -&gt; DocGroup)
-&gt; (NonEmpty (LineType, DocLine) -&gt; NonEmpty ExampleLine)
-&gt; NonEmpty (LineType, DocLine)
-&gt; DocGroup
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(NonEmpty (LineType, DocLine) -&gt; ExampleLine)
-&gt; NonEmpty (NonEmpty (LineType, DocLine)) -&gt; NonEmpty ExampleLine
forall a b. (a -&gt; b) -&gt; NonEmpty a -&gt; NonEmpty b
forall (f :: Type -&gt; Type) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty (LineType, DocLine) -&gt; ExampleLine
</span><a href="#local-6989586621679161032"><span class="hs-identifier hs-var">mkExampleLine</span></a></span><span> </span><span class="annot"><span class="annottext">(NonEmpty (NonEmpty (LineType, DocLine)) -&gt; NonEmpty ExampleLine)
-&gt; (NonEmpty (LineType, DocLine)
    -&gt; NonEmpty (NonEmpty (LineType, DocLine)))
-&gt; NonEmpty (LineType, DocLine)
-&gt; NonEmpty ExampleLine
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty (LineType, DocLine)
-&gt; NonEmpty (NonEmpty (LineType, DocLine))
forall {b}.
NonEmpty (LineType, b) -&gt; NonEmpty (NonEmpty (LineType, b))
</span><a href="#local-6989586621679161046"><span class="hs-identifier hs-var">groupExamples</span></a></span><span>
</span><span id="line-593"></span><span class="hs-comment">-- verbatim code are preserved for future processing</span><span>
</span><span id="line-594"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#toDocGroup"><span class="hs-identifier hs-var">toDocGroup</span></a></span><span> </span><span class="annot"><span class="annottext">LineType
</span><a href="Test.DocTest.Driver.Extract.Ast.html#Verbatim"><span class="hs-identifier hs-var">Verbatim</span></a></span><span> </span><span id="local-6989586621679161050"><span class="annot"><span class="annottext">NonEmpty (LineType, DocLine)
</span><a href="#local-6989586621679161050"><span class="hs-identifier hs-var">verbatimCode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DocGroup -&gt; Maybe DocGroup
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NonEmpty DocLine -&gt; DocGroup
</span><a href="Test.DocTest.Driver.Extract.Ast.html#GVerbatim"><span class="hs-identifier hs-var">GVerbatim</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty DocLine
</span><a href="#local-6989586621679161051"><span class="hs-identifier hs-var">verbatimLines</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-595"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679161051"><span class="annot"><span class="annottext">verbatimLines :: NonEmpty DocLine
</span><a href="#local-6989586621679161051"><span class="hs-identifier hs-var hs-var">verbatimLines</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NonEmpty DocLine -&gt; NonEmpty DocLine
forall (t :: Type -&gt; Type). Traversable t =&gt; t DocLine -&gt; t DocLine
</span><a href="Test.DocTest.Driver.Extract.Ast.html#unindentLines"><span class="hs-identifier hs-var">unindentLines</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((LineType, DocLine) -&gt; DocLine)
-&gt; NonEmpty (LineType, DocLine) -&gt; NonEmpty DocLine
forall a b. (a -&gt; b) -&gt; NonEmpty a -&gt; NonEmpty b
forall (f :: Type -&gt; Type) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DocLine -&gt; DocLine
</span><a href="Test.DocTest.Driver.Extract.Ast.html#trimVerbatim"><span class="hs-identifier hs-var">trimVerbatim</span></a></span><span> </span><span class="annot"><span class="annottext">(DocLine -&gt; DocLine)
-&gt; ((LineType, DocLine) -&gt; DocLine)
-&gt; (LineType, DocLine)
-&gt; DocLine
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(LineType, DocLine) -&gt; DocLine
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NonEmpty (LineType, DocLine)
</span><a href="#local-6989586621679161050"><span class="hs-identifier hs-var">verbatimCode</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-596"></span><span class="hs-comment">-- other lines are simply ignored</span><span>
</span><span id="line-597"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#toDocGroup"><span class="hs-identifier hs-var">toDocGroup</span></a></span><span> </span><span class="annot"><span class="annottext">LineType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty (LineType, DocLine)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe DocGroup
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-598"></span><span>
</span><span id="line-599"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#trimProperty"><span class="hs-identifier hs-type">trimProperty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#trimExample"><span class="hs-identifier hs-type">trimExample</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#trimVerbatim"><span class="hs-identifier hs-type">trimVerbatim</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocLine"><span class="hs-identifier hs-type">DocLine</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocLine"><span class="hs-identifier hs-type">DocLine</span></a></span><span>
</span><span id="line-600"></span><span id="trimProperty"><span class="annot"><span class="annottext">trimProperty :: DocLine -&gt; DocLine
</span><a href="Test.DocTest.Driver.Extract.Ast.html#trimProperty"><span class="hs-identifier hs-var hs-var">trimProperty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; DocLine -&gt; DocLine
</span><a href="Test.DocTest.Driver.Extract.Ast.html#trimPrefix"><span class="hs-identifier hs-var">trimPrefix</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;prop&gt;&quot;</span></span><span>
</span><span id="line-601"></span><span id="trimExample"><span class="annot"><span class="annottext">trimExample :: DocLine -&gt; DocLine
</span><a href="Test.DocTest.Driver.Extract.Ast.html#trimExample"><span class="hs-identifier hs-var hs-var">trimExample</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; DocLine -&gt; DocLine
</span><a href="Test.DocTest.Driver.Extract.Ast.html#trimPrefix"><span class="hs-identifier hs-var">trimPrefix</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;&gt;&gt;&gt;&quot;</span></span><span>
</span><span id="line-602"></span><span id="trimVerbatim"><span class="annot"><span class="annottext">trimVerbatim :: DocLine -&gt; DocLine
</span><a href="Test.DocTest.Driver.Extract.Ast.html#trimVerbatim"><span class="hs-identifier hs-var hs-var">trimVerbatim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe DocLine -&gt; DocLine
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="annot"><span class="annottext">(Maybe DocLine -&gt; DocLine)
-&gt; (DocLine -&gt; Maybe DocLine) -&gt; DocLine -&gt; DocLine
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; DocLine -&gt; Maybe DocLine
</span><a href="Test.DocTest.Driver.Extract.Ast.html#stripPrefix"><span class="hs-identifier hs-var">stripPrefix</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;&gt;&quot;</span></span><span> </span><span class="annot"><span class="annottext">(DocLine -&gt; Maybe DocLine)
-&gt; (DocLine -&gt; DocLine) -&gt; DocLine -&gt; Maybe DocLine
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">DocLine -&gt; DocLine
</span><a href="Test.DocTest.Driver.Extract.Ast.html#trimLeft"><span class="hs-identifier hs-var">trimLeft</span></a></span><span>
</span><span id="line-603"></span><span>
</span><span id="line-604"></span><span class="hs-keyword">data</span><span> </span><span id="LineType"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#LineType"><span class="hs-identifier hs-var">LineType</span></a></span></span><span>
</span><span id="line-605"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="Example"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Example"><span class="hs-identifier hs-var">Example</span></a></span></span><span>
</span><span id="line-606"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Property"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Property"><span class="hs-identifier hs-var">Property</span></a></span></span><span>
</span><span id="line-607"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Verbatim"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Verbatim"><span class="hs-identifier hs-var">Verbatim</span></a></span></span><span>
</span><span id="line-608"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Blank"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Blank"><span class="hs-identifier hs-var">Blank</span></a></span></span><span>
</span><span id="line-609"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Other"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Other"><span class="hs-identifier hs-var">Other</span></a></span></span><span>
</span><span id="line-610"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679161055"><span id="local-6989586621679161057"><span class="annot"><span class="annottext">LineType -&gt; LineType -&gt; Bool
(LineType -&gt; LineType -&gt; Bool)
-&gt; (LineType -&gt; LineType -&gt; Bool) -&gt; Eq LineType
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: LineType -&gt; LineType -&gt; Bool
== :: LineType -&gt; LineType -&gt; Bool
$c/= :: LineType -&gt; LineType -&gt; Bool
/= :: LineType -&gt; LineType -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679161060"><span id="local-6989586621679161062"><span id="local-6989586621679161066"><span class="annot"><span class="annottext">Int -&gt; LineType -&gt; ShowS
[LineType] -&gt; ShowS
LineType -&gt; [Char]
(Int -&gt; LineType -&gt; ShowS)
-&gt; (LineType -&gt; [Char]) -&gt; ([LineType] -&gt; ShowS) -&gt; Show LineType
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; LineType -&gt; ShowS
showsPrec :: Int -&gt; LineType -&gt; ShowS
$cshow :: LineType -&gt; [Char]
show :: LineType -&gt; [Char]
$cshowList :: [LineType] -&gt; ShowS
showList :: [LineType] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-611"></span><span>
</span><span id="line-612"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#pDocLineType"><span class="hs-identifier hs-type">pDocLineType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">R.ReadP</span></span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#LineType"><span class="hs-identifier hs-type">LineType</span></a></span><span>
</span><span id="line-613"></span><span id="pDocLineType"><span class="annot"><span class="annottext">pDocLineType :: ReadP LineType
</span><a href="Test.DocTest.Driver.Extract.Ast.html#pDocLineType"><span class="hs-identifier hs-var hs-var">pDocLineType</span></a></span></span><span>
</span><span id="line-614"></span><span>  </span><span class="hs-glyph">=</span><span>   </span><span class="annot"><span class="annottext">LineType
</span><a href="Test.DocTest.Driver.Extract.Ast.html#Blank"><span class="hs-identifier hs-var">Blank</span></a></span><span> </span><span class="annot"><span class="annottext">LineType -&gt; ReadP () -&gt; ReadP LineType
forall a b. a -&gt; ReadP b -&gt; ReadP a
forall (f :: Type -&gt; Type) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">ReadP ()
</span><span class="hs-identifier hs-var">R.eof</span></span><span>
</span><span id="line-615"></span><span>  </span><span class="annot"><span class="annottext">ReadP LineType -&gt; ReadP LineType -&gt; ReadP LineType
forall a. ReadP a -&gt; ReadP a -&gt; ReadP a
forall (f :: Type -&gt; Type) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">LineType
</span><a href="Test.DocTest.Driver.Extract.Ast.html#Example"><span class="hs-identifier hs-var">Example</span></a></span><span> </span><span class="annot"><span class="annottext">LineType -&gt; ReadP [Char] -&gt; ReadP LineType
forall a b. a -&gt; ReadP b -&gt; ReadP a
forall (f :: Type -&gt; Type) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ReadP [Char]
</span><span class="hs-identifier hs-var">R.string</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;&gt;&gt;&gt;&quot;</span></span><span> </span><span class="annot"><span class="annottext">ReadP LineType -&gt; ReadP () -&gt; ReadP LineType
forall a b. ReadP a -&gt; ReadP b -&gt; ReadP a
forall (f :: Type -&gt; Type) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">ReadP ()
</span><a href="#local-6989586621679161069"><span class="hs-identifier hs-var">nonGT</span></a></span><span>
</span><span id="line-616"></span><span>  </span><span class="annot"><span class="annottext">ReadP LineType -&gt; ReadP LineType -&gt; ReadP LineType
forall a. ReadP a -&gt; ReadP a -&gt; ReadP a
forall (f :: Type -&gt; Type) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">LineType
</span><a href="Test.DocTest.Driver.Extract.Ast.html#Verbatim"><span class="hs-identifier hs-var">Verbatim</span></a></span><span> </span><span class="annot"><span class="annottext">LineType -&gt; ReadP [Char] -&gt; ReadP LineType
forall a b. a -&gt; ReadP b -&gt; ReadP a
forall (f :: Type -&gt; Type) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ReadP [Char]
</span><span class="hs-identifier hs-var">R.string</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;&gt;&quot;</span></span><span> </span><span class="annot"><span class="annottext">ReadP LineType -&gt; ReadP () -&gt; ReadP LineType
forall a b. ReadP a -&gt; ReadP b -&gt; ReadP a
forall (f :: Type -&gt; Type) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">ReadP ()
</span><a href="#local-6989586621679161069"><span class="hs-identifier hs-var">nonGT</span></a></span><span>
</span><span id="line-617"></span><span>  </span><span class="annot"><span class="annottext">ReadP LineType -&gt; ReadP LineType -&gt; ReadP LineType
forall a. ReadP a -&gt; ReadP a -&gt; ReadP a
forall (f :: Type -&gt; Type) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">LineType
</span><a href="Test.DocTest.Driver.Extract.Ast.html#Property"><span class="hs-identifier hs-var">Property</span></a></span><span> </span><span class="annot"><span class="annottext">LineType -&gt; ReadP [Char] -&gt; ReadP LineType
forall a b. a -&gt; ReadP b -&gt; ReadP a
forall (f :: Type -&gt; Type) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ReadP [Char]
</span><span class="hs-identifier hs-var">R.string</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;prop&gt;&quot;</span></span><span> </span><span class="annot"><span class="annottext">ReadP LineType -&gt; ReadP () -&gt; ReadP LineType
forall a b. ReadP a -&gt; ReadP b -&gt; ReadP a
forall (f :: Type -&gt; Type) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">ReadP ()
</span><a href="#local-6989586621679161069"><span class="hs-identifier hs-var">nonGT</span></a></span><span>
</span><span id="line-618"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679161069"><span class="annot"><span class="annottext">nonGT :: ReadP ()
</span><a href="#local-6989586621679161069"><span class="hs-identifier hs-var hs-var">nonGT</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReadP Char -&gt; ReadP ()
forall (f :: Type -&gt; Type) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; ReadP Char
</span><span class="hs-identifier hs-var">R.satisfy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'&gt;'</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ReadP () -&gt; ReadP () -&gt; ReadP ()
forall a. ReadP a -&gt; ReadP a -&gt; ReadP a
forall (f :: Type -&gt; Type) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">ReadP ()
</span><span class="hs-identifier hs-var">R.eof</span></span><span>
</span><span id="line-619"></span><span>
</span><span id="line-620"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#docLineType"><span class="hs-identifier hs-type">docLineType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#LineType"><span class="hs-identifier hs-type">LineType</span></a></span><span>
</span><span id="line-621"></span><span id="docLineType"><span class="annot"><span class="annottext">docLineType :: [Char] -&gt; LineType
</span><a href="Test.DocTest.Driver.Extract.Ast.html#docLineType"><span class="hs-identifier hs-var hs-var">docLineType</span></a></span></span><span> </span><span id="local-6989586621679161074"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679161074"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ReadP LineType -&gt; ReadS LineType
forall a. ReadP a -&gt; ReadS a
</span><span class="hs-identifier hs-var">R.readP_to_S</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ReadP ()
</span><span class="hs-identifier hs-var">R.skipSpaces</span></span><span> </span><span class="annot"><span class="annottext">ReadP () -&gt; ReadP LineType -&gt; ReadP LineType
forall a b. ReadP a -&gt; ReadP b -&gt; ReadP b
forall (f :: Type -&gt; Type) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ReadP LineType
</span><a href="Test.DocTest.Driver.Extract.Ast.html#pDocLineType"><span class="hs-identifier hs-var">pDocLineType</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679161074"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-622"></span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LineType
</span><a href="Test.DocTest.Driver.Extract.Ast.html#Other"><span class="hs-identifier hs-var">Other</span></a></span><span>
</span><span id="line-623"></span><span>  </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621679161075"><span class="annot"><span class="annottext">LineType
</span><a href="#local-6989586621679161075"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LineType
</span><a href="#local-6989586621679161075"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-624"></span><span>  </span><span class="annot"><span class="annottext">(LineType, [Char])
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">(LineType, [Char])
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[(LineType, [Char])]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; LineType
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;impossible: no ambiguity allowed in LineType&quot;</span></span><span>
</span><span id="line-625"></span><span>
</span><span id="line-626"></span><span id="local-6989586621679159582"><span id="local-6989586621679159583"><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#groupByKey"><span class="hs-identifier hs-type">groupByKey</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679159582"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679159583"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679159583"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679159583"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679159582"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679159583"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679159583"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679159582"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span></span></span><span>
</span><span id="line-627"></span><span id="groupByKey"><span class="annot"><span class="annottext">groupByKey :: forall a k.
(a -&gt; k) -&gt; (k -&gt; k -&gt; Bool) -&gt; [a] -&gt; [(k, NonEmpty (k, a))]
</span><a href="Test.DocTest.Driver.Extract.Ast.html#groupByKey"><span class="hs-identifier hs-var hs-var">groupByKey</span></a></span></span><span> </span><span id="local-6989586621679161080"><span class="annot"><span class="annottext">a -&gt; k
</span><a href="#local-6989586621679161080"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span id="local-6989586621679161081"><span class="annot"><span class="annottext">k -&gt; k -&gt; Bool
</span><a href="#local-6989586621679161081"><span class="hs-identifier hs-var">cmp</span></a></span></span><span>
</span><span id="line-628"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(NonEmpty (k, a) -&gt; (k, NonEmpty (k, a)))
-&gt; [NonEmpty (k, a)] -&gt; [(k, NonEmpty (k, a))]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(k, a) -&gt; k
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((k, a) -&gt; k)
-&gt; (NonEmpty (k, a) -&gt; (k, a)) -&gt; NonEmpty (k, a) -&gt; k
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty (k, a) -&gt; (k, a)
forall a. NonEmpty a -&gt; a
</span><span class="hs-identifier hs-var">NonEmpty.head</span></span><span> </span><span class="annot"><span class="annottext">(NonEmpty (k, a) -&gt; k)
-&gt; (NonEmpty (k, a) -&gt; NonEmpty (k, a))
-&gt; NonEmpty (k, a)
-&gt; (k, NonEmpty (k, a))
forall b c c'. (b -&gt; c) -&gt; (b -&gt; c') -&gt; b -&gt; (c, c')
forall (a :: Type -&gt; Type -&gt; Type) b c c'.
Arrow a =&gt;
a b c -&gt; a b c' -&gt; a b (c, c')
</span><span class="hs-operator hs-var">&amp;&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty (k, a) -&gt; NonEmpty (k, a)
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span class="hs-special">)</span><span>
</span><span id="line-629"></span><span>  </span><span class="annot"><span class="annottext">([NonEmpty (k, a)] -&gt; [(k, NonEmpty (k, a))])
-&gt; ([a] -&gt; [NonEmpty (k, a)]) -&gt; [a] -&gt; [(k, NonEmpty (k, a))]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((k, a) -&gt; (k, a) -&gt; Bool) -&gt; [(k, a)] -&gt; [NonEmpty (k, a)]
forall (f :: Type -&gt; Type) a.
Foldable f =&gt;
(a -&gt; a -&gt; Bool) -&gt; f a -&gt; [NonEmpty a]
</span><span class="hs-identifier hs-var">NonEmpty.groupBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; k -&gt; Bool
</span><a href="#local-6989586621679161081"><span class="hs-identifier hs-var">cmp</span></a></span><span> </span><span class="annot"><span class="annottext">(k -&gt; k -&gt; Bool) -&gt; ((k, a) -&gt; k) -&gt; (k, a) -&gt; (k, a) -&gt; Bool
forall b c a. (b -&gt; b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; c
</span><span class="hs-operator hs-var">`on`</span></span><span> </span><span class="annot"><span class="annottext">(k, a) -&gt; k
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span>
</span><span id="line-630"></span><span>  </span><span class="annot"><span class="annottext">([(k, a)] -&gt; [NonEmpty (k, a)])
-&gt; ([a] -&gt; [(k, a)]) -&gt; [a] -&gt; [NonEmpty (k, a)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; (k, a)) -&gt; [a] -&gt; [(k, a)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; k
</span><a href="#local-6989586621679161080"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; k) -&gt; (a -&gt; a) -&gt; a -&gt; (k, a)
forall b c c'. (b -&gt; c) -&gt; (b -&gt; c') -&gt; b -&gt; (c, c')
forall (a :: Type -&gt; Type -&gt; Type) b c c'.
Arrow a =&gt;
a b c -&gt; a b c' -&gt; a b (c, c')
</span><span class="hs-operator hs-var">&amp;&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span class="hs-special">)</span><span>
</span><span id="line-631"></span><span>
</span><span id="line-632"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#assocLineType"><span class="hs-identifier hs-type">assocLineType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#LineType"><span class="hs-identifier hs-type">LineType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#LineType"><span class="hs-identifier hs-type">LineType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-633"></span><span class="hs-comment">-- properties are always one on each line</span><span>
</span><span id="line-634"></span><span id="assocLineType"><span class="annot"><span class="annottext">assocLineType :: LineType -&gt; LineType -&gt; Bool
</span><a href="Test.DocTest.Driver.Extract.Ast.html#assocLineType"><span class="hs-identifier hs-var hs-var">assocLineType</span></a></span></span><span> </span><span class="annot"><span class="annottext">LineType
</span><a href="Test.DocTest.Driver.Extract.Ast.html#Property"><span class="hs-identifier hs-var">Property</span></a></span><span> </span><span class="annot"><span class="annottext">LineType
</span><span class="hs-identifier">_</span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-635"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#assocLineType"><span class="hs-identifier hs-var">assocLineType</span></a></span><span> </span><span class="annot"><span class="annottext">LineType
</span><span class="hs-identifier">_</span></span><span>        </span><span class="annot"><span class="annottext">LineType
</span><a href="Test.DocTest.Driver.Extract.Ast.html#Property"><span class="hs-identifier hs-var">Property</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-636"></span><span class="hs-comment">-- examples are separated by blank lines</span><span>
</span><span id="line-637"></span><span class="hs-comment">-- multiple example program lines can be grouped together</span><span>
</span><span id="line-638"></span><span class="hs-comment">-- in this case the output will be in the same do block</span><span>
</span><span id="line-639"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#assocLineType"><span class="hs-identifier hs-var">assocLineType</span></a></span><span> </span><span class="annot"><span class="annottext">LineType
</span><a href="Test.DocTest.Driver.Extract.Ast.html#Example"><span class="hs-identifier hs-var">Example</span></a></span><span>  </span><span class="annot"><span class="annottext">LineType
</span><a href="Test.DocTest.Driver.Extract.Ast.html#Blank"><span class="hs-identifier hs-var">Blank</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-640"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#assocLineType"><span class="hs-identifier hs-var">assocLineType</span></a></span><span> </span><span class="annot"><span class="annottext">LineType
</span><a href="Test.DocTest.Driver.Extract.Ast.html#Example"><span class="hs-identifier hs-var">Example</span></a></span><span>  </span><span class="annot"><span class="annottext">LineType
</span><a href="Test.DocTest.Driver.Extract.Ast.html#Other"><span class="hs-identifier hs-var">Other</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-641"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#assocLineType"><span class="hs-identifier hs-var">assocLineType</span></a></span><span> </span><span class="annot"><span class="annottext">LineType
</span><a href="Test.DocTest.Driver.Extract.Ast.html#Example"><span class="hs-identifier hs-var">Example</span></a></span><span>  </span><span class="annot"><span class="annottext">LineType
</span><a href="Test.DocTest.Driver.Extract.Ast.html#Example"><span class="hs-identifier hs-var">Example</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-642"></span><span class="hs-comment">-- verbatim code is only joined with more verbatim code</span><span>
</span><span id="line-643"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#assocLineType"><span class="hs-identifier hs-var">assocLineType</span></a></span><span> </span><span class="annot"><span class="annottext">LineType
</span><a href="Test.DocTest.Driver.Extract.Ast.html#Verbatim"><span class="hs-identifier hs-var">Verbatim</span></a></span><span> </span><span class="annot"><span class="annottext">LineType
</span><a href="Test.DocTest.Driver.Extract.Ast.html#Verbatim"><span class="hs-identifier hs-var">Verbatim</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-644"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#assocLineType"><span class="hs-identifier hs-var">assocLineType</span></a></span><span> </span><span class="annot"><span class="annottext">LineType
</span><a href="Test.DocTest.Driver.Extract.Ast.html#Verbatim"><span class="hs-identifier hs-var">Verbatim</span></a></span><span> </span><span class="annot"><span class="annottext">LineType
</span><span class="hs-identifier">_</span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-645"></span><span class="hs-comment">-- now the first one is either blank or other, example can be started</span><span>
</span><span id="line-646"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#assocLineType"><span class="hs-identifier hs-var">assocLineType</span></a></span><span> </span><span class="annot"><span class="annottext">LineType
</span><span class="hs-identifier">_</span></span><span>        </span><span class="annot"><span class="annottext">LineType
</span><a href="Test.DocTest.Driver.Extract.Ast.html#Example"><span class="hs-identifier hs-var">Example</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-647"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#assocLineType"><span class="hs-identifier hs-var">assocLineType</span></a></span><span> </span><span class="annot"><span class="annottext">LineType
</span><span class="hs-identifier">_</span></span><span>        </span><span class="annot"><span class="annottext">LineType
</span><a href="Test.DocTest.Driver.Extract.Ast.html#Verbatim"><span class="hs-identifier hs-var">Verbatim</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-648"></span><span class="hs-comment">-- and everything else can be grouped and dropped</span><span>
</span><span id="line-649"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#assocLineType"><span class="hs-identifier hs-var">assocLineType</span></a></span><span> </span><span class="annot"><span class="annottext">LineType
</span><span class="hs-identifier">_</span></span><span>        </span><span class="annot"><span class="annottext">LineType
</span><span class="hs-identifier">_</span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-650"></span><span>
</span><span id="line-651"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#handleInstruction"><span class="hs-identifier hs-type">handleInstruction</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Instruction"><span class="hs-identifier hs-type">Instruction</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocLine"><span class="hs-identifier hs-type">DocLine</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#SetupCode"><span class="hs-identifier hs-type">SetupCode</span></a></span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocTests"><span class="hs-identifier hs-type">DocTests</span></a></span><span>
</span><span id="line-652"></span><span id="handleInstruction"><span class="annot"><span class="annottext">handleInstruction :: Instruction -&gt; [DocLine] -&gt; Either SetupCode DocTests
</span><a href="Test.DocTest.Driver.Extract.Ast.html#handleInstruction"><span class="hs-identifier hs-var hs-var">handleInstruction</span></a></span></span><span> </span><span id="local-6989586621679161085"><span class="annot"><span class="annottext">Instruction
</span><a href="#local-6989586621679161085"><span class="hs-identifier hs-var">instr</span></a></span></span><span> </span><span id="local-6989586621679161086"><span class="annot"><span class="annottext">[DocLine]
</span><a href="#local-6989586621679161086"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either SetupCode DocTests
-&gt; (NonEmpty DocLine -&gt; Either SetupCode DocTests)
-&gt; Maybe (NonEmpty DocLine)
-&gt; Either SetupCode DocTests
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DocTests -&gt; Either SetupCode DocTests
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">DocTests
</span><a href="#local-6989586621679161087"><span class="hs-identifier hs-var">warning</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Instruction -&gt; NonEmpty DocLine -&gt; Either SetupCode DocTests
</span><a href="Test.DocTest.Driver.Extract.Ast.html#handleInstructionNE"><span class="hs-identifier hs-var">handleInstructionNE</span></a></span><span> </span><span class="annot"><span class="annottext">Instruction
</span><a href="#local-6989586621679161085"><span class="hs-identifier hs-var">instr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[DocLine] -&gt; Maybe (NonEmpty DocLine)
forall a. [a] -&gt; Maybe (NonEmpty a)
</span><span class="hs-identifier hs-var">nonEmpty</span></span><span> </span><span class="annot"><span class="annottext">[DocLine]
</span><a href="#local-6989586621679161086"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-653"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679161087"><span class="annot"><span class="annottext">warning :: DocTests
</span><a href="#local-6989586621679161087"><span class="hs-identifier hs-var hs-var">warning</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Loc -&gt; [Char] -&gt; DocTests
</span><a href="Test.DocTest.Driver.Extract.Ast.html#Warning"><span class="hs-identifier hs-var">Warning</span></a></span><span> </span><span class="annot"><span class="annottext">Loc
</span><a href="Test.DocTest.Driver.Extract.Ast.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;instruction &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Instruction -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Instruction
</span><a href="#local-6989586621679161085"><span class="hs-identifier hs-var">instr</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; with a empty block&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-654"></span><span>
</span><span id="line-655"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#handleInstructionNE"><span class="hs-identifier hs-type">handleInstructionNE</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Instruction"><span class="hs-identifier hs-type">Instruction</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocLine"><span class="hs-identifier hs-type">DocLine</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#SetupCode"><span class="hs-identifier hs-type">SetupCode</span></a></span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocTests"><span class="hs-identifier hs-type">DocTests</span></a></span><span>
</span><span id="line-656"></span><span id="handleInstructionNE"><span class="annot"><span class="annottext">handleInstructionNE :: Instruction -&gt; NonEmpty DocLine -&gt; Either SetupCode DocTests
</span><a href="Test.DocTest.Driver.Extract.Ast.html#handleInstructionNE"><span class="hs-identifier hs-var hs-var">handleInstructionNE</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#SetupImport"><span class="hs-identifier hs-type">SetupImport</span></a></span><span> </span><span id="local-6989586621679161089"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679161089"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span>   </span><span id="local-6989586621679161090"><span class="annot"><span class="annottext">NonEmpty DocLine
</span><a href="#local-6989586621679161090"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SetupCode -&gt; Either SetupCode DocTests
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">SetupCode
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#%24sel%3AsetupImport%3ASetupCode"><span class="hs-identifier hs-var">setupImport</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679161089"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679161090"><span class="hs-identifier hs-type">ls</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-657"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#handleInstructionNE"><span class="hs-identifier hs-var">handleInstructionNE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#SetupOther"><span class="hs-identifier hs-type">SetupOther</span></a></span><span> </span><span id="local-6989586621679161091"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679161091"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span>    </span><span id="local-6989586621679161092"><span class="annot"><span class="annottext">NonEmpty DocLine
</span><a href="#local-6989586621679161092"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SetupCode -&gt; Either SetupCode DocTests
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">SetupCode
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#%24sel%3AsetupTop%3ASetupCode"><span class="hs-identifier hs-var">setupTop</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679161091"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679161092"><span class="hs-identifier hs-type">ls</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-658"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#handleInstructionNE"><span class="hs-identifier hs-var">handleInstructionNE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#SetupAuto"><span class="hs-identifier hs-type">SetupAuto</span></a></span><span> </span><span id="local-6989586621679161093"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679161093"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span>     </span><span id="local-6989586621679161094"><span class="annot"><span class="annottext">NonEmpty DocLine
</span><a href="#local-6989586621679161094"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SetupCode -&gt; Either SetupCode DocTests
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#SetupCode"><span class="hs-identifier hs-type">SetupCode</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">$sel:setupImport:SetupCode :: [([Char], NonEmpty DocLine)]
</span><a href="Test.DocTest.Driver.Extract.Ast.html#%24sel%3AsetupImport%3ASetupCode"><span class="hs-identifier hs-var">setupImport</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DocLine] -&gt; [([Char], NonEmpty DocLine)]
</span><a href="#local-6989586621679161095"><span class="hs-identifier hs-var">mk</span></a></span><span> </span><span class="annot"><span class="annottext">[DocLine]
</span><a href="#local-6989586621679161096"><span class="hs-identifier hs-var">imp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:setupTop:SetupCode :: [([Char], NonEmpty DocLine)]
</span><a href="Test.DocTest.Driver.Extract.Ast.html#%24sel%3AsetupTop%3ASetupCode"><span class="hs-identifier hs-var">setupTop</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DocLine] -&gt; [([Char], NonEmpty DocLine)]
</span><a href="#local-6989586621679161095"><span class="hs-identifier hs-var">mk</span></a></span><span> </span><span class="annot"><span class="annottext">[DocLine]
</span><a href="#local-6989586621679161097"><span class="hs-identifier hs-var">top</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-659"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679161096"><span class="annot"><span class="annottext">[DocLine]
</span><a href="#local-6989586621679161096"><span class="hs-identifier hs-var">imp</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679161097"><span class="annot"><span class="annottext">[DocLine]
</span><a href="#local-6989586621679161097"><span class="hs-identifier hs-var">top</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Either DocLine DocLine] -&gt; ([DocLine], [DocLine])
forall a b. [Either a b] -&gt; ([a], [b])
</span><span class="hs-identifier hs-var">partitionEithers</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DocLine -&gt; Either DocLine DocLine)
-&gt; [DocLine] -&gt; [Either DocLine DocLine]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">DocLine -&gt; Either DocLine DocLine
forall {b}. HasField &quot;textLine&quot; b [Char] =&gt; b -&gt; Either b b
</span><a href="#local-6989586621679161098"><span class="hs-identifier hs-var">isImport</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NonEmpty DocLine -&gt; [DocLine]
forall a. NonEmpty a -&gt; [a]
</span><span class="hs-identifier hs-var">NonEmpty.toList</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty DocLine
</span><a href="#local-6989586621679161094"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-660"></span><span>        </span><span id="local-6989586621679161098"><span class="annot"><span class="annottext">isImport :: b -&gt; Either b b
</span><a href="#local-6989586621679161098"><span class="hs-identifier hs-var hs-var">isImport</span></a></span></span><span> </span><span id="local-6989586621679161102"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679161102"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;import&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; Bool
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; Bool
</span><span class="hs-operator hs-var">`List.isPrefixOf`</span></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679161102"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">textLine</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">b -&gt; Either b b
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679161102"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">b -&gt; Either b b
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679161102"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-661"></span><span>        </span><span id="local-6989586621679161095"><span class="annot"><span class="annottext">mk :: [DocLine] -&gt; [([Char], NonEmpty DocLine)]
</span><a href="#local-6989586621679161095"><span class="hs-identifier hs-var hs-var">mk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[([Char], NonEmpty DocLine)]
-&gt; (NonEmpty DocLine -&gt; [([Char], NonEmpty DocLine)])
-&gt; Maybe (NonEmpty DocLine)
-&gt; [([Char], NonEmpty DocLine)]
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([Char], NonEmpty DocLine) -&gt; [([Char], NonEmpty DocLine)]
forall a. a -&gt; [a]
forall (f :: Type -&gt; Type) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(([Char], NonEmpty DocLine) -&gt; [([Char], NonEmpty DocLine)])
-&gt; (NonEmpty DocLine -&gt; ([Char], NonEmpty DocLine))
-&gt; NonEmpty DocLine
-&gt; [([Char], NonEmpty DocLine)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679161093"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe (NonEmpty DocLine) -&gt; [([Char], NonEmpty DocLine)])
-&gt; ([DocLine] -&gt; Maybe (NonEmpty DocLine))
-&gt; [DocLine]
-&gt; [([Char], NonEmpty DocLine)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[DocLine] -&gt; Maybe (NonEmpty DocLine)
forall a. [a] -&gt; Maybe (NonEmpty a)
</span><span class="hs-identifier hs-var">nonEmpty</span></span><span>
</span><span id="line-662"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#handleInstructionNE"><span class="hs-identifier hs-var">handleInstructionNE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#UseHook"><span class="hs-identifier hs-type">UseHook</span></a></span><span> </span><span id="local-6989586621679161104"><span class="annot"><span class="annottext">HookFlavour
</span><a href="#local-6989586621679161104"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621679161105"><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621679161105"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span>    </span><span id="local-6989586621679161106"><span class="annot"><span class="annottext">NonEmpty DocLine
</span><a href="#local-6989586621679161106"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DocTests -&gt; Either SetupCode DocTests
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IOHook -&gt; [DocTests] -&gt; DocTests
</span><a href="Test.DocTest.Driver.Extract.Ast.html#TestHook"><span class="hs-identifier hs-var">TestHook</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HookFlavour -&gt; [[Char]] -&gt; NonEmpty DocLine -&gt; IOHook
</span><a href="Test.DocTest.Driver.Extract.Ast.html#IOHook"><span class="hs-identifier hs-var">IOHook</span></a></span><span> </span><span class="annot"><span class="annottext">HookFlavour
</span><a href="#local-6989586621679161104"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621679161105"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty DocLine
</span><a href="#local-6989586621679161106"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-663"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#handleInstructionNE"><span class="hs-identifier hs-var">handleInstructionNE</span></a></span><span> </span><span class="annot"><span class="annottext">Instruction
</span><a href="Test.DocTest.Driver.Extract.Ast.html#IsExample"><span class="hs-identifier hs-var">IsExample</span></a></span><span>         </span><span id="local-6989586621679161107"><span class="annot"><span class="annottext">NonEmpty DocLine
</span><a href="#local-6989586621679161107"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DocTests -&gt; Either SetupCode DocTests
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NonEmpty DocLine -&gt; DocTests
</span><a href="Test.DocTest.Driver.Extract.Ast.html#TestMultiline"><span class="hs-identifier hs-var">TestMultiline</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty DocLine
</span><a href="#local-6989586621679161107"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-664"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#handleInstructionNE"><span class="hs-identifier hs-var">handleInstructionNE</span></a></span><span> </span><span class="annot"><span class="annottext">Instruction
</span><a href="Test.DocTest.Driver.Extract.Ast.html#IsProperty"><span class="hs-identifier hs-var">IsProperty</span></a></span><span>        </span><span id="local-6989586621679161108"><span class="annot"><span class="annottext">NonEmpty DocLine
</span><a href="#local-6989586621679161108"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DocTests -&gt; Either SetupCode DocTests
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NonEmpty DocLine -&gt; DocTests
</span><a href="Test.DocTest.Driver.Extract.Ast.html#TestProperty"><span class="hs-identifier hs-var">TestProperty</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty DocLine
</span><a href="#local-6989586621679161108"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-665"></span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#handleInstructionNE"><span class="hs-identifier hs-var">handleInstructionNE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#CaptureText"><span class="hs-identifier hs-type">CaptureText</span></a></span><span> </span><span id="local-6989586621679161109"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679161109"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679161110"><span class="annot"><span class="annottext">CaptureMethod
</span><a href="#local-6989586621679161110"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679161111"><span class="annot"><span class="annottext">NonEmpty DocLine
</span><a href="#local-6989586621679161111"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DocTests -&gt; Either SetupCode DocTests
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CapturedContent -&gt; [DocTests] -&gt; DocTests
</span><a href="Test.DocTest.Driver.Extract.Ast.html#Capture"><span class="hs-identifier hs-var">Capture</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; CaptureMethod -&gt; NonEmpty [Char] -&gt; CapturedContent
</span><a href="Test.DocTest.Driver.Extract.Ast.html#Captured"><span class="hs-identifier hs-var">Captured</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679161109"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CaptureMethod
</span><a href="#local-6989586621679161110"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DocLine -&gt; [Char]) -&gt; NonEmpty DocLine -&gt; NonEmpty [Char]
forall a b. (a -&gt; b) -&gt; NonEmpty a -&gt; NonEmpty b
forall (f :: Type -&gt; Type) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-operator">.</span><span class="hs-identifier">textLine</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NonEmpty DocLine
</span><a href="#local-6989586621679161111"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-666"></span></pre></body></html>