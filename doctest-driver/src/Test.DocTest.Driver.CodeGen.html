<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- | Description: DocTest code generation.</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- Copyright: Copyright 2024, Ruifeng Xie</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- License: AGPL-3.0-or-later</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Maintainer: Ruifeng Xie &lt;ruifengx@outlook.com&gt;</span><span>
</span><span id="line-5"></span><span class="hs-comment">--</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Generating DocTests from extracted information.</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-8"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Test.DocTest.Driver.CodeGen</span><span>
</span><span id="line-9"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#CodeGen"><span class="hs-identifier">CodeGen</span></a></span><span>
</span><span id="line-10"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#Doc"><span class="hs-identifier">Doc</span></a></span><span>
</span><span id="line-11"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#runDoc"><span class="hs-identifier">runDoc</span></a></span><span>
</span><span id="line-12"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#genModuleDoc"><span class="hs-identifier">genModuleDoc</span></a></span><span>
</span><span id="line-13"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#codeGen"><span class="hs-identifier">codeGen</span></a></span><span>
</span><span id="line-14"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#codeGenSingle"><span class="hs-identifier">codeGenSingle</span></a></span><span>
</span><span id="line-15"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-16"></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.html"><span class="hs-identifier">Test.DocTest.Driver.Extract</span></a></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Dump.html"><span class="hs-identifier">Test.DocTest.Driver.Extract.Dump</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Dump.html#hPrintDoc"><span class="hs-identifier">hPrintDoc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Arrow</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Arrow</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">second</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(&amp;&amp;&amp;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">unless</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">when</span></span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Reader</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">MonadReader</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ask</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">local</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ReaderT</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">asks</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">runReaderT</span></span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.State</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">MonadState</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">get</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">put</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">State</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">evalState</span></span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Writer</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">MonadWriter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">pass</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">tell</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">WriterT</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">execWriterT</span></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Char</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">isSpace</span></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Coerce</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">coerce</span></span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fold</span></span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">intercalate</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">intersperse</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">uncons</span></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NonEmpty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(:|)</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NonEmpty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromList</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">head</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">toList</span></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromJust</span></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Monoid</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Ap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Ap</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.String</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">IsString</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromString</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">showLitString</span></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Directory</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">createDirectoryIfMissing</span></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.FilePath</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">takeDirectory</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(&lt;/&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">IOMode</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">WriteMode</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">withFile</span></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Data.FastString</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">FastString</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">unpackFS</span></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Types.SrcLoc</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">RealSrcLoc</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">srcLocCol</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">srcLocFile</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">srcLocLine</span></span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Utils.Ppr</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">P</span></span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Version</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">showVersion</span></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PackageInfo_doctest_driver.html"><span class="hs-identifier">PackageInfo_doctest_driver</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Info</span></span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span class="hs-keyword">newtype</span><span> </span><span id="MDoc"><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#MDoc"><span class="hs-identifier hs-var">MDoc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="MDoc"><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#MDoc"><span class="hs-identifier hs-var">MDoc</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">P.Doc</span></span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679162832"><span id="local-6989586621679162836"><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#MDoc"><span class="hs-identifier hs-type">MDoc</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-49"></span><span>  </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#MDoc"><span class="hs-identifier hs-type">MDoc</span></a></span><span> </span><span id="local-6989586621679162841"><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679162841"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679162842"><span class="annot"><span class="annottext">&lt;&gt; :: MDoc -&gt; MDoc -&gt; MDoc
</span><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;&gt;</span></span></span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#MDoc"><span class="hs-identifier hs-type">MDoc</span></a></span><span> </span><span id="local-6989586621679162843"><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679162843"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; MDoc
</span><a href="Test.DocTest.Driver.CodeGen.html#MDoc"><span class="hs-identifier hs-var">MDoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679162841"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">P.&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679162843"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679162849"><span id="local-6989586621679162852"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#MDoc"><span class="hs-identifier hs-type">MDoc</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-52"></span><span>  </span><span id="local-6989586621679162855"><span class="annot"><span class="annottext">mempty :: MDoc
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; MDoc
</span><a href="Test.DocTest.Driver.CodeGen.html#MDoc"><span class="hs-identifier hs-var">MDoc</span></a></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-identifier hs-var">P.empty</span></span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span class="hs-keyword">type</span><span> </span><span id="FileLine"><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#FileLine"><span class="hs-identifier hs-var">FileLine</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FastString</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="hs-keyword">type</span><span> </span><span id="MFileLine"><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#MFileLine"><span class="hs-identifier hs-var">MFileLine</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#FileLine"><span class="hs-identifier hs-type">FileLine</span></a></span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span class="hs-keyword">type</span><span> </span><span id="CodeGenM"><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#CodeGenM"><span class="hs-identifier hs-var">CodeGenM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WriterT</span></span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#MDoc"><span class="hs-identifier hs-type">MDoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#MFileLine"><span class="hs-identifier hs-type">MFileLine</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span class="hs-comment">-- | Code generation monad.</span><span>
</span><span id="line-60"></span><span class="hs-comment">--</span><span>
</span><span id="line-61"></span><span class="hs-comment">-- * Collects generated text in a GHC 'P.Doc'.</span><span>
</span><span id="line-62"></span><span class="hs-comment">-- * Tracks the file name and the line number for current line. We emit @{-# LINE ... #-}@ pragmas</span><span>
</span><span id="line-63"></span><span class="hs-comment">--   into the generated modules, but line numbers also increase by one naturally after a linebreak.</span><span>
</span><span id="line-64"></span><span class="hs-comment">--   If the file name does not change, and the natural line number matches the expected one, then</span><span>
</span><span id="line-65"></span><span class="hs-comment">--   we omit the @{-# LINE ... #-}@ pragma to avoid cluttering the output.</span><span>
</span><span id="line-66"></span><span class="hs-keyword">newtype</span><span> </span><span id="CodeGen"><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#CodeGen"><span class="hs-identifier hs-var">CodeGen</span></a></span></span><span> </span><span id="local-6989586621679162345"><span class="annot"><a href="#local-6989586621679162345"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Doc"><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#Doc"><span class="hs-identifier hs-var">Doc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#CodeGenM"><span class="hs-identifier hs-type">CodeGenM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679162345"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679162861"><span id="local-6989586621679162867"><span id="local-6989586621679162874"><span class="annot"><span class="annottext">NonEmpty (CodeGen a) -&gt; CodeGen a
CodeGen a -&gt; CodeGen a -&gt; CodeGen a
(CodeGen a -&gt; CodeGen a -&gt; CodeGen a)
-&gt; (NonEmpty (CodeGen a) -&gt; CodeGen a)
-&gt; (forall b. Integral b =&gt; b -&gt; CodeGen a -&gt; CodeGen a)
-&gt; Semigroup (CodeGen a)
forall b. Integral b =&gt; b -&gt; CodeGen a -&gt; CodeGen a
forall a. Semigroup a =&gt; NonEmpty (CodeGen a) -&gt; CodeGen a
forall a. Semigroup a =&gt; CodeGen a -&gt; CodeGen a -&gt; CodeGen a
forall a b.
(Semigroup a, Integral b) =&gt;
b -&gt; CodeGen a -&gt; CodeGen a
forall a.
(a -&gt; a -&gt; a)
-&gt; (NonEmpty a -&gt; a)
-&gt; (forall b. Integral b =&gt; b -&gt; a -&gt; a)
-&gt; Semigroup a
$c&lt;&gt; :: forall a. Semigroup a =&gt; CodeGen a -&gt; CodeGen a -&gt; CodeGen a
&lt;&gt; :: CodeGen a -&gt; CodeGen a -&gt; CodeGen a
$csconcat :: forall a. Semigroup a =&gt; NonEmpty (CodeGen a) -&gt; CodeGen a
sconcat :: NonEmpty (CodeGen a) -&gt; CodeGen a
$cstimes :: forall a b.
(Semigroup a, Integral b) =&gt;
b -&gt; CodeGen a -&gt; CodeGen a
stimes :: forall b. Integral b =&gt; b -&gt; CodeGen a -&gt; CodeGen a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Semigroup</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679162886"><span id="local-6989586621679162892"><span id="local-6989586621679162897"><span class="annot"><span class="annottext">Semigroup (CodeGen a)
CodeGen a
Semigroup (CodeGen a) =&gt;
CodeGen a
-&gt; (CodeGen a -&gt; CodeGen a -&gt; CodeGen a)
-&gt; ([CodeGen a] -&gt; CodeGen a)
-&gt; Monoid (CodeGen a)
[CodeGen a] -&gt; CodeGen a
CodeGen a -&gt; CodeGen a -&gt; CodeGen a
forall a.
Semigroup a =&gt;
a -&gt; (a -&gt; a -&gt; a) -&gt; ([a] -&gt; a) -&gt; Monoid a
forall a. Monoid a =&gt; Semigroup (CodeGen a)
forall a. Monoid a =&gt; CodeGen a
forall a. Monoid a =&gt; [CodeGen a] -&gt; CodeGen a
forall a. Monoid a =&gt; CodeGen a -&gt; CodeGen a -&gt; CodeGen a
$cmempty :: forall a. Monoid a =&gt; CodeGen a
mempty :: CodeGen a
$cmappend :: forall a. Monoid a =&gt; CodeGen a -&gt; CodeGen a -&gt; CodeGen a
mappend :: CodeGen a -&gt; CodeGen a -&gt; CodeGen a
$cmconcat :: forall a. Monoid a =&gt; [CodeGen a] -&gt; CodeGen a
mconcat :: [CodeGen a] -&gt; CodeGen a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Monoid</span></span></span></span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">via</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ap</span></span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#CodeGenM"><span class="hs-identifier hs-type">CodeGenM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679162345"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-68"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679162903"><span id="local-6989586621679162908"><span class="annot"><span class="annottext">(forall a b. (a -&gt; b) -&gt; CodeGen a -&gt; CodeGen b)
-&gt; (forall a b. a -&gt; CodeGen b -&gt; CodeGen a) -&gt; Functor CodeGen
forall a b. a -&gt; CodeGen b -&gt; CodeGen a
forall a b. (a -&gt; b) -&gt; CodeGen a -&gt; CodeGen b
forall (f :: Type -&gt; Type).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
$cfmap :: forall a b. (a -&gt; b) -&gt; CodeGen a -&gt; CodeGen b
fmap :: forall a b. (a -&gt; b) -&gt; CodeGen a -&gt; CodeGen b
$c&lt;$ :: forall a b. a -&gt; CodeGen b -&gt; CodeGen a
&lt;$ :: forall a b. a -&gt; CodeGen b -&gt; CodeGen a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679162915"><span id="local-6989586621679162919"><span id="local-6989586621679162923"><span id="local-6989586621679162927"><span id="local-6989586621679162931"><span class="annot"><span class="annottext">Functor CodeGen
Functor CodeGen =&gt;
(forall a. a -&gt; CodeGen a)
-&gt; (forall a b. CodeGen (a -&gt; b) -&gt; CodeGen a -&gt; CodeGen b)
-&gt; (forall a b c.
    (a -&gt; b -&gt; c) -&gt; CodeGen a -&gt; CodeGen b -&gt; CodeGen c)
-&gt; (forall a b. CodeGen a -&gt; CodeGen b -&gt; CodeGen b)
-&gt; (forall a b. CodeGen a -&gt; CodeGen b -&gt; CodeGen a)
-&gt; Applicative CodeGen
forall a. a -&gt; CodeGen a
forall a b. CodeGen a -&gt; CodeGen b -&gt; CodeGen a
forall a b. CodeGen a -&gt; CodeGen b -&gt; CodeGen b
forall a b. CodeGen (a -&gt; b) -&gt; CodeGen a -&gt; CodeGen b
forall a b c. (a -&gt; b -&gt; c) -&gt; CodeGen a -&gt; CodeGen b -&gt; CodeGen c
forall (f :: Type -&gt; Type).
Functor f =&gt;
(forall a. a -&gt; f a)
-&gt; (forall a b. f (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b c. (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c)
-&gt; (forall a b. f a -&gt; f b -&gt; f b)
-&gt; (forall a b. f a -&gt; f b -&gt; f a)
-&gt; Applicative f
$cpure :: forall a. a -&gt; CodeGen a
pure :: forall a. a -&gt; CodeGen a
$c&lt;*&gt; :: forall a b. CodeGen (a -&gt; b) -&gt; CodeGen a -&gt; CodeGen b
&lt;*&gt; :: forall a b. CodeGen (a -&gt; b) -&gt; CodeGen a -&gt; CodeGen b
$cliftA2 :: forall a b c. (a -&gt; b -&gt; c) -&gt; CodeGen a -&gt; CodeGen b -&gt; CodeGen c
liftA2 :: forall a b c. (a -&gt; b -&gt; c) -&gt; CodeGen a -&gt; CodeGen b -&gt; CodeGen c
$c*&gt; :: forall a b. CodeGen a -&gt; CodeGen b -&gt; CodeGen b
*&gt; :: forall a b. CodeGen a -&gt; CodeGen b -&gt; CodeGen b
$c&lt;* :: forall a b. CodeGen a -&gt; CodeGen b -&gt; CodeGen a
&lt;* :: forall a b. CodeGen a -&gt; CodeGen b -&gt; CodeGen a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Applicative</span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679162938"><span id="local-6989586621679162943"><span id="local-6989586621679162947"><span class="annot"><span class="annottext">Applicative CodeGen
Applicative CodeGen =&gt;
(forall a b. CodeGen a -&gt; (a -&gt; CodeGen b) -&gt; CodeGen b)
-&gt; (forall a b. CodeGen a -&gt; CodeGen b -&gt; CodeGen b)
-&gt; (forall a. a -&gt; CodeGen a)
-&gt; Monad CodeGen
forall a. a -&gt; CodeGen a
forall a b. CodeGen a -&gt; CodeGen b -&gt; CodeGen b
forall a b. CodeGen a -&gt; (a -&gt; CodeGen b) -&gt; CodeGen b
forall (m :: Type -&gt; Type).
Applicative m =&gt;
(forall a b. m a -&gt; (a -&gt; m b) -&gt; m b)
-&gt; (forall a b. m a -&gt; m b -&gt; m b)
-&gt; (forall a. a -&gt; m a)
-&gt; Monad m
$c&gt;&gt;= :: forall a b. CodeGen a -&gt; (a -&gt; CodeGen b) -&gt; CodeGen b
&gt;&gt;= :: forall a b. CodeGen a -&gt; (a -&gt; CodeGen b) -&gt; CodeGen b
$c&gt;&gt; :: forall a b. CodeGen a -&gt; CodeGen b -&gt; CodeGen b
&gt;&gt; :: forall a b. CodeGen a -&gt; CodeGen b -&gt; CodeGen b
$creturn :: forall a. a -&gt; CodeGen a
return :: forall a. a -&gt; CodeGen a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Monad</span></span></span></span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">via</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#CodeGenM"><span class="hs-identifier hs-type">CodeGenM</span></a></span><span>
</span><span id="line-69"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679162954"><span id="local-6989586621679162960"><span id="local-6989586621679162965"><span class="annot"><span class="hs-identifier hs-type">MonadReader</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679162976"><span id="local-6989586621679162980"><span id="local-6989586621679162984"><span id="local-6989586621679162988"><span class="annot"><span class="hs-identifier hs-type">MonadWriter</span></span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#MDoc"><span class="hs-identifier hs-type">MDoc</span></a></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679162995"><span id="local-6989586621679163000"><span id="local-6989586621679163004"><span class="annot"><span class="hs-identifier hs-type">MonadState</span></span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#MFileLine"><span class="hs-identifier hs-type">MFileLine</span></a></span></span></span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">via</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#CodeGenM"><span class="hs-identifier hs-type">CodeGenM</span></a></span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span class="annot"><span class="hs-comment">-- | A document is code generation without a separate result.</span></span><span>
</span><span id="line-72"></span><span class="hs-keyword">type</span><span> </span><span id="Doc"><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#Doc"><span class="hs-identifier hs-var">Doc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#CodeGen"><span class="hs-identifier hs-type">CodeGen</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#wrapDoc"><span class="hs-identifier hs-type">wrapDoc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">P.Doc</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span>
</span><span id="line-75"></span><span id="wrapDoc"><span class="annot"><span class="annottext">wrapDoc :: Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#wrapDoc"><span class="hs-identifier hs-var hs-var">wrapDoc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CodeGenM () -&gt; Doc
forall a. CodeGenM a -&gt; CodeGen a
</span><a href="Test.DocTest.Driver.CodeGen.html#Doc"><span class="hs-identifier hs-var">Doc</span></a></span><span> </span><span class="annot"><span class="annottext">(CodeGenM () -&gt; Doc) -&gt; (Doc -&gt; CodeGenM ()) -&gt; Doc -&gt; Doc
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">MDoc -&gt; CodeGenM ()
forall w (m :: Type -&gt; Type). MonadWriter w m =&gt; w -&gt; m ()
</span><span class="hs-identifier hs-var">tell</span></span><span> </span><span class="annot"><span class="annottext">(MDoc -&gt; CodeGenM ()) -&gt; (Doc -&gt; MDoc) -&gt; Doc -&gt; CodeGenM ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; MDoc
</span><a href="Test.DocTest.Driver.CodeGen.html#MDoc"><span class="hs-identifier hs-var">MDoc</span></a></span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span class="annot"><span class="hs-comment">-- | Run the code generation and get the generated GHC 'P.Doc'.</span></span><span>
</span><span id="line-78"></span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#runDoc"><span class="hs-identifier hs-type">runDoc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">P.Doc</span></span><span>
</span><span id="line-79"></span><span id="runDoc"><span class="annot"><span class="annottext">runDoc :: [String] -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#runDoc"><span class="hs-identifier hs-var hs-var">runDoc</span></a></span></span><span> </span><span id="local-6989586621679163010"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679163010"><span class="hs-identifier hs-var">vars</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span> </span><span id="local-6989586621679163011"><span class="annot"><span class="annottext">CodeGenM ()
</span><a href="#local-6989586621679163011"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679163012"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-80"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#MDoc"><span class="hs-identifier hs-type">MDoc</span></a></span><span> </span><span id="local-6989586621679163012"><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679163012"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State MFileLine MDoc -&gt; MFileLine -&gt; MDoc
forall s a. State s a -&gt; s -&gt; a
</span><span class="hs-identifier hs-var">evalState</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ReaderT [String] (State MFileLine) MDoc
-&gt; [String] -&gt; State MFileLine MDoc
forall r (m :: Type -&gt; Type) a. ReaderT r m a -&gt; r -&gt; m a
</span><span class="hs-identifier hs-var">runReaderT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CodeGenM () -&gt; ReaderT [String] (State MFileLine) MDoc
forall (m :: Type -&gt; Type) w a. Monad m =&gt; WriterT w m a -&gt; m w
</span><span class="hs-identifier hs-var">execWriterT</span></span><span> </span><span class="annot"><span class="annottext">CodeGenM ()
</span><a href="#local-6989586621679163011"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679163010"><span class="hs-identifier hs-var">vars</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MFileLine
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IsString</span></span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-83"></span><span>  </span><span id="local-6989586621679163015"><span class="annot"><span class="annottext">fromString :: String -&gt; Doc
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fromString</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#text"><span class="hs-identifier hs-var">text</span></a></span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span>
</span><span id="line-86"></span><span id="text"><span class="annot"><span class="annottext">text :: String -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#text"><span class="hs-identifier hs-var hs-var">text</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#wrapDoc"><span class="hs-identifier hs-var">wrapDoc</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; Doc) -&gt; (String -&gt; Doc) -&gt; String -&gt; Doc
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">P.text</span></span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span id="local-6989586621679162358"><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#textShow"><span class="hs-identifier hs-type">textShow</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679162358"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679162358"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span></span><span>
</span><span id="line-89"></span><span id="textShow"><span class="annot"><span class="annottext">textShow :: forall a. Show a =&gt; a -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#textShow"><span class="hs-identifier hs-var hs-var">textShow</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Doc) -&gt; (a -&gt; String) -&gt; a -&gt; Doc
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">6</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span>
</span><span id="line-92"></span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#%3C%2B%3E"><span class="hs-operator hs-type">(&lt;+&gt;)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span>
</span><span id="line-93"></span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span> </span><span id="local-6989586621679163023"><span class="annot"><span class="annottext">CodeGenM ()
</span><a href="#local-6989586621679163023"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="%3C%2B%3E"><span class="annot"><span class="annottext">&lt;+&gt; :: Doc -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#%3C%2B%3E"><span class="hs-operator hs-var hs-var">&lt;+&gt;</span></a></span></span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span> </span><span id="local-6989586621679163024"><span class="annot"><span class="annottext">CodeGenM ()
</span><a href="#local-6989586621679163024"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CodeGenM () -&gt; Doc
forall a. CodeGenM a -&gt; CodeGen a
</span><a href="Test.DocTest.Driver.CodeGen.html#Doc"><span class="hs-identifier hs-var">Doc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ReaderT [String] (State MFileLine) ((), MDoc) -&gt; CodeGenM ()
forall w (m :: Type -&gt; Type) a. m (a, w) -&gt; WriterT w m a
</span><span class="hs-identifier hs-var">WriterT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MDoc -&gt; MDoc -&gt; ((), MDoc)
</span><a href="#local-6989586621679163026"><span class="hs-identifier hs-var">combine</span></a></span><span> </span><span class="annot"><span class="annottext">(MDoc -&gt; MDoc -&gt; ((), MDoc))
-&gt; ReaderT [String] (State MFileLine) MDoc
-&gt; ReaderT [String] (State MFileLine) (MDoc -&gt; ((), MDoc))
forall (f :: Type -&gt; Type) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">CodeGenM () -&gt; ReaderT [String] (State MFileLine) MDoc
forall (m :: Type -&gt; Type) w a. Monad m =&gt; WriterT w m a -&gt; m w
</span><span class="hs-identifier hs-var">execWriterT</span></span><span> </span><span class="annot"><span class="annottext">CodeGenM ()
</span><a href="#local-6989586621679163023"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderT [String] (State MFileLine) (MDoc -&gt; ((), MDoc))
-&gt; ReaderT [String] (State MFileLine) MDoc
-&gt; ReaderT [String] (State MFileLine) ((), MDoc)
forall a b.
ReaderT [String] (State MFileLine) (a -&gt; b)
-&gt; ReaderT [String] (State MFileLine) a
-&gt; ReaderT [String] (State MFileLine) b
forall (f :: Type -&gt; Type) a b.
Applicative f =&gt;
f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">CodeGenM () -&gt; ReaderT [String] (State MFileLine) MDoc
forall (m :: Type -&gt; Type) w a. Monad m =&gt; WriterT w m a -&gt; m w
</span><span class="hs-identifier hs-var">execWriterT</span></span><span> </span><span class="annot"><span class="annottext">CodeGenM ()
</span><a href="#local-6989586621679163024"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-94"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679163026"><span class="annot"><span class="annottext">combine :: MDoc -&gt; MDoc -&gt; ((), MDoc)
</span><a href="#local-6989586621679163026"><span class="hs-identifier hs-var hs-var">combine</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#MDoc"><span class="hs-identifier hs-type">MDoc</span></a></span><span> </span><span id="local-6989586621679163028"><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679163028"><span class="hs-identifier hs-var">dl</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#MDoc"><span class="hs-identifier hs-type">MDoc</span></a></span><span> </span><span id="local-6989586621679163029"><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679163029"><span class="hs-identifier hs-var">dr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; MDoc
</span><a href="Test.DocTest.Driver.CodeGen.html#MDoc"><span class="hs-identifier hs-var">MDoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679163028"><span class="hs-identifier hs-var">dl</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">P.&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679163029"><span class="hs-identifier hs-var">dr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span class="hs-keyword">infixl</span><span> </span><span class="hs-number">5</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#%24%24"><span class="hs-operator hs-type">$$</span></a></span><span>
</span><span id="line-97"></span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#%24%24"><span class="hs-operator hs-type">($$)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span>
</span><span id="line-98"></span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span> </span><span id="local-6989586621679163032"><span class="annot"><span class="annottext">CodeGenM ()
</span><a href="#local-6989586621679163032"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="%24%24"><span class="annot"><span class="annottext">$$ :: Doc -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#%24%24"><span class="hs-operator hs-var hs-var">$$</span></a></span></span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span> </span><span id="local-6989586621679163033"><span class="annot"><span class="annottext">CodeGenM ()
</span><a href="#local-6989586621679163033"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CodeGenM () -&gt; Doc
forall a. CodeGenM a -&gt; CodeGen a
</span><a href="Test.DocTest.Driver.CodeGen.html#Doc"><span class="hs-identifier hs-var">Doc</span></a></span><span> </span><span class="annot"><span class="annottext">(CodeGenM () -&gt; Doc) -&gt; CodeGenM () -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ReaderT [String] (State MFileLine) ((), MDoc) -&gt; CodeGenM ()
forall w (m :: Type -&gt; Type) a. m (a, w) -&gt; WriterT w m a
</span><span class="hs-identifier hs-var">WriterT</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-99"></span><span>  </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#MDoc"><span class="hs-identifier hs-type">MDoc</span></a></span><span> </span><span id="local-6989586621679163034"><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679163034"><span class="hs-identifier hs-var">dl</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeGenM () -&gt; ReaderT [String] (State MFileLine) MDoc
forall (m :: Type -&gt; Type) w a. Monad m =&gt; WriterT w m a -&gt; m w
</span><span class="hs-identifier hs-var">execWriterT</span></span><span> </span><span class="annot"><span class="annottext">CodeGenM ()
</span><a href="#local-6989586621679163032"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-100"></span><span>  </span><span id="local-6989586621679163035"><span class="annot"><span class="annottext">MFileLine
</span><a href="#local-6989586621679163035"><span class="hs-identifier hs-var">originalLoc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReaderT [String] (State MFileLine) MFileLine
forall s (m :: Type -&gt; Type). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-101"></span><span>  </span><span class="annot"><span class="annottext">Bool
-&gt; ReaderT [String] (State MFileLine) ()
-&gt; ReaderT [String] (State MFileLine) ()
forall (f :: Type -&gt; Type). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc -&gt; Bool
</span><span class="hs-identifier hs-var">P.isEmpty</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679163034"><span class="hs-identifier hs-var">dl</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MFileLine -&gt; ReaderT [String] (State MFileLine) ()
forall s (m :: Type -&gt; Type). MonadState s m =&gt; s -&gt; m ()
</span><span class="hs-identifier hs-var">put</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((FastString, Int) -&gt; (FastString, Int)) -&gt; MFileLine -&gt; MFileLine
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: Type -&gt; Type) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; (FastString, Int) -&gt; (FastString, Int)
forall b c d. (b -&gt; c) -&gt; (d, b) -&gt; (d, c)
forall (a :: Type -&gt; Type -&gt; Type) b c d.
Arrow a =&gt;
a b c -&gt; a (d, b) (d, c)
</span><span class="hs-identifier hs-var">second</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int
forall a. Enum a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">succ</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MFileLine
</span><a href="#local-6989586621679163035"><span class="hs-identifier hs-var">originalLoc</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span>  </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#MDoc"><span class="hs-identifier hs-type">MDoc</span></a></span><span> </span><span id="local-6989586621679163038"><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679163038"><span class="hs-identifier hs-var">dr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeGenM () -&gt; ReaderT [String] (State MFileLine) MDoc
forall (m :: Type -&gt; Type) w a. Monad m =&gt; WriterT w m a -&gt; m w
</span><span class="hs-identifier hs-var">execWriterT</span></span><span> </span><span class="annot"><span class="annottext">CodeGenM ()
</span><a href="#local-6989586621679163033"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-103"></span><span>  </span><span class="annot"><span class="annottext">Bool
-&gt; ReaderT [String] (State MFileLine) ()
-&gt; ReaderT [String] (State MFileLine) ()
forall (f :: Type -&gt; Type). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc -&gt; Bool
</span><span class="hs-identifier hs-var">P.isEmpty</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679163038"><span class="hs-identifier hs-var">dr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MFileLine -&gt; ReaderT [String] (State MFileLine) ()
forall s (m :: Type -&gt; Type). MonadState s m =&gt; s -&gt; m ()
</span><span class="hs-identifier hs-var">put</span></span><span> </span><span class="annot"><span class="annottext">MFileLine
</span><a href="#local-6989586621679163035"><span class="hs-identifier hs-var">originalLoc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span>  </span><span class="annot"><span class="annottext">((), MDoc) -&gt; ReaderT [String] (State MFileLine) ((), MDoc)
forall a. a -&gt; ReaderT [String] (State MFileLine) a
forall (f :: Type -&gt; Type) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; MDoc
</span><a href="Test.DocTest.Driver.CodeGen.html#MDoc"><span class="hs-identifier hs-var">MDoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679163034"><span class="hs-identifier hs-var">dl</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">P.$$</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679163038"><span class="hs-identifier hs-var">dr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span id="local-6989586621679162376"><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#hcat"><span class="hs-identifier hs-type">hcat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Foldable</span></span><span> </span><span class="annot"><a href="#local-6989586621679162376"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679162376"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span></span><span>
</span><span id="line-107"></span><span id="hcat"><span class="annot"><span class="annottext">hcat :: forall (f :: Type -&gt; Type). Foldable f =&gt; f Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#hcat"><span class="hs-identifier hs-var hs-var">hcat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f Doc -&gt; Doc
forall m. Monoid m =&gt; f m -&gt; m
forall (t :: Type -&gt; Type) m. (Foldable t, Monoid m) =&gt; t m -&gt; m
</span><span class="hs-identifier hs-var">fold</span></span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span id="local-6989586621679163044"><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#vcat"><span class="hs-identifier hs-type">vcat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Foldable</span></span><span> </span><span class="annot"><a href="#local-6989586621679163044"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679163044"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span></span><span>
</span><span id="line-110"></span><span id="vcat"><span class="annot"><span class="annottext">vcat :: forall (f :: Type -&gt; Type). Foldable f =&gt; f Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#vcat"><span class="hs-identifier hs-var hs-var">vcat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; Doc -&gt; Doc) -&gt; Doc -&gt; f Doc -&gt; Doc
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; f a -&gt; b
forall (t :: Type -&gt; Type) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#%24%24"><span class="hs-operator hs-var">($$)</span></a></span><span> </span><span class="annot"><span class="annottext">Doc
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#emptyText"><span class="hs-identifier hs-type">emptyText</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span>
</span><span id="line-113"></span><span id="emptyText"><span class="annot"><span class="annottext">emptyText :: Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#emptyText"><span class="hs-identifier hs-var hs-var">emptyText</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#wrapDoc"><span class="hs-identifier hs-var">wrapDoc</span></a></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-identifier hs-var">P.emptyText</span></span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#nest"><span class="hs-identifier hs-type">nest</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span>
</span><span id="line-116"></span><span id="nest"><span class="annot"><span class="annottext">nest :: Int -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#nest"><span class="hs-identifier hs-var hs-var">nest</span></a></span></span><span> </span><span id="local-6989586621679163053"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679163053"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CodeGen ((), MDoc -&gt; MDoc) -&gt; Doc
forall a. CodeGen (a, MDoc -&gt; MDoc) -&gt; CodeGen a
forall w (m :: Type -&gt; Type) a.
MonadWriter w m =&gt;
m (a, w -&gt; w) -&gt; m a
</span><span class="hs-identifier hs-var">pass</span></span><span> </span><span class="annot"><span class="annottext">(CodeGen ((), MDoc -&gt; MDoc) -&gt; Doc)
-&gt; (Doc -&gt; CodeGen ((), MDoc -&gt; MDoc)) -&gt; Doc -&gt; Doc
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(() -&gt; ((), MDoc -&gt; MDoc)) -&gt; Doc -&gt; CodeGen ((), MDoc -&gt; MDoc)
forall a b. (a -&gt; b) -&gt; CodeGen a -&gt; CodeGen b
forall (f :: Type -&gt; Type) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; Doc) -&gt; MDoc -&gt; MDoc
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Doc -&gt; Doc
</span><span class="hs-identifier hs-var">P.nest</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679163053"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span>
</span><span id="line-118"></span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#realLocDoc"><span class="hs-identifier hs-type">realLocDoc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RealSrcLoc</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span>
</span><span id="line-119"></span><span id="realLocDoc"><span class="annot"><span class="annottext">realLocDoc :: Doc -&gt; RealSrcLoc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#realLocDoc"><span class="hs-identifier hs-var hs-var">realLocDoc</span></a></span></span><span> </span><span id="local-6989586621679163056"><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679163056"><span class="hs-identifier hs-var">prefix</span></a></span></span><span> </span><span id="local-6989586621679163057"><span class="annot"><span class="annottext">RealSrcLoc
</span><a href="#local-6989586621679163057"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-120"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679163059"><span class="annot"><span class="annottext">lineInfo :: RealSrcLoc -&gt; (FastString, Int)
</span><a href="#local-6989586621679163059"><span class="hs-identifier hs-var hs-var">lineInfo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RealSrcLoc -&gt; FastString
</span><span class="hs-identifier hs-var">srcLocFile</span></span><span> </span><span class="annot"><span class="annottext">(RealSrcLoc -&gt; FastString)
-&gt; (RealSrcLoc -&gt; Int) -&gt; RealSrcLoc -&gt; (FastString, Int)
forall b c c'. (b -&gt; c) -&gt; (b -&gt; c') -&gt; b -&gt; (c, c')
forall (a :: Type -&gt; Type -&gt; Type) b c c'.
Arrow a =&gt;
a b c -&gt; a b c' -&gt; a b (c, c')
</span><span class="hs-operator hs-var">&amp;&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">RealSrcLoc -&gt; Int
</span><span class="hs-identifier hs-var">srcLocLine</span></span><span>
</span><span id="line-121"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679163060"><span class="annot"><span class="annottext">newInfo :: (FastString, Int)
</span><a href="#local-6989586621679163060"><span class="hs-identifier hs-var">newInfo</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679163061"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621679163061"><span class="hs-identifier hs-var">file</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679163062"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679163062"><span class="hs-identifier hs-var">line</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RealSrcLoc -&gt; (FastString, Int)
</span><a href="#local-6989586621679163059"><span class="hs-identifier hs-var">lineInfo</span></a></span><span> </span><span class="annot"><span class="annottext">RealSrcLoc
</span><a href="#local-6989586621679163057"><span class="hs-identifier hs-var">loc</span></a></span><span>
</span><span id="line-122"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679163063"><span class="annot"><span class="annottext">linePragma :: Doc
</span><a href="#local-6989586621679163063"><span class="hs-identifier hs-var hs-var">linePragma</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;{-# LINE &quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Doc
forall a. Show a =&gt; a -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#textShow"><span class="hs-identifier hs-var">textShow</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679163062"><span class="hs-identifier hs-var">line</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">FastString -&gt; Doc
forall a. Show a =&gt; a -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#textShow"><span class="hs-identifier hs-var">textShow</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621679163061"><span class="hs-identifier hs-var">file</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot; #-}&quot;</span></span><span>
</span><span id="line-123"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679163064"><span class="annot"><span class="annottext">colPragma :: Doc
</span><a href="#local-6989586621679163064"><span class="hs-identifier hs-var hs-var">colPragma</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679163056"><span class="hs-identifier hs-var">prefix</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;{-# COLUMN &quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Doc
forall a. Show a =&gt; a -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#textShow"><span class="hs-identifier hs-var">textShow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RealSrcLoc -&gt; Int
</span><span class="hs-identifier hs-var">srcLocCol</span></span><span> </span><span class="annot"><span class="annottext">RealSrcLoc
</span><a href="#local-6989586621679163057"><span class="hs-identifier hs-var">loc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot; #-}&quot;</span></span><span>
</span><span id="line-124"></span><span>  </span><span id="local-6989586621679163065"><span class="annot"><span class="annottext">MFileLine
</span><a href="#local-6989586621679163065"><span class="hs-identifier hs-var">currentLoc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeGen MFileLine
forall s (m :: Type -&gt; Type). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-125"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">MFileLine
</span><a href="#local-6989586621679163065"><span class="hs-identifier hs-var">currentLoc</span></a></span><span> </span><span class="annot"><span class="annottext">MFileLine -&gt; MFileLine -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">(FastString, Int) -&gt; MFileLine
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(FastString, Int)
</span><a href="#local-6989586621679163060"><span class="hs-identifier hs-var">newInfo</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679163064"><span class="hs-identifier hs-var">colPragma</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679163063"><span class="hs-identifier hs-var">linePragma</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679163064"><span class="hs-identifier hs-var">colPragma</span></a></span><span>
</span><span id="line-126"></span><span>  </span><span class="annot"><span class="annottext">MFileLine -&gt; Doc
forall s (m :: Type -&gt; Type). MonadState s m =&gt; s -&gt; m ()
</span><span class="hs-identifier hs-var">put</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(FastString, Int) -&gt; MFileLine
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(FastString, Int)
</span><a href="#local-6989586621679163060"><span class="hs-identifier hs-var">newInfo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#locDoc"><span class="hs-identifier hs-type">locDoc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Loc"><span class="hs-identifier hs-type">Loc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span>
</span><span id="line-129"></span><span id="locDoc"><span class="annot"><span class="annottext">locDoc :: Doc -&gt; Loc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#locDoc"><span class="hs-identifier hs-var hs-var">locDoc</span></a></span></span><span> </span><span id="local-6989586621679163067"><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679163067"><span class="hs-identifier hs-var">prefix</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FastString -&gt; Doc) -&gt; (RealSrcLoc -&gt; Doc) -&gt; Loc -&gt; Doc
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc -&gt; FastString -&gt; Doc
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679163067"><span class="hs-identifier hs-var">prefix</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc -&gt; RealSrcLoc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#realLocDoc"><span class="hs-identifier hs-var">realLocDoc</span></a></span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679163067"><span class="hs-identifier hs-var">prefix</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-130"></span><span>
</span><span id="line-131"></span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#locLine"><span class="hs-identifier hs-type">locLine</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Loc"><span class="hs-identifier hs-type">Loc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-132"></span><span id="locLine"><span class="annot"><span class="annottext">locLine :: Loc -&gt; String
</span><a href="Test.DocTest.Driver.CodeGen.html#locLine"><span class="hs-identifier hs-var hs-var">locLine</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FastString -&gt; String) -&gt; (RealSrcLoc -&gt; String) -&gt; Loc -&gt; String
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="annot"><span class="annottext">FastString -&gt; String
</span><span class="hs-identifier hs-var">unpackFS</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679163071"><span class="annot"><span class="annottext">RealSrcLoc
</span><a href="#local-6989586621679163071"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;line &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RealSrcLoc -&gt; Int
</span><span class="hs-identifier hs-var">srcLocLine</span></span><span> </span><span class="annot"><span class="annottext">RealSrcLoc
</span><a href="#local-6989586621679163071"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#noteGenerated"><span class="hs-identifier hs-type">noteGenerated</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span>
</span><span id="line-135"></span><span id="noteGenerated"><span class="annot"><span class="annottext">noteGenerated :: Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#noteGenerated"><span class="hs-identifier hs-var hs-var">noteGenerated</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;-- autogenerated by &quot;</span></span><span>
</span><span id="line-136"></span><span>  </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="PackageInfo_doctest_driver.html#name"><span class="hs-identifier hs-var">Info.name</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Version -&gt; String
</span><span class="hs-identifier hs-var">showVersion</span></span><span> </span><span class="annot"><span class="annottext">Version
</span><a href="PackageInfo_doctest_driver.html#version"><span class="hs-identifier hs-var">Info.version</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span>  </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;, edits will be overwritten upon next build&quot;</span></span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span class="annot"><span class="hs-comment">-- | Code generation entry-point for an extracted 'Module'.</span></span><span>
</span><span id="line-140"></span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#genModuleDoc"><span class="hs-identifier hs-type">genModuleDoc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Module"><span class="hs-identifier hs-type">Module</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span>
</span><span id="line-141"></span><span id="genModuleDoc"><span class="annot"><span class="annottext">genModuleDoc :: Module -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#genModuleDoc"><span class="hs-identifier hs-var hs-var">genModuleDoc</span></a></span></span><span> </span><span id="local-6989586621679163076"><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621679163076"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
forall (f :: Type -&gt; Type). Foldable f =&gt; f Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span>
</span><span id="line-142"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#noteGenerated"><span class="hs-identifier hs-var">noteGenerated</span></a></span><span>
</span><span id="line-143"></span><span>  </span><span class="hs-comment">-- this is unfortunate, but we must import the target module unconditionally, and when the</span><span>
</span><span id="line-144"></span><span>  </span><span class="hs-comment">-- doctests do not use anything from that module (e.g., when there is no doctest at all), the</span><span>
</span><span id="line-145"></span><span>  </span><span class="hs-comment">-- import becomes redundant and triggers a warning</span><span>
</span><span id="line-146"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;{-# OPTIONS_GHC -Wno-unused-imports #-}&quot;</span></span><span>
</span><span id="line-147"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;module DocTests.&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679163077"><span class="hs-identifier hs-var">modulePath</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot; (spec) where&quot;</span></span><span>
</span><span id="line-148"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#emptyText"><span class="hs-identifier hs-var">emptyText</span></a></span><span>
</span><span id="line-149"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;import Test.Hspec&quot;</span></span><span>
</span><span id="line-150"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;import Test.Hspec.QuickCheck&quot;</span></span><span>
</span><span id="line-151"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;import Test.DocTest.Support&quot;</span></span><span>
</span><span id="line-152"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#emptyText"><span class="hs-identifier hs-var">emptyText</span></a></span><span>
</span><span id="line-153"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;import &quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679163077"><span class="hs-identifier hs-var">modulePath</span></a></span><span>
</span><span id="line-154"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#emptyText"><span class="hs-identifier hs-var">emptyText</span></a></span><span>
</span><span id="line-155"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
forall (f :: Type -&gt; Type). Foldable f =&gt; f Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DocLine -&gt; Doc) -&gt; [DocLine] -&gt; [Doc]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">DocLine -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#genImport"><span class="hs-identifier hs-var">genImport</span></a></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621679163076"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">importList</span><span class="hs-special">)</span><span>
</span><span id="line-156"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#emptyText"><span class="hs-identifier hs-var">emptyText</span></a></span><span>
</span><span id="line-157"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
forall (f :: Type -&gt; Type). Foldable f =&gt; f Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DocLine -&gt; Doc) -&gt; [DocLine] -&gt; [Doc]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">DocLine -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#lineDoc"><span class="hs-identifier hs-var">lineDoc</span></a></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621679163076"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">topSetup</span><span class="hs-special">)</span><span>
</span><span id="line-158"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#emptyText"><span class="hs-identifier hs-var">emptyText</span></a></span><span>
</span><span id="line-159"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;spec :: Spec&quot;</span></span><span>
</span><span id="line-160"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[DocTests] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: Type -&gt; Type) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621679163076"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">testCases</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;spec = pure ()&quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679163081"><span class="hs-identifier hs-var">header</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679163082"><span class="hs-identifier hs-var">contents</span></a></span><span>
</span><span id="line-161"></span><span>  </span><span class="hs-special">]</span><span>
</span><span id="line-162"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679163077"><span class="annot"><span class="annottext">modulePath :: String
</span><a href="#local-6989586621679163077"><span class="hs-identifier hs-var hs-var">modulePath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; String
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">intercalate</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.&quot;</span></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621679163076"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">modulePath</span><span>
</span><span id="line-163"></span><span>        </span><span id="local-6989586621679163082"><span class="annot"><span class="annottext">contents :: Doc
</span><a href="#local-6989586621679163082"><span class="hs-identifier hs-var hs-var">contents</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
forall (f :: Type -&gt; Type). Foldable f =&gt; f Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DocTests -&gt; Doc) -&gt; [DocTests] -&gt; [Doc]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">DocTests -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#genDocTests"><span class="hs-identifier hs-var">genDocTests</span></a></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621679163076"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">testCases</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-164"></span><span>        </span><span id="local-6989586621679163081"><span class="annot"><span class="annottext">header :: Doc
</span><a href="#local-6989586621679163081"><span class="hs-identifier hs-var hs-var">header</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;spec = describe &quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
forall a. Show a =&gt; a -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#textShow"><span class="hs-identifier hs-var">textShow</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679163077"><span class="hs-identifier hs-var">modulePath</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot; $ do&quot;</span></span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#lineDoc"><span class="hs-identifier hs-type">lineDoc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocLine"><span class="hs-identifier hs-type">DocLine</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span>
</span><span id="line-167"></span><span id="lineDoc"><span class="annot"><span class="annottext">lineDoc :: DocLine -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#lineDoc"><span class="hs-identifier hs-var hs-var">lineDoc</span></a></span></span><span> </span><span id="local-6989586621679163084"><span class="annot"><span class="annottext">DocLine
</span><a href="#local-6989586621679163084"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679163085"><span class="hs-identifier hs-var">white</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Loc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#locDoc"><span class="hs-identifier hs-var">locDoc</span></a></span><span> </span><span class="annot"><span class="annottext">Doc
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">DocLine
</span><a href="#local-6989586621679163086"><span class="hs-identifier hs-var">real</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">location</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">DocLine
</span><a href="#local-6989586621679163086"><span class="hs-identifier hs-var">real</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">textLine</span><span>
</span><span id="line-168"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679163085"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679163085"><span class="hs-identifier hs-var">white</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679163086"><span class="annot"><span class="annottext">DocLine
</span><a href="#local-6989586621679163086"><span class="hs-identifier hs-var">real</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; DocLine -&gt; (String, DocLine)
</span><a href="Test.DocTest.Driver.Extract.Ast.html#spanDocLine"><span class="hs-identifier hs-var">spanDocLine</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isSpace</span></span><span> </span><span class="annot"><span class="annottext">DocLine
</span><a href="#local-6989586621679163084"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-169"></span><span>
</span><span id="line-170"></span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#genImport"><span class="hs-identifier hs-type">genImport</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocLine"><span class="hs-identifier hs-type">DocLine</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span>
</span><span id="line-171"></span><span id="genImport"><span class="annot"><span class="annottext">genImport :: DocLine -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#genImport"><span class="hs-identifier hs-var hs-var">genImport</span></a></span></span><span> </span><span id="local-6989586621679163088"><span class="annot"><span class="annottext">DocLine
</span><a href="#local-6989586621679163088"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Loc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#locDoc"><span class="hs-identifier hs-var">locDoc</span></a></span><span> </span><span class="annot"><span class="annottext">Doc
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">DocLine
</span><a href="#local-6989586621679163088"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">location</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">DocLine
</span><a href="#local-6989586621679163088"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">textLine</span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#genDocTestList"><span class="hs-identifier hs-type">genDocTestList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocTests"><span class="hs-identifier hs-type">DocTests</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span>
</span><span id="line-174"></span><span id="genDocTestList"><span class="annot"><span class="annottext">genDocTestList :: Maybe Doc -&gt; [DocTests] -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#genDocTestList"><span class="hs-identifier hs-var hs-var">genDocTestList</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679163090"><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679163090"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;pendingWith \&quot;group with&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679163090"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;but no test\&quot;&quot;</span></span><span>
</span><span id="line-175"></span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#genDocTestList"><span class="hs-identifier hs-var">genDocTestList</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Doc
</span><span class="hs-identifier hs-var">Nothing</span></span><span>     </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;pure ()&quot;</span></span><span>
</span><span id="line-176"></span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#genDocTestList"><span class="hs-identifier hs-var">genDocTestList</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Doc
</span><span class="hs-identifier">_</span></span><span>           </span><span id="local-6989586621679163091"><span class="annot"><span class="annottext">[DocTests]
</span><a href="#local-6989586621679163091"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
forall (f :: Type -&gt; Type). Foldable f =&gt; f Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DocTests -&gt; Doc) -&gt; [DocTests] -&gt; [Doc]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">DocTests -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#genDocTests"><span class="hs-identifier hs-var">genDocTests</span></a></span><span> </span><span class="annot"><span class="annottext">[DocTests]
</span><a href="#local-6989586621679163091"><span class="hs-identifier hs-var">ts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-177"></span><span>
</span><span id="line-178"></span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#genDocTests"><span class="hs-identifier hs-type">genDocTests</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocTests"><span class="hs-identifier hs-type">DocTests</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span>
</span><span id="line-179"></span><span id="genDocTests"><span class="annot"><span class="annottext">genDocTests :: DocTests -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#genDocTests"><span class="hs-identifier hs-var hs-var">genDocTests</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Group"><span class="hs-identifier hs-type">Group</span></a></span><span> </span><span id="local-6989586621679163093"><span class="annot"><span class="annottext">Entity
</span><a href="#local-6989586621679163093"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679163094"><span class="annot"><span class="annottext">Loc
</span><a href="#local-6989586621679163094"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621679163095"><span class="annot"><span class="annottext">[DocTests]
</span><a href="#local-6989586621679163095"><span class="hs-identifier hs-var">tests</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679163096"><span class="hs-identifier hs-var">header</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Doc -&gt; [DocTests] -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#genDocTestList"><span class="hs-identifier hs-var">genDocTestList</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Doc
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">[DocTests]
</span><a href="#local-6989586621679163095"><span class="hs-identifier hs-var">tests</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-180"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679163096"><span class="annot"><span class="annottext">header :: Doc
</span><a href="#local-6989586621679163096"><span class="hs-identifier hs-var hs-var">header</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;describe &quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
forall a. Show a =&gt; a -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#textShow"><span class="hs-identifier hs-var">textShow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Entity -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Entity
</span><a href="#local-6989586621679163093"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679163097"><span class="hs-identifier hs-var">groupName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot; $ do&quot;</span></span><span>
</span><span id="line-181"></span><span>        </span><span id="local-6989586621679163097"><span class="annot"><span class="annottext">groupName :: String
</span><a href="#local-6989586621679163097"><span class="hs-identifier hs-var hs-var">groupName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FastString -&gt; String) -&gt; (RealSrcLoc -&gt; String) -&gt; Loc -&gt; String
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString -&gt; String
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679163098"><span class="annot"><span class="annottext">RealSrcLoc
</span><a href="#local-6989586621679163098"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; (line &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RealSrcLoc -&gt; Int
</span><span class="hs-identifier hs-var">srcLocLine</span></span><span> </span><span class="annot"><span class="annottext">RealSrcLoc
</span><a href="#local-6989586621679163098"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Loc
</span><a href="#local-6989586621679163094"><span class="hs-identifier hs-var">loc</span></a></span><span>
</span><span id="line-182"></span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#genDocTests"><span class="hs-identifier hs-var">genDocTests</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#TestExample"><span class="hs-identifier hs-type">TestExample</span></a></span><span> </span><span id="local-6989586621679163100"><span class="annot"><span class="annottext">NonEmpty ExampleLine
</span><a href="#local-6989586621679163100"><span class="hs-identifier hs-var">exampleLines</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679163101"><span class="hs-identifier hs-var">header</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679163102"><span class="hs-identifier hs-var">contents</span></a></span><span>
</span><span id="line-183"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679163101"><span class="annot"><span class="annottext">header :: Doc
</span><a href="#local-6989586621679163101"><span class="hs-identifier hs-var hs-var">header</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;it&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679163103"><span class="hs-keyword hs-var">label</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;$&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#bindVars"><span class="hs-identifier hs-var">bindVars</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;do&quot;</span></span><span>
</span><span id="line-184"></span><span>        </span><span id="local-6989586621679163103"><span class="annot"><span class="annottext">label :: Doc
</span><a href="#local-6989586621679163103"><span class="hs-keyword hs-var hs-var">label</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
forall a. Show a =&gt; a -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#textShow"><span class="hs-identifier hs-var">textShow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;example group (&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Loc -&gt; String
</span><a href="Test.DocTest.Driver.CodeGen.html#locLine"><span class="hs-identifier hs-var">locLine</span></a></span><span> </span><span class="annot"><span class="annottext">Loc
</span><a href="#local-6989586621679163105"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-185"></span><span>        </span><span id="local-6989586621679163105"><span class="annot"><span class="annottext">loc :: Loc
</span><a href="#local-6989586621679163105"><span class="hs-identifier hs-var hs-var">loc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679163106"><span class="annot"><span class="annottext">l :: ExampleLine
</span><a href="#local-6989586621679163106"><span class="hs-identifier hs-var hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NonEmpty ExampleLine -&gt; ExampleLine
forall a. NonEmpty a -&gt; a
</span><span class="hs-identifier hs-var">NonEmpty.head</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty ExampleLine
</span><a href="#local-6989586621679163100"><span class="hs-identifier hs-var">exampleLines</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">ExampleLine
</span><a href="#local-6989586621679163106"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">programLine</span><span class="hs-operator">.</span><span class="hs-identifier">location</span><span>
</span><span id="line-186"></span><span>        </span><span id="local-6989586621679163102"><span class="annot"><span class="annottext">contents :: Doc
</span><a href="#local-6989586621679163102"><span class="hs-identifier hs-var hs-var">contents</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#markVarsUsed"><span class="hs-identifier hs-var">markVarsUsed</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty Doc -&gt; Doc
forall (f :: Type -&gt; Type). Foldable f =&gt; f Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ExampleLine -&gt; Doc) -&gt; NonEmpty ExampleLine -&gt; NonEmpty Doc
forall a b. (a -&gt; b) -&gt; NonEmpty a -&gt; NonEmpty b
forall (f :: Type -&gt; Type) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">ExampleLine -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#genExample"><span class="hs-identifier hs-var">genExample</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty ExampleLine
</span><a href="#local-6989586621679163100"><span class="hs-identifier hs-var">exampleLines</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-187"></span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#genDocTests"><span class="hs-identifier hs-var">genDocTests</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#TestProperty"><span class="hs-identifier hs-type">TestProperty</span></a></span><span> </span><span id="local-6989586621679163110"><span class="annot"><span class="annottext">NonEmpty DocLine
</span><a href="#local-6989586621679163110"><span class="hs-identifier hs-var">propLine</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NonEmpty DocLine -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#genProperty"><span class="hs-identifier hs-var">genProperty</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty DocLine
</span><a href="#local-6989586621679163110"><span class="hs-identifier hs-var">propLine</span></a></span><span>
</span><span id="line-188"></span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#genDocTests"><span class="hs-identifier hs-var">genDocTests</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#TestMultiline"><span class="hs-identifier hs-type">TestMultiline</span></a></span><span> </span><span id="local-6989586621679163113"><span class="annot"><span class="annottext">NonEmpty DocLine
</span><a href="#local-6989586621679163113"><span class="hs-identifier hs-var">testLines</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NonEmpty DocLine -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#genMultiline"><span class="hs-identifier hs-var">genMultiline</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty DocLine
</span><a href="#local-6989586621679163113"><span class="hs-identifier hs-var">testLines</span></a></span><span>
</span><span id="line-189"></span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#genDocTests"><span class="hs-identifier hs-var">genDocTests</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#TestHook"><span class="hs-identifier hs-type">TestHook</span></a></span><span> </span><span id="local-6989586621679163116"><span class="annot"><span class="annottext">IOHook
</span><a href="#local-6989586621679163116"><span class="hs-identifier hs-var">hook</span></a></span></span><span> </span><span id="local-6989586621679163117"><span class="annot"><span class="annottext">[DocTests]
</span><a href="#local-6989586621679163117"><span class="hs-identifier hs-var">tests</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IOHook -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#genHook"><span class="hs-identifier hs-var">genHook</span></a></span><span> </span><span class="annot"><span class="annottext">IOHook
</span><a href="#local-6989586621679163116"><span class="hs-identifier hs-var">hook</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Doc -&gt; [DocTests] -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#genDocTestList"><span class="hs-identifier hs-var">genDocTestList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc -&gt; Maybe Doc
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;hook&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[DocTests]
</span><a href="#local-6989586621679163117"><span class="hs-identifier hs-var">tests</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-190"></span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#genDocTests"><span class="hs-identifier hs-var">genDocTests</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Capture"><span class="hs-identifier hs-type">Capture</span></a></span><span> </span><span id="local-6989586621679163120"><span class="annot"><span class="annottext">CapturedContent
</span><a href="#local-6989586621679163120"><span class="hs-identifier hs-var">content</span></a></span></span><span> </span><span id="local-6989586621679163121"><span class="annot"><span class="annottext">[DocTests]
</span><a href="#local-6989586621679163121"><span class="hs-identifier hs-var">tests</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CapturedContent -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#genCapture"><span class="hs-identifier hs-var">genCapture</span></a></span><span> </span><span class="annot"><span class="annottext">CapturedContent
</span><a href="#local-6989586621679163120"><span class="hs-identifier hs-var">content</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Doc -&gt; [DocTests] -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#genDocTestList"><span class="hs-identifier hs-var">genDocTestList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc -&gt; Maybe Doc
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;capture&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[DocTests]
</span><a href="#local-6989586621679163121"><span class="hs-identifier hs-var">tests</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-191"></span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#genDocTests"><span class="hs-identifier hs-var">genDocTests</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Warning"><span class="hs-identifier hs-type">Warning</span></a></span><span> </span><span id="local-6989586621679163124"><span class="annot"><span class="annottext">Loc
</span><a href="#local-6989586621679163124"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621679163125"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679163125"><span class="hs-identifier hs-var">msg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Loc -&gt; String -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#genWarning"><span class="hs-identifier hs-var">genWarning</span></a></span><span> </span><span class="annot"><span class="annottext">Loc
</span><a href="#local-6989586621679163124"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679163125"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#genExample"><span class="hs-identifier hs-type">genExample</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#ExampleLine"><span class="hs-identifier hs-type">ExampleLine</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span>
</span><span id="line-194"></span><span id="genExample"><span class="annot"><span class="annottext">genExample :: ExampleLine -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#genExample"><span class="hs-identifier hs-var hs-var">genExample</span></a></span></span><span> </span><span id="local-6989586621679163127"><span class="annot"><span class="annottext">ExampleLine
</span><a href="#local-6989586621679163127"><span class="hs-identifier hs-var">l</span></a></span></span><span>
</span><span id="line-195"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[DocLine] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: Type -&gt; Type) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">ExampleLine
</span><a href="#local-6989586621679163127"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">expectedOutput</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679163128"><span class="hs-identifier hs-var">program</span></a></span><span>
</span><span id="line-196"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;(&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679163128"><span class="hs-identifier hs-var">program</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;)&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;`shouldMatch`&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679163129"><span class="hs-identifier hs-var">expected</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-197"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679163128"><span class="annot"><span class="annottext">program :: Doc
</span><a href="#local-6989586621679163128"><span class="hs-identifier hs-var hs-var">program</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DocLine -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#lineDoc"><span class="hs-identifier hs-var">lineDoc</span></a></span><span> </span><span class="annot"><span class="annottext">ExampleLine
</span><a href="#local-6989586621679163127"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">programLine</span><span>
</span><span id="line-198"></span><span>        </span><span id="local-6989586621679163129"><span class="annot"><span class="annottext">expected :: Doc
</span><a href="#local-6989586621679163129"><span class="hs-identifier hs-var hs-var">expected</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NonEmpty String -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#multilineString"><span class="hs-identifier hs-var">multilineString</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator">.</span><span class="hs-identifier">textLine</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DocLine -&gt; String) -&gt; NonEmpty DocLine -&gt; NonEmpty String
forall (f :: Type -&gt; Type) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[DocLine] -&gt; NonEmpty DocLine
forall a. HasCallStack =&gt; [a] -&gt; NonEmpty a
</span><span class="hs-identifier hs-var">NonEmpty.fromList</span></span><span> </span><span class="annot"><span class="annottext">ExampleLine
</span><a href="#local-6989586621679163127"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">expectedOutput</span><span class="hs-special">)</span><span>
</span><span id="line-199"></span><span>
</span><span id="line-200"></span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#genProperty"><span class="hs-identifier hs-type">genProperty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocLine"><span class="hs-identifier hs-type">DocLine</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span>
</span><span id="line-201"></span><span id="genProperty"><span class="annot"><span class="annottext">genProperty :: NonEmpty DocLine -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#genProperty"><span class="hs-identifier hs-var hs-var">genProperty</span></a></span></span><span> </span><span id="local-6989586621679163131"><span class="annot"><span class="annottext">NonEmpty DocLine
</span><a href="#local-6989586621679163131"><span class="hs-identifier hs-var">propLines</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679163132"><span class="hs-identifier hs-var">header</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NonEmpty Doc -&gt; Doc
forall (f :: Type -&gt; Type). Foldable f =&gt; f Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DocLine -&gt; Doc) -&gt; NonEmpty DocLine -&gt; NonEmpty Doc
forall a b. (a -&gt; b) -&gt; NonEmpty a -&gt; NonEmpty b
forall (f :: Type -&gt; Type) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">DocLine -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#lineDoc"><span class="hs-identifier hs-var">lineDoc</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty DocLine
</span><a href="#local-6989586621679163131"><span class="hs-identifier hs-var">propLines</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-202"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679163132"><span class="annot"><span class="annottext">header :: Doc
</span><a href="#local-6989586621679163132"><span class="hs-identifier hs-var hs-var">header</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;prop &quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
forall a. Show a =&gt; a -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#textShow"><span class="hs-identifier hs-var">textShow</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679163133"><span class="hs-identifier hs-var">line</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot; $&quot;</span></span><span>
</span><span id="line-203"></span><span>        </span><span id="local-6989586621679163133"><span class="annot"><span class="annottext">line :: String
</span><a href="#local-6989586621679163133"><span class="hs-identifier hs-var hs-var">line</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;property (&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Loc -&gt; String
</span><a href="Test.DocTest.Driver.CodeGen.html#locLine"><span class="hs-identifier hs-var">locLine</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator">.</span><span class="hs-identifier">location</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NonEmpty DocLine -&gt; DocLine
forall a. NonEmpty a -&gt; a
</span><span class="hs-identifier hs-var">NonEmpty.head</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty DocLine
</span><a href="#local-6989586621679163131"><span class="hs-identifier hs-var">propLines</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#genMultiline"><span class="hs-identifier hs-type">genMultiline</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#DocLine"><span class="hs-identifier hs-type">DocLine</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span>
</span><span id="line-206"></span><span id="genMultiline"><span class="annot"><span class="annottext">genMultiline :: NonEmpty DocLine -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#genMultiline"><span class="hs-identifier hs-var hs-var">genMultiline</span></a></span></span><span> </span><span id="local-6989586621679163134"><span class="annot"><span class="annottext">ls :: NonEmpty DocLine
</span><a href="#local-6989586621679163134"><span class="hs-identifier hs-var">ls</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679163135"><span class="annot"><span class="annottext">DocLine
</span><a href="#local-6989586621679163135"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span> </span><span class="annot"><span class="annottext">[DocLine]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679163136"><span class="hs-identifier hs-var">header</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679163137"><span class="hs-identifier hs-var">program</span></a></span><span>
</span><span id="line-207"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679163136"><span class="annot"><span class="annottext">header :: Doc
</span><a href="#local-6989586621679163136"><span class="hs-identifier hs-var hs-var">header</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;it&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
forall a. Show a =&gt; a -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#textShow"><span class="hs-identifier hs-var">textShow</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679163138"><span class="hs-keyword hs-var">label</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;$&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#bindVars"><span class="hs-identifier hs-var">bindVars</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;do&quot;</span></span><span>
</span><span id="line-208"></span><span>        </span><span id="local-6989586621679163138"><span class="annot"><span class="annottext">label :: String
</span><a href="#local-6989586621679163138"><span class="hs-keyword hs-var hs-var">label</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;example (&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Loc -&gt; String
</span><a href="Test.DocTest.Driver.CodeGen.html#locLine"><span class="hs-identifier hs-var">locLine</span></a></span><span> </span><span class="annot"><span class="annottext">DocLine
</span><a href="#local-6989586621679163135"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">location</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-209"></span><span>        </span><span id="local-6989586621679163137"><span class="annot"><span class="annottext">program :: Doc
</span><a href="#local-6989586621679163137"><span class="hs-identifier hs-var hs-var">program</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#markVarsUsed"><span class="hs-identifier hs-var">markVarsUsed</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
forall (f :: Type -&gt; Type). Foldable f =&gt; f Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DocLine -&gt; Doc) -&gt; [DocLine] -&gt; [Doc]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">DocLine -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#lineDoc"><span class="hs-identifier hs-var">lineDoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NonEmpty DocLine -&gt; [DocLine]
forall a. NonEmpty a -&gt; [a]
</span><span class="hs-identifier hs-var">NonEmpty.toList</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty DocLine
</span><a href="#local-6989586621679163134"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-210"></span><span>
</span><span id="line-211"></span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#genHook"><span class="hs-identifier hs-type">genHook</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#IOHook"><span class="hs-identifier hs-type">IOHook</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span>
</span><span id="line-212"></span><span id="genHook"><span class="annot"><span class="annottext">genHook :: IOHook -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#genHook"><span class="hs-identifier hs-var hs-var">genHook</span></a></span></span><span> </span><span id="local-6989586621679163139"><span class="annot"><span class="annottext">IOHook
</span><a href="#local-6989586621679163139"><span class="hs-identifier hs-var">hook</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HookFlavour -&gt; [String] -&gt; Doc -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#hookGenFunction"><span class="hs-identifier hs-var">hookGenFunction</span></a></span><span> </span><span class="annot"><span class="annottext">IOHook
</span><a href="#local-6989586621679163139"><span class="hs-identifier hs-var">hook</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">flavour</span><span> </span><span class="annot"><span class="annottext">IOHook
</span><a href="#local-6989586621679163139"><span class="hs-identifier hs-var">hook</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">variables</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NonEmpty Doc -&gt; Doc
forall (f :: Type -&gt; Type). Foldable f =&gt; f Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DocLine -&gt; Doc) -&gt; NonEmpty DocLine -&gt; NonEmpty Doc
forall a b. (a -&gt; b) -&gt; NonEmpty a -&gt; NonEmpty b
forall (f :: Type -&gt; Type) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">DocLine -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#lineDoc"><span class="hs-identifier hs-var">lineDoc</span></a></span><span> </span><span class="annot"><span class="annottext">IOHook
</span><a href="#local-6989586621679163139"><span class="hs-identifier hs-var">hook</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">setupCode</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-213"></span><span>
</span><span id="line-214"></span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#hookGenFunction"><span class="hs-identifier hs-type">hookGenFunction</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#HookFlavour"><span class="hs-identifier hs-type">HookFlavour</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span>
</span><span id="line-215"></span><span id="hookGenFunction"><span class="annot"><span class="annottext">hookGenFunction :: HookFlavour -&gt; [String] -&gt; Doc -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#hookGenFunction"><span class="hs-identifier hs-var hs-var">hookGenFunction</span></a></span></span><span> </span><span class="annot"><span class="annottext">HookFlavour
</span><a href="Test.DocTest.Driver.Extract.Ast.html#Before"><span class="hs-identifier hs-var">Before</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; Doc -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#genBeforeHook"><span class="hs-identifier hs-var">genBeforeHook</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;before&quot;</span></span><span>
</span><span id="line-216"></span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#hookGenFunction"><span class="hs-identifier hs-var">hookGenFunction</span></a></span><span> </span><span class="annot"><span class="annottext">HookFlavour
</span><a href="Test.DocTest.Driver.Extract.Ast.html#BeforeAll"><span class="hs-identifier hs-var">BeforeAll</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; Doc -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#genBeforeHook"><span class="hs-identifier hs-var">genBeforeHook</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;beforeAll&quot;</span></span><span>
</span><span id="line-217"></span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#hookGenFunction"><span class="hs-identifier hs-var">hookGenFunction</span></a></span><span> </span><span class="annot"><span class="annottext">HookFlavour
</span><a href="Test.DocTest.Driver.Extract.Ast.html#After"><span class="hs-identifier hs-var">After</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; Doc -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#genAfterHook"><span class="hs-identifier hs-var">genAfterHook</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;after&quot;</span></span><span>
</span><span id="line-218"></span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#hookGenFunction"><span class="hs-identifier hs-var">hookGenFunction</span></a></span><span> </span><span class="annot"><span class="annottext">HookFlavour
</span><a href="Test.DocTest.Driver.Extract.Ast.html#AfterAll"><span class="hs-identifier hs-var">AfterAll</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; Doc -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#genAfterHook"><span class="hs-identifier hs-var">genAfterHook</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;afterAll&quot;</span></span><span>
</span><span id="line-219"></span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#hookGenFunction"><span class="hs-identifier hs-var">hookGenFunction</span></a></span><span> </span><span class="annot"><span class="annottext">HookFlavour
</span><a href="Test.DocTest.Driver.Extract.Ast.html#Around"><span class="hs-identifier hs-var">Around</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(String -&gt; [String] -&gt; Doc -&gt; Doc -&gt; Doc)
-&gt; (String, [String]) -&gt; Doc -&gt; Doc -&gt; Doc
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; String -&gt; [String] -&gt; Doc -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#genAroundHook"><span class="hs-identifier hs-var">genAroundHook</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;around&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((String, [String]) -&gt; Doc -&gt; Doc -&gt; Doc)
-&gt; ([String] -&gt; (String, [String]))
-&gt; [String]
-&gt; Doc
-&gt; Doc
-&gt; Doc
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Maybe (String, [String]) -&gt; (String, [String])
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (String, [String]) -&gt; (String, [String]))
-&gt; ([String] -&gt; Maybe (String, [String]))
-&gt; [String]
-&gt; (String, [String])
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; Maybe (String, [String])
forall a. [a] -&gt; Maybe (a, [a])
</span><span class="hs-identifier hs-var">uncons</span></span><span>
</span><span id="line-220"></span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#hookGenFunction"><span class="hs-identifier hs-var">hookGenFunction</span></a></span><span> </span><span class="annot"><span class="annottext">HookFlavour
</span><a href="Test.DocTest.Driver.Extract.Ast.html#AroundAll"><span class="hs-identifier hs-var">AroundAll</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(String -&gt; [String] -&gt; Doc -&gt; Doc -&gt; Doc)
-&gt; (String, [String]) -&gt; Doc -&gt; Doc -&gt; Doc
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; String -&gt; [String] -&gt; Doc -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#genAroundHook"><span class="hs-identifier hs-var">genAroundHook</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;aroundAll&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((String, [String]) -&gt; Doc -&gt; Doc -&gt; Doc)
-&gt; ([String] -&gt; (String, [String]))
-&gt; [String]
-&gt; Doc
-&gt; Doc
-&gt; Doc
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Maybe (String, [String]) -&gt; (String, [String])
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (String, [String]) -&gt; (String, [String]))
-&gt; ([String] -&gt; Maybe (String, [String]))
-&gt; [String]
-&gt; (String, [String])
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; Maybe (String, [String])
forall a. [a] -&gt; Maybe (a, [a])
</span><span class="hs-identifier hs-var">uncons</span></span><span>
</span><span id="line-221"></span><span>
</span><span id="line-222"></span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#genBinders"><span class="hs-identifier hs-type">genBinders</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span>
</span><span id="line-223"></span><span id="genBinders"><span class="annot"><span class="annottext">genBinders :: [String] -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#genBinders"><span class="hs-identifier hs-var hs-var">genBinders</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;avoid generating binders when no variable is in scope&quot;</span></span><span>
</span><span id="line-224"></span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#genBinders"><span class="hs-identifier hs-var">genBinders</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679163153"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679163153"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679163153"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-225"></span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#genBinders"><span class="hs-identifier hs-var">genBinders</span></a></span><span> </span><span id="local-6989586621679163154"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679163154"><span class="hs-identifier hs-var">vars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;(&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
forall (f :: Type -&gt; Type). Foldable f =&gt; f Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#hcat"><span class="hs-identifier hs-var">hcat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc -&gt; [Doc] -&gt; [Doc]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">intersperse</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;, &quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(String -&gt; Doc) -&gt; [String] -&gt; [Doc]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679163154"><span class="hs-identifier hs-var">vars</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-226"></span><span>
</span><span id="line-227"></span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#markVarsUsed"><span class="hs-identifier hs-type">markVarsUsed</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span>
</span><span id="line-228"></span><span id="markVarsUsed"><span class="annot"><span class="annottext">markVarsUsed :: Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#markVarsUsed"><span class="hs-identifier hs-var hs-var">markVarsUsed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CodeGen [String]
forall r (m :: Type -&gt; Type). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span><span> </span><span class="annot"><span class="annottext">CodeGen [String] -&gt; ([String] -&gt; Doc) -&gt; Doc
forall a b. CodeGen a -&gt; (a -&gt; CodeGen b) -&gt; CodeGen b
forall (m :: Type -&gt; Type) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679163155"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679163155"><span class="hs-identifier hs-var">vars</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Doc -&gt; Doc
forall (f :: Type -&gt; Type). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[String] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: Type -&gt; Type) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679163155"><span class="hs-identifier hs-var">vars</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;markUsed&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#genBinders"><span class="hs-identifier hs-var">genBinders</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679163155"><span class="hs-identifier hs-var">vars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-229"></span><span>
</span><span id="line-230"></span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#bindVars"><span class="hs-identifier hs-type">bindVars</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span>
</span><span id="line-231"></span><span id="bindVars"><span class="annot"><span class="annottext">bindVars :: Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#bindVars"><span class="hs-identifier hs-var hs-var">bindVars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CodeGen [String]
forall r (m :: Type -&gt; Type). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span><span> </span><span class="annot"><span class="annottext">CodeGen [String] -&gt; ([String] -&gt; Doc) -&gt; Doc
forall a b. CodeGen a -&gt; (a -&gt; CodeGen b) -&gt; CodeGen b
forall (m :: Type -&gt; Type) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679163156"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679163156"><span class="hs-identifier hs-var">vars</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Doc -&gt; Doc
forall (f :: Type -&gt; Type). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[String] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: Type -&gt; Type) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679163156"><span class="hs-identifier hs-var">vars</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;\\&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#genBinders"><span class="hs-identifier hs-var">genBinders</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679163156"><span class="hs-identifier hs-var">vars</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;-&gt;&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-232"></span><span>
</span><span id="line-233"></span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#genBeforeHook"><span class="hs-identifier hs-type">genBeforeHook</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#genAfterHook"><span class="hs-identifier hs-type">genAfterHook</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span>
</span><span id="line-234"></span><span id="genBeforeHook"><span class="annot"><span class="annottext">genBeforeHook :: String -&gt; [String] -&gt; Doc -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#genBeforeHook"><span class="hs-identifier hs-var hs-var">genBeforeHook</span></a></span></span><span> </span><span id="local-6989586621679163157"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679163157"><span class="hs-identifier hs-var">flavour</span></a></span></span><span> </span><span id="local-6989586621679163158"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679163158"><span class="hs-identifier hs-var">vars</span></a></span></span><span> </span><span id="local-6989586621679163159"><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679163159"><span class="hs-identifier hs-var">hookBody</span></a></span></span><span> </span><span id="local-6989586621679163160"><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679163160"><span class="hs-identifier hs-var">tests</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-235"></span><span>  </span><span id="local-6989586621679163161"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679163161"><span class="hs-identifier hs-var">oldVars</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CodeGen [String]
forall r (m :: Type -&gt; Type). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span><span>
</span><span id="line-236"></span><span>  </span><span class="hs-comment">-- null vars: no new variables added, use before[All]_</span><span>
</span><span id="line-237"></span><span>  </span><span class="hs-comment">-- null oldVars: no old variables (we can just return vars), use before[All]</span><span>
</span><span id="line-238"></span><span>  </span><span class="hs-comment">-- otherwise: get old variables and add new, use before[All]With</span><span>
</span><span id="line-239"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679163162"><span class="annot"><span class="annottext">hookFunc :: Doc
</span><a href="#local-6989586621679163162"><span class="hs-identifier hs-var hs-var">hookFunc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679163157"><span class="hs-identifier hs-var">flavour</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: Type -&gt; Type) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679163158"><span class="hs-identifier hs-var">vars</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;_&quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Doc -&gt; Doc
forall (f :: Type -&gt; Type). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[String] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: Type -&gt; Type) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679163161"><span class="hs-identifier hs-var">oldVars</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;With&quot;</span></span><span>
</span><span id="line-240"></span><span>  </span><span class="hs-comment">-- oldVars binders: bind every old variable in sequence</span><span>
</span><span id="line-241"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679163163"><span class="annot"><span class="annottext">binders :: Doc
</span><a href="#local-6989586621679163163"><span class="hs-identifier hs-var hs-var">binders</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Doc -&gt; Doc
forall (f :: Type -&gt; Type). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[String] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: Type -&gt; Type) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679163158"><span class="hs-identifier hs-var">vars</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: Type -&gt; Type) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679163161"><span class="hs-identifier hs-var">oldVars</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;\\&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#genBinders"><span class="hs-identifier hs-var">genBinders</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679163161"><span class="hs-identifier hs-var">oldVars</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;-&gt;&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-242"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679163165"><span class="annot"><span class="annottext">updateVars :: Doc
</span><a href="#local-6989586621679163165"><span class="hs-identifier hs-var hs-var">updateVars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Doc -&gt; Doc
forall (f :: Type -&gt; Type). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[String] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: Type -&gt; Type) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679163158"><span class="hs-identifier hs-var">vars</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: Type -&gt; Type) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679163161"><span class="hs-identifier hs-var">oldVars</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;pure&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#genBinders"><span class="hs-identifier hs-var">genBinders</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679163158"><span class="hs-identifier hs-var">vars</span></a></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679163161"><span class="hs-identifier hs-var">oldVars</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-243"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679163167"><span class="annot"><span class="annottext">hook :: Doc
</span><a href="#local-6989586621679163167"><span class="hs-identifier hs-var hs-var">hook</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;(&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679163163"><span class="hs-identifier hs-var">binders</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;do&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679163159"><span class="hs-identifier hs-var">hookBody</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679163165"><span class="hs-identifier hs-var">updateVars</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-244"></span><span>  </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679163162"><span class="hs-identifier hs-var">hookFunc</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679163167"><span class="hs-identifier hs-var">hook</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;do&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; [String]) -&gt; Doc -&gt; Doc
forall a. ([String] -&gt; [String]) -&gt; CodeGen a -&gt; CodeGen a
forall r (m :: Type -&gt; Type) a.
MonadReader r m =&gt;
(r -&gt; r) -&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">local</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679163158"><span class="hs-identifier hs-var">vars</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679163160"><span class="hs-identifier hs-var">tests</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-245"></span><span id="genAfterHook"><span class="annot"><span class="annottext">genAfterHook :: String -&gt; [String] -&gt; Doc -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#genAfterHook"><span class="hs-identifier hs-var hs-var">genAfterHook</span></a></span></span><span> </span><span id="local-6989586621679163168"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679163168"><span class="hs-identifier hs-var">flavour</span></a></span></span><span> </span><span id="local-6989586621679163169"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679163169"><span class="hs-identifier hs-var">vars</span></a></span></span><span> </span><span id="local-6989586621679163170"><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679163170"><span class="hs-identifier hs-var">hookBody</span></a></span></span><span> </span><span id="local-6989586621679163171"><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679163171"><span class="hs-identifier hs-var">tests</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-246"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679163172"><span class="annot"><span class="annottext">hookFunc :: Doc
</span><a href="#local-6989586621679163172"><span class="hs-identifier hs-var hs-var">hookFunc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679163168"><span class="hs-identifier hs-var">flavour</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Doc -&gt; Doc
forall (f :: Type -&gt; Type). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[String] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: Type -&gt; Type) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679163169"><span class="hs-identifier hs-var">vars</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;_&quot;</span></span><span>
</span><span id="line-247"></span><span>  </span><span id="local-6989586621679163173"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679163173"><span class="hs-identifier hs-var">oldVars</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">([String] -&gt; [String]) -&gt; CodeGen [String]
forall r (m :: Type -&gt; Type) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; [String] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679163174"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679163174"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679163174"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: Type -&gt; Type) a.
(Foldable t, Eq a) =&gt;
a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679163169"><span class="hs-identifier hs-var">vars</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679163174"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;_&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-248"></span><span>  </span><span class="hs-comment">-- oldVars binders: bind every (used) old variable in sequence</span><span>
</span><span id="line-249"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679163176"><span class="annot"><span class="annottext">binders :: Doc
</span><a href="#local-6989586621679163176"><span class="hs-identifier hs-var hs-var">binders</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Doc -&gt; Doc
forall (f :: Type -&gt; Type). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[String] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: Type -&gt; Type) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679163169"><span class="hs-identifier hs-var">vars</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;\\&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#genBinders"><span class="hs-identifier hs-var">genBinders</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679163173"><span class="hs-identifier hs-var">oldVars</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;-&gt;&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-250"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679163177"><span class="annot"><span class="annottext">hook :: Doc
</span><a href="#local-6989586621679163177"><span class="hs-identifier hs-var hs-var">hook</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;(&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679163176"><span class="hs-identifier hs-var">binders</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;do&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679163170"><span class="hs-identifier hs-var">hookBody</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-251"></span><span>  </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679163172"><span class="hs-identifier hs-var">hookFunc</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679163177"><span class="hs-identifier hs-var">hook</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;do&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; [String]) -&gt; Doc -&gt; Doc
forall a. ([String] -&gt; [String]) -&gt; CodeGen a -&gt; CodeGen a
forall r (m :: Type -&gt; Type) a.
MonadReader r m =&gt;
(r -&gt; r) -&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">local</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679163169"><span class="hs-identifier hs-var">vars</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679163171"><span class="hs-identifier hs-var">tests</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-252"></span><span>
</span><span id="line-253"></span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#genAroundHook"><span class="hs-identifier hs-type">genAroundHook</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span>
</span><span id="line-254"></span><span id="genAroundHook"><span class="annot"><span class="annottext">genAroundHook :: String -&gt; String -&gt; [String] -&gt; Doc -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#genAroundHook"><span class="hs-identifier hs-var hs-var">genAroundHook</span></a></span></span><span> </span><span id="local-6989586621679163178"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679163178"><span class="hs-identifier hs-var">flavour</span></a></span></span><span> </span><span id="local-6989586621679163179"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679163179"><span class="hs-identifier hs-var">cont</span></a></span></span><span> </span><span id="local-6989586621679163180"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679163180"><span class="hs-identifier hs-var">vars</span></a></span></span><span> </span><span id="local-6989586621679163181"><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679163181"><span class="hs-identifier hs-var">hookBody</span></a></span></span><span> </span><span id="local-6989586621679163182"><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679163182"><span class="hs-identifier hs-var">tests</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-255"></span><span>  </span><span id="local-6989586621679163183"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679163183"><span class="hs-identifier hs-var">oldVars</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">([String] -&gt; [String]) -&gt; CodeGen [String]
forall r (m :: Type -&gt; Type) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; [String] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679163184"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679163184"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679163184"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: Type -&gt; Type) a.
(Foldable t, Eq a) =&gt;
a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679163180"><span class="hs-identifier hs-var">vars</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679163184"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;_&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-256"></span><span>  </span><span class="hs-comment">-- hookFunc &amp; binders: same with genBeforeHook</span><span>
</span><span id="line-257"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679163185"><span class="annot"><span class="annottext">hookFunc :: Doc
</span><a href="#local-6989586621679163185"><span class="hs-identifier hs-var hs-var">hookFunc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679163178"><span class="hs-identifier hs-var">flavour</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: Type -&gt; Type) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679163180"><span class="hs-identifier hs-var">vars</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;_&quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Doc -&gt; Doc
forall (f :: Type -&gt; Type). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[String] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: Type -&gt; Type) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679163183"><span class="hs-identifier hs-var">oldVars</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;With&quot;</span></span><span>
</span><span id="line-258"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679163186"><span class="annot"><span class="annottext">binders :: Doc
</span><a href="#local-6989586621679163186"><span class="hs-identifier hs-var hs-var">binders</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;\\&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679163179"><span class="hs-identifier hs-var">cont</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Doc -&gt; Doc
forall (f :: Type -&gt; Type). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[String] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: Type -&gt; Type) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679163180"><span class="hs-identifier hs-var">vars</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: Type -&gt; Type) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679163183"><span class="hs-identifier hs-var">oldVars</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[String] -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#genBinders"><span class="hs-identifier hs-var">genBinders</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679163183"><span class="hs-identifier hs-var">oldVars</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;-&gt;&quot;</span></span><span>
</span><span id="line-259"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679163187"><span class="annot"><span class="annottext">hook :: Doc
</span><a href="#local-6989586621679163187"><span class="hs-identifier hs-var hs-var">hook</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;(&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679163186"><span class="hs-identifier hs-var">binders</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;do&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679163181"><span class="hs-identifier hs-var">hookBody</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-260"></span><span>  </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679163185"><span class="hs-identifier hs-var">hookFunc</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679163187"><span class="hs-identifier hs-var">hook</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;do&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; [String]) -&gt; Doc -&gt; Doc
forall a. ([String] -&gt; [String]) -&gt; CodeGen a -&gt; CodeGen a
forall r (m :: Type -&gt; Type) a.
MonadReader r m =&gt;
(r -&gt; r) -&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">local</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679163180"><span class="hs-identifier hs-var">vars</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679163182"><span class="hs-identifier hs-var">tests</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-261"></span><span>
</span><span id="line-262"></span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#genCapture"><span class="hs-identifier hs-type">genCapture</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#CapturedContent"><span class="hs-identifier hs-type">CapturedContent</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span>
</span><span id="line-263"></span><span id="genCapture"><span class="annot"><span class="annottext">genCapture :: CapturedContent -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#genCapture"><span class="hs-identifier hs-var hs-var">genCapture</span></a></span></span><span> </span><span id="local-6989586621679163188"><span class="annot"><span class="annottext">CapturedContent
</span><a href="#local-6989586621679163188"><span class="hs-identifier hs-var">content</span></a></span></span><span> </span><span id="local-6989586621679163189"><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679163189"><span class="hs-identifier hs-var">tests</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CapturedContent
</span><a href="#local-6989586621679163188"><span class="hs-identifier hs-var">content</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">captureMethod</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-264"></span><span>  </span><span class="annot"><span class="annottext">CaptureMethod
</span><a href="Test.DocTest.Driver.Extract.Ast.html#String"><span class="hs-identifier hs-var">String</span></a></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><a href="#local-6989586621679163191"><span class="hs-identifier hs-var">pureBind</span></a></span><span> </span><span class="annot"><span class="annottext">Doc
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-265"></span><span>  </span><span class="annot"><span class="annottext">CaptureMethod
</span><a href="Test.DocTest.Driver.Extract.Ast.html#TextStrict"><span class="hs-identifier hs-var">TextStrict</span></a></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><a href="#local-6989586621679163191"><span class="hs-identifier hs-var">pureBind</span></a></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;textStrict&quot;</span></span><span>
</span><span id="line-266"></span><span>  </span><span class="annot"><span class="annottext">CaptureMethod
</span><a href="Test.DocTest.Driver.Extract.Ast.html#TextLazy"><span class="hs-identifier hs-var">TextLazy</span></a></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><a href="#local-6989586621679163191"><span class="hs-identifier hs-var">pureBind</span></a></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;textLazy&quot;</span></span><span>
</span><span id="line-267"></span><span>  </span><span class="annot"><span class="annottext">CaptureMethod
</span><a href="Test.DocTest.Driver.Extract.Ast.html#ByteStringStrict"><span class="hs-identifier hs-var">ByteStringStrict</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><a href="#local-6989586621679163191"><span class="hs-identifier hs-var">pureBind</span></a></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;byteStringStrict&quot;</span></span><span>
</span><span id="line-268"></span><span>  </span><span class="annot"><span class="annottext">CaptureMethod
</span><a href="Test.DocTest.Driver.Extract.Ast.html#ByteStringLazy"><span class="hs-identifier hs-var">ByteStringLazy</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><a href="#local-6989586621679163191"><span class="hs-identifier hs-var">pureBind</span></a></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;byteStringLazy&quot;</span></span><span>
</span><span id="line-269"></span><span>  </span><span class="annot"><span class="annottext">CaptureMethod
</span><a href="Test.DocTest.Driver.Extract.Ast.html#ShortByteString"><span class="hs-identifier hs-var">ShortByteString</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><a href="#local-6989586621679163191"><span class="hs-identifier hs-var">pureBind</span></a></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;shortByteString&quot;</span></span><span>
</span><span id="line-270"></span><span>  </span><span class="annot"><span class="annottext">CaptureMethod
</span><a href="Test.DocTest.Driver.Extract.Ast.html#TempFile"><span class="hs-identifier hs-var">TempFile</span></a></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; [String] -&gt; Doc -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#genAroundHook"><span class="hs-identifier hs-var">genAroundHook</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;aroundAll&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;doctest_cont&quot;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CapturedContent
</span><a href="#local-6989586621679163188"><span class="hs-identifier hs-var">content</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">variableName</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679163198"><span class="hs-identifier hs-var">hookBody</span></a></span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679163189"><span class="hs-identifier hs-var">tests</span></a></span><span>
</span><span id="line-271"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679163199"><span class="annot"><span class="annottext">s :: Doc
</span><a href="#local-6989586621679163199"><span class="hs-identifier hs-var hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NonEmpty String -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#multilineString"><span class="hs-identifier hs-var">multilineString</span></a></span><span> </span><span class="annot"><span class="annottext">CapturedContent
</span><a href="#local-6989586621679163188"><span class="hs-identifier hs-var">content</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">textContent</span><span>
</span><span id="line-272"></span><span>        </span><span id="local-6989586621679163191"><span class="annot"><span class="annottext">pureBind :: Doc -&gt; Doc
</span><a href="#local-6989586621679163191"><span class="hs-identifier hs-var hs-var">pureBind</span></a></span></span><span> </span><span id="local-6989586621679163200"><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679163200"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;let&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">CapturedContent
</span><a href="#local-6989586621679163188"><span class="hs-identifier hs-var">content</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">variableName</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;=&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679163200"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679163199"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679163189"><span class="hs-identifier hs-var">tests</span></a></span><span>
</span><span id="line-273"></span><span>        </span><span id="local-6989586621679163198"><span class="annot"><span class="annottext">hookBody :: Doc
</span><a href="#local-6989586621679163198"><span class="hs-identifier hs-var hs-var">hookBody</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;withWriteTempFile (\\&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679163201"><span class="hs-identifier hs-var">cont</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;)&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679163199"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-274"></span><span>        </span><span id="local-6989586621679163201"><span class="annot"><span class="annottext">cont :: Doc
</span><a href="#local-6989586621679163201"><span class="hs-identifier hs-var hs-var">cont</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">CapturedContent
</span><a href="#local-6989586621679163188"><span class="hs-identifier hs-var">content</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">variableName</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;-&gt; doctest_cont&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679163202"><span class="hs-identifier hs-var">vars</span></a></span><span>
</span><span id="line-275"></span><span>        </span><span id="local-6989586621679163202"><span class="annot"><span class="annottext">vars :: Doc
</span><a href="#local-6989586621679163202"><span class="hs-identifier hs-var hs-var">vars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([String] -&gt; [String]) -&gt; CodeGen [String]
forall r (m :: Type -&gt; Type) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CapturedContent
</span><a href="#local-6989586621679163188"><span class="hs-identifier hs-var">content</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">variableName</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CodeGen [String] -&gt; ([String] -&gt; Doc) -&gt; Doc
forall a b. CodeGen a -&gt; (a -&gt; CodeGen b) -&gt; CodeGen b
forall (m :: Type -&gt; Type) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#genBinders"><span class="hs-identifier hs-var">genBinders</span></a></span><span>
</span><span id="line-276"></span><span>
</span><span id="line-277"></span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#genWarning"><span class="hs-identifier hs-type">genWarning</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Loc"><span class="hs-identifier hs-type">Loc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span>
</span><span id="line-278"></span><span id="genWarning"><span class="annot"><span class="annottext">genWarning :: Loc -&gt; String -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#genWarning"><span class="hs-identifier hs-var hs-var">genWarning</span></a></span></span><span> </span><span id="local-6989586621679163203"><span class="annot"><span class="annottext">Loc
</span><a href="#local-6989586621679163203"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621679163204"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679163204"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;pendingWith&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
forall a. Show a =&gt; a -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#textShow"><span class="hs-identifier hs-var">textShow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Loc -&gt; String
</span><a href="Test.DocTest.Driver.CodeGen.html#locLine"><span class="hs-identifier hs-var">locLine</span></a></span><span> </span><span class="annot"><span class="annottext">Loc
</span><a href="#local-6989586621679163203"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679163204"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-279"></span><span>
</span><span id="line-280"></span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#multilineString"><span class="hs-identifier hs-type">multilineString</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span>
</span><span id="line-281"></span><span id="multilineString"><span class="annot"><span class="annottext">multilineString :: NonEmpty String -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#multilineString"><span class="hs-identifier hs-var hs-var">multilineString</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679163205"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679163205"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span> </span><span id="local-6989586621679163206"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679163206"><span class="hs-identifier hs-var">ls</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: Type -&gt; Type) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679163206"><span class="hs-identifier hs-var">ls</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
forall a. Show a =&gt; a -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#textShow"><span class="hs-identifier hs-var">textShow</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679163205"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679163207"><span class="hs-identifier hs-var">firstLine</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; Doc
</span><a href="#local-6989586621679163208"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679163206"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-282"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679163208"><span class="annot"><span class="annottext">go :: [String] -&gt; Doc
</span><a href="#local-6989586621679163208"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;impossible&quot;</span></span><span>
</span><span id="line-283"></span><span>        </span><span class="annot"><a href="#local-6989586621679163208"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679163211"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679163211"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\\'</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; String -&gt; String
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
</span><span class="hs-identifier hs-var">showLitString</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679163211"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\&quot;&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-284"></span><span>        </span><span class="annot"><a href="#local-6989586621679163208"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679163212"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679163212"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679163213"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679163213"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\\'</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; String -&gt; String
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
</span><span class="hs-identifier hs-var">showLitString</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679163212"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\\n\\&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#%24%24"><span class="hs-operator hs-var">$$</span></a></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; Doc
</span><a href="#local-6989586621679163208"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679163213"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-285"></span><span>        </span><span id="local-6989586621679163207"><span class="annot"><span class="annottext">firstLine :: Doc
</span><a href="#local-6989586621679163207"><span class="hs-identifier hs-var hs-var">firstLine</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'&quot;'</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; String -&gt; String
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
</span><span class="hs-identifier hs-var">showLitString</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679163205"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\\n\\&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-286"></span><span>
</span><span id="line-287"></span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#genMainDoc"><span class="hs-identifier hs-type">genMainDoc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Module"><span class="hs-identifier hs-type">Module</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span>
</span><span id="line-288"></span><span id="genMainDoc"><span class="annot"><span class="annottext">genMainDoc :: [Module] -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#genMainDoc"><span class="hs-identifier hs-var hs-var">genMainDoc</span></a></span></span><span> </span><span id="local-6989586621679163215"><span class="annot"><span class="annottext">[Module]
</span><a href="#local-6989586621679163215"><span class="hs-identifier hs-var">ms</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
forall (f :: Type -&gt; Type). Foldable f =&gt; f Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span>
</span><span id="line-289"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#noteGenerated"><span class="hs-identifier hs-var">noteGenerated</span></a></span><span>
</span><span id="line-290"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;module Main (main) where&quot;</span></span><span>
</span><span id="line-291"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#emptyText"><span class="hs-identifier hs-var">emptyText</span></a></span><span>
</span><span id="line-292"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;import Test.Hspec&quot;</span></span><span>
</span><span id="line-293"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#emptyText"><span class="hs-identifier hs-var">emptyText</span></a></span><span>
</span><span id="line-294"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679163216"><span class="hs-identifier hs-var">importList</span></a></span><span>
</span><span id="line-295"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#emptyText"><span class="hs-identifier hs-var">emptyText</span></a></span><span>
</span><span id="line-296"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;main :: IO ()&quot;</span></span><span>
</span><span id="line-297"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;main = hspec $ do&quot;</span></span><span>
</span><span id="line-298"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679163217"><span class="hs-identifier hs-var">testList</span></a></span><span>
</span><span id="line-299"></span><span>  </span><span class="hs-special">]</span><span>
</span><span id="line-300"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679163216"><span class="annot"><span class="annottext">importList :: Doc
</span><a href="#local-6989586621679163216"><span class="hs-identifier hs-var hs-var">importList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
forall (f :: Type -&gt; Type). Foldable f =&gt; f Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Doc -&gt; Doc) -&gt; [Doc] -&gt; [Doc]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;import qualified &quot;</span></span><span> </span><span class="hs-operator">&lt;&gt;</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Doc]
</span><a href="#local-6989586621679163218"><span class="hs-identifier hs-var">modulePaths</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-301"></span><span>        </span><span id="local-6989586621679163217"><span class="annot"><span class="annottext">testList :: Doc
</span><a href="#local-6989586621679163217"><span class="hs-identifier hs-var hs-var">testList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
forall (f :: Type -&gt; Type). Foldable f =&gt; f Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Doc -&gt; Doc) -&gt; [Doc] -&gt; [Doc]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;.spec&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Doc]
</span><a href="#local-6989586621679163218"><span class="hs-identifier hs-var">modulePaths</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-302"></span><span>        </span><span id="local-6989586621679163218"><span class="annot"><span class="annottext">modulePaths :: [Doc]
</span><a href="#local-6989586621679163218"><span class="hs-identifier hs-var hs-var">modulePaths</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Module -&gt; Doc) -&gt; [Module] -&gt; [Doc]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Module -&gt; Doc
forall {r}. HasField &quot;modulePath&quot; r [String] =&gt; r -&gt; Doc
</span><a href="#local-6989586621679163219"><span class="hs-identifier hs-var">modulePath</span></a></span><span> </span><span class="annot"><span class="annottext">[Module]
</span><a href="#local-6989586621679163215"><span class="hs-identifier hs-var">ms</span></a></span><span>
</span><span id="line-303"></span><span>        </span><span id="local-6989586621679163219"><span class="annot"><span class="annottext">modulePath :: r -&gt; Doc
</span><a href="#local-6989586621679163219"><span class="hs-identifier hs-var hs-var">modulePath</span></a></span></span><span> </span><span id="local-6989586621679163227"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679163227"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;DocTests.&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; String
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">intercalate</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.&quot;</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679163227"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">modulePath</span><span class="hs-special">)</span><span>
</span><span id="line-304"></span><span>
</span><span id="line-305"></span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#writeToFile"><span class="hs-identifier hs-type">writeToFile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-306"></span><span id="writeToFile"><span class="annot"><span class="annottext">writeToFile :: String -&gt; Doc -&gt; IO ()
</span><a href="Test.DocTest.Driver.CodeGen.html#writeToFile"><span class="hs-identifier hs-var hs-var">writeToFile</span></a></span></span><span> </span><span id="local-6989586621679163230"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679163230"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span id="local-6989586621679163231"><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679163231"><span class="hs-identifier hs-var">doc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-307"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; String -&gt; IO ()
</span><span class="hs-identifier hs-var">createDirectoryIfMissing</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; String
</span><span class="hs-identifier hs-var">takeDirectory</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679163230"><span class="hs-identifier hs-var">path</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-308"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; IOMode -&gt; (Handle -&gt; IO ()) -&gt; IO ()
forall r. String -&gt; IOMode -&gt; (Handle -&gt; IO r) -&gt; IO r
</span><span class="hs-identifier hs-var">withFile</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679163230"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="annot"><span class="annottext">IOMode
</span><span class="hs-identifier hs-var">WriteMode</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679163232"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679163232"><span class="hs-identifier hs-var">hFile</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; Doc -&gt; IO ()
</span><a href="Test.DocTest.Driver.Extract.Dump.html#hPrintDoc"><span class="hs-identifier hs-var">hPrintDoc</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679163232"><span class="hs-identifier hs-var">hFile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[String] -&gt; Doc -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#runDoc"><span class="hs-identifier hs-var">runDoc</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679163231"><span class="hs-identifier hs-var">doc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-309"></span><span>
</span><span id="line-310"></span><span class="annot"><span class="hs-comment">-- | Perform code generation for a single extracted 'Module'.</span></span><span>
</span><span id="line-311"></span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#codeGenSingle"><span class="hs-identifier hs-type">codeGenSingle</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Module"><span class="hs-identifier hs-type">Module</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-312"></span><span id="codeGenSingle"><span class="annot"><span class="annottext">codeGenSingle :: String -&gt; Module -&gt; IO String
</span><a href="Test.DocTest.Driver.CodeGen.html#codeGenSingle"><span class="hs-identifier hs-var hs-var">codeGenSingle</span></a></span></span><span> </span><span id="local-6989586621679163233"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679163233"><span class="hs-identifier hs-var">root</span></a></span></span><span> </span><span id="local-6989586621679163234"><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621679163234"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-313"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679163235"><span class="annot"><span class="annottext">modulePath :: [String]
</span><a href="#local-6989586621679163235"><span class="hs-identifier hs-var hs-var">modulePath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;DocTests&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; [String]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621679163234"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">modulePath</span><span>
</span><span id="line-314"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679163236"><span class="annot"><span class="annottext">path :: String
</span><a href="#local-6989586621679163236"><span class="hs-identifier hs-var hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679163233"><span class="hs-identifier hs-var">root</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; String -&gt; String) -&gt; String -&gt; [String] -&gt; String
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: Type -&gt; Type) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
</span><span class="hs-operator hs-var">(&lt;/&gt;)</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679163235"><span class="hs-identifier hs-var">modulePath</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.hs&quot;</span></span><span>
</span><span id="line-315"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; Doc -&gt; IO ()
</span><a href="Test.DocTest.Driver.CodeGen.html#writeToFile"><span class="hs-identifier hs-var">writeToFile</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679163236"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Module -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#genModuleDoc"><span class="hs-identifier hs-var">genModuleDoc</span></a></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621679163234"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-316"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; IO String
forall a. a -&gt; IO a
forall (f :: Type -&gt; Type) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; String
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">intercalate</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.&quot;</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679163235"><span class="hs-identifier hs-var">modulePath</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-317"></span><span>
</span><span id="line-318"></span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#codeGenMain"><span class="hs-identifier hs-type">codeGenMain</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Module"><span class="hs-identifier hs-type">Module</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-319"></span><span id="codeGenMain"><span class="annot"><span class="annottext">codeGenMain :: String -&gt; [Module] -&gt; IO ()
</span><a href="Test.DocTest.Driver.CodeGen.html#codeGenMain"><span class="hs-identifier hs-var hs-var">codeGenMain</span></a></span></span><span> </span><span id="local-6989586621679163238"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679163238"><span class="hs-identifier hs-var">root</span></a></span></span><span> </span><span id="local-6989586621679163239"><span class="annot"><span class="annottext">[Module]
</span><a href="#local-6989586621679163239"><span class="hs-identifier hs-var">ms</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc -&gt; IO ()
</span><a href="Test.DocTest.Driver.CodeGen.html#writeToFile"><span class="hs-identifier hs-var">writeToFile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679163238"><span class="hs-identifier hs-var">root</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Main.hs&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Module] -&gt; Doc
</span><a href="Test.DocTest.Driver.CodeGen.html#genMainDoc"><span class="hs-identifier hs-var">genMainDoc</span></a></span><span> </span><span class="annot"><span class="annottext">[Module]
</span><a href="#local-6989586621679163239"><span class="hs-identifier hs-var">ms</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-320"></span><span>
</span><span id="line-321"></span><span class="annot"><span class="hs-comment">-- | Perform code generation for all extracted 'Module's, together with a @Main@ module.</span></span><span>
</span><span id="line-322"></span><span class="annot"><a href="Test.DocTest.Driver.CodeGen.html#codeGen"><span class="hs-identifier hs-type">codeGen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.DocTest.Driver.Extract.Ast.html#Module"><span class="hs-identifier hs-type">Module</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span class="hs-special">]</span><span>
</span><span id="line-323"></span><span id="codeGen"><span class="annot"><span class="annottext">codeGen :: String -&gt; [Module] -&gt; IO [String]
</span><a href="Test.DocTest.Driver.CodeGen.html#codeGen"><span class="hs-identifier hs-var hs-var">codeGen</span></a></span></span><span> </span><span id="local-6989586621679163240"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679163240"><span class="hs-identifier hs-var">root</span></a></span></span><span> </span><span id="local-6989586621679163241"><span class="annot"><span class="annottext">[Module]
</span><a href="#local-6989586621679163241"><span class="hs-identifier hs-var">ms</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-324"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; [Module] -&gt; IO ()
</span><a href="Test.DocTest.Driver.CodeGen.html#codeGenMain"><span class="hs-identifier hs-var">codeGenMain</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679163240"><span class="hs-identifier hs-var">root</span></a></span><span> </span><span class="annot"><span class="annottext">[Module]
</span><a href="#local-6989586621679163241"><span class="hs-identifier hs-var">ms</span></a></span><span>
</span><span id="line-325"></span><span>  </span><span class="annot"><span class="annottext">(Module -&gt; IO String) -&gt; [Module] -&gt; IO [String]
forall (t :: Type -&gt; Type) (f :: Type -&gt; Type) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: Type -&gt; Type) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; [a] -&gt; f [b]
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Module -&gt; IO String
</span><a href="Test.DocTest.Driver.CodeGen.html#codeGenSingle"><span class="hs-identifier hs-var">codeGenSingle</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679163240"><span class="hs-identifier hs-var">root</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Module]
</span><a href="#local-6989586621679163241"><span class="hs-identifier hs-var">ms</span></a></span><span>
</span><span id="line-326"></span></pre></body></html>